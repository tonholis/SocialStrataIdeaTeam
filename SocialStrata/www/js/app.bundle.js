!function(){"use strict";angular.module("app.auth",[])}(),function(){"use strict";angular.module("app.buildings",["app.firebase"])}(),function(){"use strict";angular.module("app.channels",[])}(),function(){"use strict";angular.module("app.directmessages",[])}(),function(){"use strict";angular.module("app.firebase",[])}(),function(){"use strict";angular.module("monospaced.elastic",[]).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(e,t,a){return{require:"ngModel",restrict:"A, C",link:function(n,i,r,o){function s(){var e=h;g=c,w=getComputedStyle(c),angular.forEach(U,function(t){e+=t+":"+w.getPropertyValue(t)+";"}),$.setAttribute("style",e)}function u(){var t,a,i,r,o;g!==c&&s(),f||(f=!0,$.value=c.value+m,$.style.overflowY=c.style.overflowY,t=""===c.style.height?"auto":parseInt(c.style.height,10),a=getComputedStyle(c).getPropertyValue("width"),"px"===a.substr(a.length-2,2)&&(r=parseInt(a,10)-x.width,$.style.width=r+"px"),i=$.scrollHeight,i>C?(i=C,o="scroll"):k>i&&(i=k),i+=x.height,c.style.overflowY=o||"hidden",t!==i&&(n.$emit("elastic:resize",d,t,i),c.style.height=i+"px"),e(function(){f=!1},1,!1))}function l(){f=!1,u()}var c=i[0],d=i;if("TEXTAREA"===c.nodeName&&t.getComputedStyle){d.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var p=c.value;c.value="",c.value=p;var g,f,m=r.msdElastic?r.msdElastic.replace(/\\n/g,"\n"):a.append,b=angular.element(t),h="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",v=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+h+'"/>').data("elastic",!0),$=v[0],w=getComputedStyle(c),y=w.getPropertyValue("resize"),S="border-box"===w.getPropertyValue("box-sizing")||"border-box"===w.getPropertyValue("-moz-box-sizing")||"border-box"===w.getPropertyValue("-webkit-box-sizing"),x=S?{width:parseInt(w.getPropertyValue("border-right-width"),10)+parseInt(w.getPropertyValue("padding-right"),10)+parseInt(w.getPropertyValue("padding-left"),10)+parseInt(w.getPropertyValue("border-left-width"),10),height:parseInt(w.getPropertyValue("border-top-width"),10)+parseInt(w.getPropertyValue("padding-top"),10)+parseInt(w.getPropertyValue("padding-bottom"),10)+parseInt(w.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},I=parseInt(w.getPropertyValue("min-height"),10),P=parseInt(w.getPropertyValue("height"),10),k=Math.max(I,P)-x.height,C=parseInt(w.getPropertyValue("max-height"),10),U=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];d.data("elastic")||(C=C&&C>0?C:9e4,$.parentNode!==document.body&&angular.element(document.body).append($),d.css({resize:"none"===y||"vertical"===y?"none":"horizontal"}).data("elastic",!0),"onpropertychange"in c&&"oninput"in c?c.oninput=c.onkeyup=u:c.oninput=u,b.bind("resize",l),n.$watch(function(){return o.$modelValue},function(e){l()}),n.$on("elastic:adjust",function(){s(),l()}),e(u,0,!1),n.$on("$destroy",function(){v.remove(),b.unbind("resize",l)}))}}}}]),angular.module("app.messages",["monospaced.elastic"])}(),function(){"use strict";angular.module("app.profiles",["app.auth"])}(),function(){"use strict";angular.module("app.sidemenu",[])}(),function(){"use strict";angular.module("app.users",["app.auth"])}(),function(){"use strict";function e(e,t,a,n,i,r){e.data={},e.login=function(){n.show(),t.login(e.data.username,e.data.password).success(function(e){n.hide(),i.go("app.buildings")}).error(function(e){r(function(){n.hide()},100);a.alert({title:"Login failed!",template:e.message})})},e.facebookLogin=function(){a.alert({title:"Facebook login",template:"Planned!"})}}e.$inject=["$scope","authService","$ionicPopup","$ionicLoading","$state","$timeout"],angular.module("app.auth").controller("authController",e)}(),function(){"use strict";function e(e,t,a,n,i){var r=firebase.auth();return t.$on("name-changed",function(){var e=firebase.auth().currentUser;null!=e&&firebase.database().ref("users/"+e.uid).set({name:e.displayName,email:e.email,lastActivity:(new Date).getTime()})}),{login:function(n,i){var o=e.defer(),s=o.promise,u=function(e){e.isNew=null==e.displayName,o.resolve(e),a=firebase.auth().currentUser,t.$emit("name-changed")},l=function(e){o.reject(e)};return r.signInWithEmailAndPassword(n,i).then(u,function c(c){"auth/user-not-found"==c.code?r.createUserWithEmailAndPassword(n,i).then(u,l):l(c)}),s.success=function(e){return s.then(e),s},s.error=function(e){return s.then(null,e),s},s},logout:function(){r.signOut(),a=firebase.auth().currentUser},user:function(){return firebase.auth().currentUser}}}e.$inject=["$q","$rootScope","user","buildingsService","selectedBuilding"],angular.module("app.auth").service("authService",e)}(),function(){"use strict";function e(e,t,a,n){var i=n.getChannelsFrom(a.buildingId);t.show(),i.on("value",function(a){var n=a.val();n&&(e.channels=angular.extend(n.common,n.services)),t.hide()},function(e){console.log("error reading: "+e.code);$ionicPopup.alert({title:"Ops!",template:"Sorry! An error ocurred."});t.hide()})}e.$inject=["$scope","$ionicLoading","$stateParams","channelsService"],angular.module("app.buildings").controller("buildingController",e)}(),function(){"use strict";function e(e,t,a,n){var i=a.getBuildings();e.selectedKey=n?n.key:null,e.select=function(t,a){e.selectedKey=a.key=t,n=a,e.$emit("building-selected",n)},t.show(),i.on("value",function(a){e.buildings=a.val(),t.hide()},function(e){console.log("error reading: "+e.code);$ionicPopup.alert({title:"Ops!",template:"Sorry! An error ocurred"});t.hide()})}e.$inject=["$scope","$ionicLoading","buildingsService","selectedBuilding"],angular.module("app.buildings").controller("buildingsController",e)}(),function(){"use strict";function e(e,t){return{getBuildings:function(){return firebase.database().ref("buildings")}}}e.$inject=["firebaseService","$rootScope"],angular.module("app.buildings").service("buildingsService",e)}(),function(){"use strict";function e(){var e={};return e.channels={landlord:"Talk to landlord",general:"General",parking:"Parking Garage",garden:"Garden",lostfound:"Lost & Found",maintenance:"Request Maintenance"},e.getChannelsFrom=function(e){return firebase.database().ref("buildings/"+e+"/channels")},e}angular.module("app.channels").service("channelsService",e)}(),function(){"use strict";function e(e,t,a,n){var i=n.user();console.log(i.uid);var r=a.getUserContacts(i.uid);console.log(r),t.show(),r.on("value",function(a){var n=a.val();n?e.contacts=angular.extend(n.common,n.services):console.log(n),t.hide()},function(e){console.log("error reading: "+e.code),t.hide();$ionicPopup.alert({title:"Ops!",template:"Sorry! An error ocurred."})}),console.log(e.contacts)}angular.module("app.directmessages").controller("directMessagesController",["$scope","$ionicLoading","directMessagesService","authService",e])}(),function(){"use strict";function e(e){var t={};return t.getUserContacts=function(t){return e.fb.database().ref("users/"+t+"/contacts")},t}e.$inject=["firebaseService"],angular.module("app.directmessages").service("directMessagesService",e)}(),function(){"use strict";function e(){var e={apiKey:"AIzaSyB5q81AGGox4i8-QL2KOtnDDfi05irgcHE",authDomain:"socialstrataideateam.firebaseapp.com",databaseURL:"https://socialstrataideateam.firebaseio.com",storageBucket:""};this.fb=firebase.initializeApp(e)}angular.module("app.firebase").service("firebaseService",e)}(),function(){"use strict";function e(e,t,a,n,i,r,o,s,u,l){function c(){e.messages=[{_id:"535d625f898df4e80e2a125e",text:"Ionic has changed the game for hybrid app development.",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-04-27T20:02:39.082Z",read:!0,readDate:"2014-12-01T06:27:37.944Z"},{_id:"535f13ffee3b2a68112b9fc0",text:"I like Ionic better than ice cream!",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-04-29T02:52:47.706Z",read:!0,readDate:"2014-12-01T06:27:37.944Z"},{_id:"546a5843fd4c5d581efa263a",text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-11-17T20:19:15.289Z",read:!0,readDate:"2014-12-01T06:27:38.328Z"},{_id:"54764399ab43d1d4113abfd1",text:"Am I dreaming?",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-11-26T21:18:17.591Z",read:!0,readDate:"2014-12-01T06:27:38.337Z"},{_id:"547643aeab43d1d4113abfd2",text:"Is this magic?",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-11-26T21:18:38.549Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"},{_id:"547815dbab43d1d4113abfef",text:"Gee wiz, this is something special.",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-11-28T06:27:40.001Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"},{_id:"54781c69ab43d1d4113abff0",text:"I think I like Ionic more than I like ice cream!",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-11-28T06:55:37.350Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"},{_id:"54781ca4ab43d1d4113abff1",text:"Yea, it's pretty sweet",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-11-28T06:56:36.472Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"},{_id:"5478df86ab43d1d4113abff4",text:"Wow, this is really something huh?",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-11-28T20:48:06.572Z",read:!0,readDate:"2014-12-01T06:27:38.339Z"},{_id:"54781ca4ab43d1d4113abff1",text:"Create amazing apps - ionicframework.com",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-11-29T06:56:36.472Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"}]}function d(){console.log("keepKeyboardOpen"),m.one("blur",function(){console.log("textarea blur, focus back on it"),m[0].focus()})}e.channelName=l.channels[a.params.channelId],e.toUser={_id:"534b8e5aaa5e7afc1b23e69b",pic:"http://ionicframework.com/img/docs/venkman.jpg",channel:a.params.channelId},e.user={_id:"534b8fb2aa5e7afc1b23e69c",pic:"http://ionicframework.com/img/docs/mcfly.jpg",username:"Marty"},e.input={message:localStorage["userMessage-"+e.toUser._id]||""};var p,g,f,m,b=o.$getByHandle("userMessageScroll");e.$on("$ionicView.enter",function(){console.log("UserMessages $ionicView.enter"),c(),s(function(){g=document.body.querySelector("#userMessagesView .bar-footer"),f=document.body.querySelector("#userMessagesView .scroll-content"),m=angular.element(g.querySelector("textarea"))},0),p=u(function(){},2e4)}),e.$on("$ionicView.leave",function(){console.log("leaving UserMessages view, destroying interval"),angular.isDefined(p)&&(u.cancel(p),p=void 0)}),e.$on("$ionicView.beforeLeave",function(){e.input.message&&""!==e.input.message||localStorage.removeItem("userMessage-"+e.toUser._id)}),e.$watch("input.message",function(t,a){console.log("input.message $watch, newValue "+t),t||(t=""),localStorage["userMessage-"+e.toUser._id]=t}),e.sendMessage=function(t){var a={toId:e.toUser._id,text:e.input.message};d(),e.input.message="",a._id=(new Date).getTime(),a.date=new Date,a.username=e.user.username,a.userId=e.user._id,a.pic=e.user.picture,e.messages.push(a),s(function(){d(),b.scrollBottom(!0)},0),s(function(){e.messages.push(MockService.getMockMessage()),d(),b.scrollBottom(!0)},2e3)},e.onMessageHold=function(t,a,n){console.log("onMessageHold"),console.log("message: "+JSON.stringify(n,null,2)),i.show({buttons:[{text:"Copy Text"},{text:"Delete Message"}],buttonClicked:function(t){switch(t){case 0:break;case 1:e.messages.splice(a,1),s(function(){b.resize()},0)}return!0}})},e.viewProfile=function(t){t.userId===e.user._id},e.$on("taResize",function(e,t){if(console.log("taResize"),t){var a=t[0].offsetHeight;if(console.log("taHeight: "+a),g){var n=a+10;n=n>44?n:44,g.style.height=n+"px",f.style.bottom=n+"px"}}})}angular.module("app.messages").controller("messagesController",["$scope","$rootScope","$state","$stateParams","$ionicActionSheet","$ionicPopup","$ionicScrollDelegate","$timeout","$interval","channelsService",e])}(),function(){"use strict";function e(e){return function(e){return e?e.replace(/\n\r?/g,"<br />"):e}}angular.module("app.messages").filter("nl2br",["$filter",e])}(),function(){"use strict";function e(e){var t={};return t.getMessagesRef=function(){return e.fb.database().ref("messages")},t.addMessage=function(t){return e.fb.database().push(t)},t}e.$inject=["firebaseService"],angular.module("app.messages").service("messagesService",e)}(),function(){"use strict";function e(e,t,a,n,i){var r=n.user();e.data={displayName:r?r.displayName:"",email:r?r.email:""},e.update=function(){t.show(),i.updateProfile(e.data).then(function(e){t.hide(),a.alert({title:"ProfileUpdate!",template:e})},function n(n){t.hide(),a.alert({title:"Update failed!",template:n.message})})}}e.$inject=["$scope","$ionicLoading","$ionicPopup","authService","profilesService"],angular.module("app.profiles").controller("profileController",e)}(),function(){"use strict";function e(e,t,a,n){return{updateProfile:function(i){var r=e.defer();return a.user().updateProfile(i).then(function(){r.resolve("Profile updated!"),n=firebase.auth().currentUser,t.$broadcast("name-changed")},function o(o){r.reject(o)}),r.promise}}}e.$inject=["$q","$rootScope","authService","user"],angular.module("app.profiles").service("profilesService",e)}(),function(){"use strict";function e(e,t,a,n){e.user=n.user(),e.channels=a.channels,e.building={name:"Select a building",address:""},e.$on("building-selected",function(t,a){e.building.name=a.name,e.building.address=a.address}),e.openChannel=function(e){t.go("app.channel",{channelId:e})}}e.$inject=["$scope","$state","channelsService","authService"],angular.module("app.sidemenu").controller("sidemenuController",e)}(),function(){"use strict";function e(e,t){return{updateProfile:function(a){var n=e.defer();return t.user().updateProfile(a).then(function(){n.resolve("Profile updated!"),user=firebase.auth().currentUser,$rootScope.$broadcast("name-changed")},function i(i){n.reject(i)}),n.promise}}}e.$inject=["$q","authService"],angular.module("app.users").service("usersService",e)}(),function(){"use strict";angular.module("app",["ionic","monospaced.elastic","app.firebase","app.auth","app.channels","app.sidemenu","app.buildings","app.profiles","app.messages","app.directmessages"]).value("user",null).value("selectedBuilding",null).value("user",null).run(["$ionicPlatform","$timeout","$rootScope",function(e,t,a){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault(),a.$broadcast("name-changed")})}])}(),function(){"use strict";angular.module("app").run(["$rootScope","$location","authService",function(e,t,a){e.$on("$routeChangeStart",function(e){null==a.user()&&(e.preventDefault(),t.go("login"))})}])}(),function(){"use strict";angular.module("app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"/app",cache:!1,"abstract":!0,templateUrl:"views/sidemenu.html"}).state("app.buildings",{url:"/buildings",views:{menuContent:{templateUrl:"views/buildings.html"}}}).state("app.building",{url:"/buildings/:buildingId",views:{menuContent:{templateUrl:"views/building.html"}}}).state("app.channel",{url:"/channel/:channelId",views:{menuContent:{templateUrl:"views/messages/chat.html"}}}).state("app.profile",{url:"/profile",cache:!1,views:{menuContent:{templateUrl:"views/profile/profile.html"}}}).state("app.messages",{url:"/messages",cache:!1,views:{menuContent:{templateUrl:"views/messages/messages.html"}}}).state("app.logout",{url:"/login",templateProvider:["authService","$state",function(e,t){e.logout(),t.go("login")}]}).state("login",{url:"/login",templateUrl:"views/auth/login.html"}),t.otherwise("/login")}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgvYXV0aC5tb2R1bGUuanMiLCJidWlsZGluZ3MvYnVpbGRpbmdzLm1vZHVsZS5qcyIsImNoYW5uZWxzL2NoYW5uZWxzLm1vZHVsZS5qcyIsImRpcmVjdG1lc3NhZ2VzL2RpcmVjdG1lc3NhZ2VzLm1vZHVsZS5qcyIsImZpcmViYXNlL2ZpcmViYXNlLm1vZHVsZS5qcyIsIm1lc3NhZ2VzL21lc3NhZ2VzLm1vZHVsZS5qcyIsInByb2ZpbGUvcHJvZmlsZXMubW9kdWxlLmpzIiwic2lkZW1lbnUvc2lkZW1lbnUubW9kdWxlLmpzIiwidXNlcnMvdXNlcnMubW9kdWxlLmpzIiwiYXV0aC9hdXRoQ29udHJvbGxlci5qcyIsImFwcC5idW5kbGUuanMiLCJhdXRoL2F1dGhTZXJ2aWNlLmpzIiwiYnVpbGRpbmdzL2J1aWxkaW5nQ29udHJvbGxlci5qcyIsImJ1aWxkaW5ncy9idWlsZGluZ3NDb250cm9sbGVyLmpzIiwiYnVpbGRpbmdzL2J1aWxkaW5nc1NlcnZpY2UuanMiLCJjaGFubmVscy9jaGFubmVsc1NlcnZpY2UuanMiLCJkaXJlY3RtZXNzYWdlcy9kaXJlY3RNZXNzYWdlc0NvbnRyb2xsZXIuanMiLCJkaXJlY3RtZXNzYWdlcy9kaXJlY3RNZXNzYWdlc1NlcnZpY2UuanMiLCJmaXJlYmFzZS9maXJlYmFzZVNlcnZpY2UuanMiLCJtZXNzYWdlcy9tZXNzYWdlc0NvbnRyb2xsZXIuanMiLCJtZXNzYWdlcy9tZXNzYWdlc0ZpbHRlcnMuanMiLCJtZXNzYWdlcy9tZXNzYWdlc1NlcnZpY2UuanMiLCJwcm9maWxlL3Byb2ZpbGVDb250cm9sbGVyLmpzIiwicHJvZmlsZS9wcm9maWxlc1NlcnZpY2UuanMiLCJzaWRlbWVudS9zaWRlbWVudUNvbnRyb2xsZXIuanMiLCJ1c2Vycy91c2Vyc1NlcnZpY2UuanMiLCJhcHAubW9kdWxlLmpzIiwiYXBwLnJvdXRlci5maWx0ZXIuanMiLCJhcHAucm91dGVyLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25zdGFudCIsImFwcGVuZCIsImRpcmVjdGl2ZSIsIiR0aW1lb3V0IiwiJHdpbmRvdyIsImNvbmZpZyIsInJlcXVpcmUiLCJyZXN0cmljdCIsImxpbmsiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsIm5nTW9kZWwiLCJpbml0TWlycm9yIiwibWlycm9yU3R5bGUiLCJtaXJyb3JJbml0U3R5bGUiLCJtaXJyb3JlZCIsInRhIiwidGFTdHlsZSIsImdldENvbXB1dGVkU3R5bGUiLCJmb3JFYWNoIiwiY29weVN0eWxlIiwidmFsIiwiZ2V0UHJvcGVydHlWYWx1ZSIsIm1pcnJvciIsInNldEF0dHJpYnV0ZSIsImFkanVzdCIsInRhSGVpZ2h0IiwidGFDb21wdXRlZFN0eWxlV2lkdGgiLCJtaXJyb3JIZWlnaHQiLCJ3aWR0aCIsIm92ZXJmbG93IiwiYWN0aXZlIiwidmFsdWUiLCJzdHlsZSIsIm92ZXJmbG93WSIsImhlaWdodCIsInBhcnNlSW50Iiwic3Vic3RyIiwibGVuZ3RoIiwiYm94T3V0ZXIiLCJzY3JvbGxIZWlnaHQiLCJtYXhIZWlnaHQiLCJtaW5IZWlnaHQiLCIkZW1pdCIsIiR0YSIsImZvcmNlQWRqdXN0Iiwibm9kZU5hbWUiLCJjc3MiLCJvdmVyZmxvdy15Iiwid29yZC13cmFwIiwidGV4dCIsIm1zZEVsYXN0aWMiLCJyZXBsYWNlIiwiJHdpbiIsIiRtaXJyb3IiLCJkYXRhIiwicmVzaXplIiwiYm9yZGVyQm94IiwibWluSGVpZ2h0VmFsdWUiLCJoZWlnaHRWYWx1ZSIsIk1hdGgiLCJtYXgiLCJwYXJlbnROb2RlIiwiZG9jdW1lbnQiLCJib2R5Iiwib25rZXl1cCIsImJpbmQiLCIkd2F0Y2giLCIkbW9kZWxWYWx1ZSIsIm5ld1ZhbHVlIiwiJG9uIiwicmVtb3ZlIiwidW5iaW5kIiwiYXV0aENvbnRyb2xsZXIiLCIkc2NvcGUiLCJhdXRoU2VydmljZSIsIiRpb25pY1BvcHVwIiwiJGlvbmljTG9hZGluZyIsIiRzdGF0ZSIsImxvZ2luIiwic2hvdyIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJzdWNjZXNzIiwidXNlciIsImhpZGUiLCJnbyIsImVycm9yIiwiYWxlcnQiLCJ0aXRsZSIsInRlbXBsYXRlIiwibWVzc2FnZSIsImZhY2Vib29rTG9naW4iLCIkaW5qZWN0IiwiY29udHJvbGxlciIsIiRxIiwiJHJvb3RTY29wZSIsImJ1aWxkaW5nc1NlcnZpY2UiLCJzZWxlY3RlZEJ1aWxkaW5nIiwiYXV0aCIsImZpcmViYXNlIiwidXNyIiwiY3VycmVudFVzZXIiLCJkYXRhYmFzZSIsInJlZiIsInVpZCIsInNldCIsIm5hbWUiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwibGFzdEFjdGl2aXR5IiwiRGF0ZSIsImdldFRpbWUiLCJkZWZlcnJlZCIsImRlZmVyIiwicHJvbWlzZSIsInN1Y2Nlc3NIYW5kbGVyIiwiaW5mbyIsImlzTmV3IiwicmVzb2x2ZSIsImVycm9ySGFuZGxlciIsInJlamVjdCIsInNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkIiwidGhlbiIsImNvZGUiLCJjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQiLCJmbiIsImxvZ291dCIsInNpZ25PdXQiLCJzZXJ2aWNlIiwiYnVpbGRpbmdDb250cm9sbGVyIiwiJHN0YXRlUGFyYW1zIiwiY2hhbm5lbHNTZXJ2aWNlIiwiZ2V0Q2hhbm5lbHNGcm9tIiwiYnVpbGRpbmdJZCIsIm9uIiwic25hcHNob3QiLCJjaGFubmVscyIsImV4dGVuZCIsImNvbW1vbiIsInNlcnZpY2VzIiwiZXJyb3JPYmplY3QiLCJjb25zb2xlIiwibG9nIiwiYnVpbGRpbmdzQ29udHJvbGxlciIsImdldEJ1aWxkaW5ncyIsInNlbGVjdGVkS2V5Iiwia2V5Iiwic2VsZWN0IiwiYnVpbGRpbmciLCJidWlsZGluZ3MiLCJmaXJlYmFzZVNlcnZpY2UiLCJsYW5kbG9yZCIsImdlbmVyYWwiLCJwYXJraW5nIiwiZ2FyZGVuIiwibG9zdGZvdW5kIiwibWFpbnRlbmFuY2UiLCJkaXJlY3RNZXNzYWdlc0NvbnRyb2xsZXIiLCJjb250YWN0c1NlcnZpY2UiLCJnZXRVc2VyQ29udGFjdHMiLCJjb250YWN0cyIsImRpcmVjdE1lc3NhZ2VzU2VydmljZSIsImZiIiwiYXBpS2V5IiwiYXV0aERvbWFpbiIsImRhdGFiYXNlVVJMIiwic3RvcmFnZUJ1Y2tldCIsInRoaXMiLCJpbml0aWFsaXplQXBwIiwibWVzc2FnZXNDb250cm9sbGVyIiwiJGlvbmljQWN0aW9uU2hlZXQiLCIkaW9uaWNTY3JvbGxEZWxlZ2F0ZSIsIiRpbnRlcnZhbCIsImdldE1lc3NhZ2VzIiwibWVzc2FnZXMiLCJfaWQiLCJ1c2VySWQiLCJkYXRlIiwicmVhZCIsInJlYWREYXRlIiwia2VlcEtleWJvYXJkT3BlbiIsInR4dElucHV0Iiwib25lIiwiZm9jdXMiLCJjaGFubmVsTmFtZSIsInBhcmFtcyIsImNoYW5uZWxJZCIsInRvVXNlciIsInBpYyIsImNoYW5uZWwiLCJpbnB1dCIsImxvY2FsU3RvcmFnZSIsIm1lc3NhZ2VDaGVja1RpbWVyIiwiZm9vdGVyQmFyIiwic2Nyb2xsZXIiLCJ2aWV3U2Nyb2xsIiwiJGdldEJ5SGFuZGxlIiwicXVlcnlTZWxlY3RvciIsImlzRGVmaW5lZCIsImNhbmNlbCIsInVuZGVmaW5lZCIsInJlbW92ZUl0ZW0iLCJvbGRWYWx1ZSIsInNlbmRNZXNzYWdlIiwic2VuZE1lc3NhZ2VGb3JtIiwidG9JZCIsInBpY3R1cmUiLCJwdXNoIiwic2Nyb2xsQm90dG9tIiwiTW9ja1NlcnZpY2UiLCJnZXRNb2NrTWVzc2FnZSIsIm9uTWVzc2FnZUhvbGQiLCJlIiwiaXRlbUluZGV4IiwiSlNPTiIsInN0cmluZ2lmeSIsImJ1dHRvbnMiLCJidXR0b25DbGlja2VkIiwiaW5kZXgiLCJzcGxpY2UiLCJ2aWV3UHJvZmlsZSIsIm1zZyIsIm9mZnNldEhlaWdodCIsIm5ld0Zvb3RlckhlaWdodCIsImJvdHRvbSIsIm5sMmJyIiwiJGZpbHRlciIsImZpbHRlciIsIm1lc3NhZ2VzU2VydmljZSIsImdldE1lc3NhZ2VzUmVmIiwiYWRkTWVzc2FnZSIsInByb2ZpbGVDb250cm9sbGVyIiwicHJvZmlsZXNTZXJ2aWNlIiwidXBkYXRlIiwidXBkYXRlUHJvZmlsZSIsIiRicm9hZGNhc3QiLCJzaWRlbWVudUNvbnRyb2xsZXIiLCJhZGRyZXNzIiwiZXZlbnQiLCJvcGVuQ2hhbm5lbCIsInVzZXJzU2VydmljZSIsInJ1biIsIiRpb25pY1BsYXRmb3JtIiwicmVhZHkiLCJ3aW5kb3ciLCJjb3Jkb3ZhIiwicGx1Z2lucyIsIktleWJvYXJkIiwiaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyIiwiZGlzYWJsZVNjcm9sbCIsIlN0YXR1c0JhciIsInN0eWxlRGVmYXVsdCIsInByZXZlbnREZWZhdWx0IiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsImNhY2hlIiwiYWJzdHJhY3QiLCJ0ZW1wbGF0ZVVybCIsInZpZXdzIiwibWVudUNvbnRlbnQiLCJ0ZW1wbGF0ZVByb3ZpZGVyIiwib3RoZXJ3aXNlIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBLFlBRUFBLFNBQUFDLE9BQUEsa0JDSEEsV0FDQSxZQUVBRCxTQUFBQyxPQUFBLGlCQUFBLG9CQ0hBLFdBQ0EsWUFFQUQsU0FBQUMsT0FBQSxzQkNIQSxXQUNBLFlBRUFELFNBQ0FDLE9BQUEsNEJDSkEsV0FDQSxZQUVBRCxTQUNBQyxPQUFBLHNCQ0pBLFdBQ0EsWUFFQUQsU0FDQUMsT0FBQSx5QkFDQUMsU0FBQSxvQkFDQUMsT0FBQSxLQUVBQyxVQUFBLGNBQ0EsV0FBQSxVQUFBLG1CQUNBLFNBQUFDLEVBQUFDLEVBQUFDLEdBR0EsT0FDQUMsUUFBQSxVQUNBQyxTQUFBLE9BQ0FDLEtBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FzRkEsUUFBQUMsS0FDQSxHQUFBQyxHQUFBQyxDQUVBQyxHQUFBQyxFQUVBQyxFQUFBQyxpQkFBQUYsR0FDQW5CLFFBQUFzQixRQUFBQyxFQUFBLFNBQUFDLEdBQ0FSLEdBQUFRLEVBQUEsSUFBQUosRUFBQUssaUJBQUFELEdBQUEsTUFFQUUsRUFBQUMsYUFBQSxRQUFBWCxHQUdBLFFBQUFZLEtBQ0Es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QkNaQSxXQUNBLFlBRUF6RixTQUVBQyxPQUFBLE9BRUFNLFFBQUEsaUJBQUEscUJBQUEsU0FBQTBQLEVBQUFDLEdBRUFELEVBRUFFLE1BQUEsT0FDQUMsSUFBQSxPQUNBQyxPQUFBLEVBQ0FDLFlBQUEsRUFDQUMsWUFBQSx3QkFHQUosTUFBQSxpQkFDQUMsSUFBQSxhQUNBSSxPQUNBQyxhQUNBRixZQUFBLDJCQUtBSixNQUFBLGdCQUNBQyxJQUFBLHlCQUNBSSxPQUNBQyxhQUNBRixZQUFBLDBCQUtBSixNQUFBLGVBQ0FDLElBQUEsc0JBQ0FJLE9BQ0FDLGFBQ0FGLFlBQUEsK0JBS0FKLE1BQUEsZUFDQUMsSUFBQSxXQUNBQyxPQUFBLEVBQ0FHLE9BQ0FDLGFBQ0FGLFlBQUEsaUNBS0FKLE1BQUEsZ0JBQ0FDLElBQUEsWUFDQUMsT0FBQSxFQUNBRyxPQUNBQyxhQUNBRixZQUFBLG1DQU1BSixNQUFBLGNBQ0FDLElBQUEsU0FDQU0sa0JBQUEsY0FBQSxTQUFBLFNBQUE1TCxFQUFBRyxHQUNBSCxFQUFBb0QsU0FDQWpELEVBQUFRLEdBQUEsYUFHQTBLLE1BQUEsU0FDQUMsSUFBQSxTQUNBRyxZQUFBLDBCQUtBTCxFQUFBUyxVQUFBIiwiZmlsZSI6ImFwcC5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLmF1dGhcIiwgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLmJ1aWxkaW5nc1wiLCBbJ2FwcC5maXJlYmFzZSddKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5jaGFubmVsc1wiLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuZGlyZWN0bWVzc2FnZXMnLCBbXSk7XG59KSgpO1xuXG5cblxuXG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuZmlyZWJhc2UnLCBbXSk7XG59KSgpO1xuXG5cblxuXG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbW9ub3NwYWNlZC5lbGFzdGljJywgW10pXG4gICAgICAgIC5jb25zdGFudCgnbXNkRWxhc3RpY0NvbmZpZycsIHtcbiAgICAgICAgICAgIGFwcGVuZDogJydcbiAgICAgICAgfSlcbiAgICAgICAgLmRpcmVjdGl2ZSgnbXNkRWxhc3RpYycsIFtcbiAgICAgICAgICAgICckdGltZW91dCcsICckd2luZG93JywgJ21zZEVsYXN0aWNDb25maWcnLFxuICAgICAgICAgICAgZnVuY3Rpb24gKCR0aW1lb3V0LCAkd2luZG93LCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnQSwgQycsXG4gICAgICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FjaGUgYSByZWZlcmVuY2UgdG8gdGhlIERPTSBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGEgPSBlbGVtZW50WzBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0YSA9IGVsZW1lbnQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVuc3VyZSB0aGUgZWxlbWVudCBpcyBhIHRleHRhcmVhLCBhbmQgYnJvd3NlciBpcyBjYXBhYmxlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGEubm9kZU5hbWUgIT09ICdURVhUQVJFQScgfHwgISR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHRoZXNlIHByb3BlcnRpZXMgYmVmb3JlIG1lYXN1cmluZyBkaW1lbnNpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGEuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cnOiAnaGlkZGVuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cteSc6ICdoaWRkZW4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3b3JkLXdyYXAnOiAnYnJlYWstd29yZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmb3JjZSB0ZXh0IHJlZmxvd1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSB0YS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhLnZhbHVlID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YS52YWx1ZSA9IHRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcHBlbmQgPSBhdHRycy5tc2RFbGFzdGljID8gYXR0cnMubXNkRWxhc3RpYy5yZXBsYWNlKC9cXFxcbi9nLCAnXFxuJykgOiBjb25maWcuYXBwZW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3aW4gPSBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9ySW5pdFN0eWxlID0gJ3Bvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAtOTk5cHg7IHJpZ2h0OiBhdXRvOyBib3R0b206IGF1dG87JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsZWZ0OiAwOyBvdmVyZmxvdzogaGlkZGVuOyAtd2Via2l0LWJveC1zaXppbmc6IGNvbnRlbnQtYm94OycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLW1vei1ib3gtc2l6aW5nOiBjb250ZW50LWJveDsgYm94LXNpemluZzogY29udGVudC1ib3g7JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0OiAwICFpbXBvcnRhbnQ7IGhlaWdodDogMCAhaW1wb3J0YW50OyBwYWRkaW5nOiAwOycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnd29yZC13cmFwOiBicmVhay13b3JkOyBib3JkZXI6IDA7JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWlycm9yID0gYW5ndWxhci5lbGVtZW50KCc8dGV4dGFyZWEgYXJpYS1oaWRkZW49XCJ0cnVlXCIgdGFiaW5kZXg9XCItMVwiICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3R5bGU9XCInICsgbWlycm9ySW5pdFN0eWxlICsgJ1wiLz4nKS5kYXRhKCdlbGFzdGljJywgdHJ1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yID0gJG1pcnJvclswXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSh0YSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplID0gdGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdyZXNpemUnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJCb3ggPSB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2JveC1zaXppbmcnKSA9PT0gJ2JvcmRlci1ib3gnIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLW1vei1ib3gtc2l6aW5nJykgPT09ICdib3JkZXItYm94JyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy13ZWJraXQtYm94LXNpemluZycpID09PSAnYm9yZGVyLWJveCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm94T3V0ZXIgPSAhYm9yZGVyQm94ID8ge3dpZHRoOiAwLCBoZWlnaHQ6IDB9IDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItcmlnaHQtd2lkdGgnKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdwYWRkaW5nLXJpZ2h0JyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1sZWZ0JyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLWxlZnQtd2lkdGgnKSwgMTApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLXRvcC13aWR0aCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctdG9wJyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1ib3R0b20nKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItYm90dG9tLXdpZHRoJyksIDEwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluSGVpZ2h0VmFsdWUgPSBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ21pbi1oZWlnaHQnKSwgMTApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodFZhbHVlID0gcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdoZWlnaHQnKSwgMTApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbkhlaWdodCA9IE1hdGgubWF4KG1pbkhlaWdodFZhbHVlLCBoZWlnaHRWYWx1ZSkgLSBib3hPdXRlci5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdtYXgtaGVpZ2h0JyksIDEwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29weVN0eWxlID0gWydmb250LWZhbWlseScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmb250LXNpemUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZm9udC13ZWlnaHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZm9udC1zdHlsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsZXR0ZXItc3BhY2luZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsaW5lLWhlaWdodCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZXh0LXRyYW5zZm9ybScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3b3JkLXNwYWNpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGV4dC1pbmRlbnQnXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhpdCBpZiBlbGFzdGljIGFscmVhZHkgYXBwbGllZCAob3IgaXMgdGhlIG1pcnJvciBlbGVtZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR0YS5kYXRhKCdlbGFzdGljJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9wZXJhIHJldHVybnMgbWF4LWhlaWdodCBvZiAtMSBpZiBub3Qgc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQgPSBtYXhIZWlnaHQgJiYgbWF4SGVpZ2h0ID4gMCA/IG1heEhlaWdodCA6IDllNDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXBwZW5kIG1pcnJvciB0byB0aGUgRE9NXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWlycm9yLnBhcmVudE5vZGUgIT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkuYXBwZW5kKG1pcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCByZXNpemUgYW5kIGFwcGx5IGVsYXN0aWNcbiAgICAgICAgICAgICAgICAgICAgICAgICR0YS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyZXNpemUnOiAocmVzaXplID09PSAnbm9uZScgfHwgcmVzaXplID09PSAndmVydGljYWwnKSA/ICdub25lJyA6ICdob3Jpem9udGFsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuZGF0YSgnZWxhc3RpYycsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICogbWV0aG9kc1xuICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGluaXRNaXJyb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pcnJvclN0eWxlID0gbWlycm9ySW5pdFN0eWxlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yZWQgPSB0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb3B5IHRoZSBlc3NlbnRpYWwgc3R5bGVzIGZyb20gdGhlIHRleHRhcmVhIHRvIHRoZSBtaXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSh0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGNvcHlTdHlsZSwgZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JTdHlsZSArPSB2YWwgKyAnOicgKyB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUodmFsKSArICc7JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3Iuc2V0QXR0cmlidXRlKCdzdHlsZScsIG1pcnJvclN0eWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYWRqdXN0KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFDb21wdXRlZFN0eWxlV2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvckhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1pcnJvcmVkICE9PSB0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0TWlycm9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWN0aXZlIGZsYWcgcHJldmVudHMgYWN0aW9ucyBpbiBmdW5jdGlvbiBmcm9tIGNhbGxpbmcgYWRqdXN0IGFnYWluXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3IudmFsdWUgPSB0YS52YWx1ZSArIGFwcGVuZDsgLy8gb3B0aW9uYWwgd2hpdGVzcGFjZSB0byBpbXByb3ZlIGFuaW1hdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3Iuc3R5bGUub3ZlcmZsb3dZID0gdGEuc3R5bGUub3ZlcmZsb3dZO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhSGVpZ2h0ID0gdGEuc3R5bGUuaGVpZ2h0ID09PSAnJyA/ICdhdXRvJyA6IHBhcnNlSW50KHRhLnN0eWxlLmhlaWdodCwgMTApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhQ29tcHV0ZWRTdHlsZVdpZHRoID0gZ2V0Q29tcHV0ZWRTdHlsZSh0YSkuZ2V0UHJvcGVydHlWYWx1ZSgnd2lkdGgnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbnN1cmUgZ2V0Q29tcHV0ZWRTdHlsZSBoYXMgcmV0dXJuZWQgYSByZWFkYWJsZSAndXNlZCB2YWx1ZScgcGl4ZWwgd2lkdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhQ29tcHV0ZWRTdHlsZVdpZHRoLnN1YnN0cih0YUNvbXB1dGVkU3R5bGVXaWR0aC5sZW5ndGggLSAyLCAyKSA9PT0gJ3B4Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1pcnJvciB3aWR0aCBpbiBjYXNlIHRoZSB0ZXh0YXJlYSB3aWR0aCBoYXMgY2hhbmdlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBwYXJzZUludCh0YUNvbXB1dGVkU3R5bGVXaWR0aCwgMTApIC0gYm94T3V0ZXIud2lkdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3Iuc3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQgPSBtaXJyb3Iuc2Nyb2xsSGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaXJyb3JIZWlnaHQgPiBtYXhIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvckhlaWdodCA9IG1heEhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93ID0gJ3Njcm9sbCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWlycm9ySGVpZ2h0IDwgbWluSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQgPSBtaW5IZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9ySGVpZ2h0ICs9IGJveE91dGVyLmhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGEuc3R5bGUub3ZlcmZsb3dZID0gb3ZlcmZsb3cgfHwgJ2hpZGRlbic7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhSGVpZ2h0ICE9PSBtaXJyb3JIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdlbGFzdGljOnJlc2l6ZScsICR0YSwgdGFIZWlnaHQsIG1pcnJvckhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YS5zdHlsZS5oZWlnaHQgPSBtaXJyb3JIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc21hbGwgZGVsYXkgdG8gcHJldmVudCBhbiBpbmZpbml0ZSBsb29wXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGZvcmNlQWRqdXN0KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICogaW5pdGlhbGlzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxpc3RlblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCdvbnByb3BlcnR5Y2hhbmdlJyBpbiB0YSAmJiAnb25pbnB1dCcgaW4gdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJRTlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVsnb25pbnB1dCddID0gdGEub25rZXl1cCA9IGFkanVzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFbJ29uaW5wdXQnXSA9IGFkanVzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgJHdpbi5iaW5kKCdyZXNpemUnLCBmb3JjZUFkanVzdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5nTW9kZWwuJG1vZGVsVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JjZUFkanVzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbignZWxhc3RpYzphZGp1c3QnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdE1pcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQWRqdXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoYWRqdXN0LCAwLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBkZXN0cm95XG4gICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWlycm9yLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3aW4udW5iaW5kKCdyZXNpemUnLCBmb3JjZUFkanVzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIF0pO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubWVzc2FnZXMnLCBbJ21vbm9zcGFjZWQuZWxhc3RpYyddKTtcbn0pKCk7XG5cblxuXG5cbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAucHJvZmlsZXNcIiwgWydhcHAuYXV0aCddKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5zaWRlbWVudVwiLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAudXNlcnNcIiwgWydhcHAuYXV0aCddKTtcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLmF1dGhcIilcblxuICAgICAgICAuY29udHJvbGxlcihcImF1dGhDb250cm9sbGVyXCIsIGF1dGhDb250cm9sbGVyKTtcblxuXG4gICAgZnVuY3Rpb24gYXV0aENvbnRyb2xsZXIoJHNjb3BlLCBhdXRoU2VydmljZSwgJGlvbmljUG9wdXAsICRpb25pY0xvYWRpbmcsICRzdGF0ZSwgJHRpbWVvdXQpIHtcblxuICAgICAgICAkc2NvcGUuZGF0YSA9IHt9O1xuXG4gICAgICAgICRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0JGlvbmljTG9hZGluZy5zaG93KCk7XG5cblx0XHRcdGF1dGhTZXJ2aWNlLmxvZ2luKCRzY29wZS5kYXRhLnVzZXJuYW1lLCAkc2NvcGUuZGF0YS5wYXNzd29yZCkuc3VjY2VzcyhmdW5jdGlvbih1c2VyKSB7XG5cdFx0XHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXHRcdFx0XHQkc3RhdGUuZ28oJ2FwcC5idWlsZGluZ3MnKTtcblxuICAgICAgICAgICAgfSkuZXJyb3IoZnVuY3Rpb24oZXJyb3IpIHtcblx0XHRcdFx0JHRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cdFx0XHRcdH0sIDEwMCk7XG5cbiAgICAgICAgICAgICAgICB2YXIgYWxlcnRQb3B1cCA9ICRpb25pY1BvcHVwLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdMb2dpbiBmYWlsZWQhJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6IGVycm9yLm1lc3NhZ2UgLy8nUGxlYXNlIGNoZWNrIHlvdXIgY3JlZGVudGlhbHMhJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuXHRcdCRzY29wZS5mYWNlYm9va0xvZ2luID0gZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgYWxlcnRQb3B1cCA9ICRpb25pY1BvcHVwLmFsZXJ0KHtcblx0XHRcdFx0dGl0bGU6ICdGYWNlYm9vayBsb2dpbicsXG5cdFx0XHRcdHRlbXBsYXRlOiAnUGxhbm5lZCEnXG5cdFx0XHR9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5hdXRoXCIsIFtdKTtcbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLmJ1aWxkaW5nc1wiLCBbJ2FwcC5maXJlYmFzZSddKTtcbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLmNoYW5uZWxzXCIsIFtdKTtcbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmRpcmVjdG1lc3NhZ2VzJywgW10pO1xufSkoKTtcblxuXG5cblxuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuZmlyZWJhc2UnLCBbXSk7XG59KSgpO1xuXG5cblxuXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdtb25vc3BhY2VkLmVsYXN0aWMnLCBbXSlcbiAgICAgICAgLmNvbnN0YW50KCdtc2RFbGFzdGljQ29uZmlnJywge1xuICAgICAgICAgICAgYXBwZW5kOiAnJ1xuICAgICAgICB9KVxuICAgICAgICAuZGlyZWN0aXZlKCdtc2RFbGFzdGljJywgW1xuICAgICAgICAgICAgJyR0aW1lb3V0JywgJyR3aW5kb3cnLCAnbXNkRWxhc3RpY0NvbmZpZycsXG4gICAgICAgICAgICBmdW5jdGlvbiAoJHRpbWVvdXQsICR3aW5kb3csIGNvbmZpZykge1xuICAgICAgICAgICAgICAgICd1c2Ugc3RyaWN0JztcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmU6ICduZ01vZGVsJyxcbiAgICAgICAgICAgICAgICAgICAgcmVzdHJpY3Q6ICdBLCBDJyxcbiAgICAgICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgbmdNb2RlbCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjYWNoZSBhIHJlZmVyZW5jZSB0byB0aGUgRE9NIGVsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YSA9IGVsZW1lbnRbMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRhID0gZWxlbWVudDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW5zdXJlIHRoZSBlbGVtZW50IGlzIGEgdGV4dGFyZWEsIGFuZCBicm93c2VyIGlzIGNhcGFibGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YS5ub2RlTmFtZSAhPT0gJ1RFWFRBUkVBJyB8fCAhJHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgdGhlc2UgcHJvcGVydGllcyBiZWZvcmUgbWVhc3VyaW5nIGRpbWVuc2lvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgICR0YS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdyc6ICdoaWRkZW4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdy15JzogJ2hpZGRlbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dvcmQtd3JhcCc6ICdicmVhay13b3JkJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvcmNlIHRleHQgcmVmbG93XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGV4dCA9IHRhLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGEudmFsdWUgPSAnJztcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhLnZhbHVlID0gdGV4dDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFwcGVuZCA9IGF0dHJzLm1zZEVsYXN0aWMgPyBhdHRycy5tc2RFbGFzdGljLnJlcGxhY2UoL1xcXFxuL2csICdcXG4nKSA6IGNvbmZpZy5hcHBlbmQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHdpbiA9IGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JJbml0U3R5bGUgPSAncG9zaXRpb246IGFic29sdXRlOyB0b3A6IC05OTlweDsgcmlnaHQ6IGF1dG87IGJvdHRvbTogYXV0bzsnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xlZnQ6IDA7IG92ZXJmbG93OiBoaWRkZW47IC13ZWJraXQtYm94LXNpemluZzogY29udGVudC1ib3g7JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICctbW96LWJveC1zaXppbmc6IGNvbnRlbnQtYm94OyBib3gtc2l6aW5nOiBjb250ZW50LWJveDsnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21pbi1oZWlnaHQ6IDAgIWltcG9ydGFudDsgaGVpZ2h0OiAwICFpbXBvcnRhbnQ7IHBhZGRpbmc6IDA7JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3b3JkLXdyYXA6IGJyZWFrLXdvcmQ7IGJvcmRlcjogMDsnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtaXJyb3IgPSBhbmd1bGFyLmVsZW1lbnQoJzx0ZXh0YXJlYSBhcmlhLWhpZGRlbj1cInRydWVcIiB0YWJpbmRleD1cIi0xXCIgJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdzdHlsZT1cIicgKyBtaXJyb3JJbml0U3R5bGUgKyAnXCIvPicpLmRhdGEoJ2VsYXN0aWMnLCB0cnVlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3IgPSAkbWlycm9yWzBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHRhKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNpemUgPSB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3Jlc2l6ZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJvcmRlckJveCA9IHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm94LXNpemluZycpID09PSAnYm9yZGVyLWJveCcgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctbW96LWJveC1zaXppbmcnKSA9PT0gJ2JvcmRlci1ib3gnIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLXdlYmtpdC1ib3gtc2l6aW5nJykgPT09ICdib3JkZXItYm94JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3hPdXRlciA9ICFib3JkZXJCb3ggPyB7d2lkdGg6IDAsIGhlaWdodDogMH0gOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoOiBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2JvcmRlci1yaWdodC13aWR0aCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctcmlnaHQnKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdwYWRkaW5nLWxlZnQnKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItbGVmdC13aWR0aCcpLCAxMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodDogcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItdG9wLXdpZHRoJyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy10b3AnKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdwYWRkaW5nLWJvdHRvbScpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2JvcmRlci1ib3R0b20td2lkdGgnKSwgMTApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5IZWlnaHRWYWx1ZSA9IHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnbWluLWhlaWdodCcpLCAxMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0VmFsdWUgPSBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2hlaWdodCcpLCAxMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluSGVpZ2h0ID0gTWF0aC5tYXgobWluSGVpZ2h0VmFsdWUsIGhlaWdodFZhbHVlKSAtIGJveE91dGVyLmhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQgPSBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ21heC1oZWlnaHQnKSwgMTApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvcmVkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3B5U3R5bGUgPSBbJ2ZvbnQtZmFtaWx5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ZvbnQtc2l6ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmb250LXdlaWdodCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmb250LXN0eWxlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xldHRlci1zcGFjaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2xpbmUtaGVpZ2h0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RleHQtdHJhbnNmb3JtJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dvcmQtc3BhY2luZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZXh0LWluZGVudCddO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBleGl0IGlmIGVsYXN0aWMgYWxyZWFkeSBhcHBsaWVkIChvciBpcyB0aGUgbWlycm9yIGVsZW1lbnQpXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJHRhLmRhdGEoJ2VsYXN0aWMnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gT3BlcmEgcmV0dXJucyBtYXgtaGVpZ2h0IG9mIC0xIGlmIG5vdCBzZXRcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heEhlaWdodCA9IG1heEhlaWdodCAmJiBtYXhIZWlnaHQgPiAwID8gbWF4SGVpZ2h0IDogOWU0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhcHBlbmQgbWlycm9yIHRvIHRoZSBET01cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaXJyb3IucGFyZW50Tm9kZSAhPT0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KS5hcHBlbmQobWlycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHJlc2l6ZSBhbmQgYXBwbHkgZWxhc3RpY1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRhLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3Jlc2l6ZSc6IChyZXNpemUgPT09ICdub25lJyB8fCByZXNpemUgPT09ICd2ZXJ0aWNhbCcpID8gJ25vbmUnIDogJ2hvcml6b250YWwnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KS5kYXRhKCdlbGFzdGljJywgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBtZXRob2RzXG4gICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gaW5pdE1pcnJvcigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbWlycm9yU3R5bGUgPSBtaXJyb3JJbml0U3R5bGU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JlZCA9IHRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvcHkgdGhlIGVzc2VudGlhbCBzdHlsZXMgZnJvbSB0aGUgdGV4dGFyZWEgdG8gdGhlIG1pcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goY29weVN0eWxlLCBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvclN0eWxlICs9IHZhbCArICc6JyArIHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSh2YWwpICsgJzsnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvci5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgbWlycm9yU3R5bGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBhZGp1c3QoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhSGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YUNvbXB1dGVkU3R5bGVXaWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9ySGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3c7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWlycm9yZWQgIT09IHRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRNaXJyb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhY3RpdmUgZmxhZyBwcmV2ZW50cyBhY3Rpb25zIGluIGZ1bmN0aW9uIGZyb20gY2FsbGluZyBhZGp1c3QgYWdhaW5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWFjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvci52YWx1ZSA9IHRhLnZhbHVlICsgYXBwZW5kOyAvLyBvcHRpb25hbCB3aGl0ZXNwYWNlIHRvIGltcHJvdmUgYW5pbWF0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvci5zdHlsZS5vdmVyZmxvd1kgPSB0YS5zdHlsZS5vdmVyZmxvd1k7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFIZWlnaHQgPSB0YS5zdHlsZS5oZWlnaHQgPT09ICcnID8gJ2F1dG8nIDogcGFyc2VJbnQodGEuc3R5bGUuaGVpZ2h0LCAxMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFDb21wdXRlZFN0eWxlV2lkdGggPSBnZXRDb21wdXRlZFN0eWxlKHRhKS5nZXRQcm9wZXJ0eVZhbHVlKCd3aWR0aCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVuc3VyZSBnZXRDb21wdXRlZFN0eWxlIGhhcyByZXR1cm5lZCBhIHJlYWRhYmxlICd1c2VkIHZhbHVlJyBwaXhlbCB3aWR0aFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFDb21wdXRlZFN0eWxlV2lkdGguc3Vic3RyKHRhQ29tcHV0ZWRTdHlsZVdpZHRoLmxlbmd0aCAtIDIsIDIpID09PSAncHgnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGUgbWlycm9yIHdpZHRoIGluIGNhc2UgdGhlIHRleHRhcmVhIHdpZHRoIGhhcyBjaGFuZ2VkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCA9IHBhcnNlSW50KHRhQ29tcHV0ZWRTdHlsZVdpZHRoLCAxMCkgLSBib3hPdXRlci53aWR0aDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvci5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvckhlaWdodCA9IG1pcnJvci5zY3JvbGxIZWlnaHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1pcnJvckhlaWdodCA+IG1heEhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9ySGVpZ2h0ID0gbWF4SGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3ZlcmZsb3cgPSAnc2Nyb2xsJztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtaXJyb3JIZWlnaHQgPCBtaW5IZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvckhlaWdodCA9IG1pbkhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQgKz0gYm94T3V0ZXIuaGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YS5zdHlsZS5vdmVyZmxvd1kgPSBvdmVyZmxvdyB8fCAnaGlkZGVuJztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFIZWlnaHQgIT09IG1pcnJvckhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ2VsYXN0aWM6cmVzaXplJywgJHRhLCB0YUhlaWdodCwgbWlycm9ySGVpZ2h0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhLnN0eWxlLmhlaWdodCA9IG1pcnJvckhlaWdodCArICdweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzbWFsbCBkZWxheSB0byBwcmV2ZW50IGFuIGluZmluaXRlIGxvb3BcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDEsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZm9yY2VBZGp1c3QoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRqdXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBpbml0aWFsaXNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gbGlzdGVuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ29ucHJvcGVydHljaGFuZ2UnIGluIHRhICYmICdvbmlucHV0JyBpbiB0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElFOVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhWydvbmlucHV0J10gPSB0YS5vbmtleXVwID0gYWRqdXN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVsnb25pbnB1dCddID0gYWRqdXN0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAkd2luLmJpbmQoJ3Jlc2l6ZScsIGZvcmNlQWRqdXN0KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmdNb2RlbC4kbW9kZWxWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQWRqdXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJG9uKCdlbGFzdGljOmFkanVzdCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0TWlycm9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2VBZGp1c3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChhZGp1c3QsIDAsIGZhbHNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIGRlc3Ryb3lcbiAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRtaXJyb3IucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHdpbi51bmJpbmQoJ3Jlc2l6ZScsIGZvcmNlQWRqdXN0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgXSk7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5tZXNzYWdlcycsIFsnbW9ub3NwYWNlZC5lbGFzdGljJ10pO1xufSkoKTtcblxuXG5cblxuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLnByb2ZpbGVzXCIsIFsnYXBwLmF1dGgnXSk7XG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5zaWRlbWVudVwiLCBbXSk7XG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC51c2Vyc1wiLCBbJ2FwcC5hdXRoJ10pO1xufSkoKTtcbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhdXRoQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiYXV0aFNlcnZpY2VcIiwgXCIkaW9uaWNQb3B1cFwiLCBcIiRpb25pY0xvYWRpbmdcIiwgXCIkc3RhdGVcIiwgXCIkdGltZW91dFwiXTtcbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5hdXRoXCIpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoXCJhdXRoQ29udHJvbGxlclwiLCBhdXRoQ29udHJvbGxlcik7XG5cblxuICAgIGZ1bmN0aW9uIGF1dGhDb250cm9sbGVyKCRzY29wZSwgYXV0aFNlcnZpY2UsICRpb25pY1BvcHVwLCAkaW9uaWNMb2FkaW5nLCAkc3RhdGUsICR0aW1lb3V0KSB7XG5cbiAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcblxuICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbigpIHtcblx0XHRcdCRpb25pY0xvYWRpbmcuc2hvdygpO1xuXG5cdFx0XHRhdXRoU2VydmljZS5sb2dpbigkc2NvcGUuZGF0YS51c2VybmFtZSwgJHNjb3BlLmRhdGEucGFzc3dvcmQpLnN1Y2Nlc3MoZnVuY3Rpb24odXNlcikge1xuXHRcdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblx0XHRcdFx0JHN0YXRlLmdvKCdhcHAuYnVpbGRpbmdzJyk7XG5cbiAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uKGVycm9yKSB7XG5cdFx0XHRcdCR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXHRcdFx0XHR9LCAxMDApO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFsZXJ0UG9wdXAgPSAkaW9uaWNQb3B1cC5hbGVydCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnTG9naW4gZmFpbGVkIScsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBlcnJvci5tZXNzYWdlIC8vJ1BsZWFzZSBjaGVjayB5b3VyIGNyZWRlbnRpYWxzISdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cblx0XHQkc2NvcGUuZmFjZWJvb2tMb2dpbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGFsZXJ0UG9wdXAgPSAkaW9uaWNQb3B1cC5hbGVydCh7XG5cdFx0XHRcdHRpdGxlOiAnRmFjZWJvb2sgbG9naW4nLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ1BsYW5uZWQhJ1xuXHRcdFx0fSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGF1dGhTZXJ2aWNlLiRpbmplY3QgPSBbXCIkcVwiLCBcIiRyb290U2NvcGVcIiwgXCJ1c2VyXCIsIFwiYnVpbGRpbmdzU2VydmljZVwiLCBcInNlbGVjdGVkQnVpbGRpbmdcIl07XG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYXV0aFwiKVxuXG4gICAgICAgIC5zZXJ2aWNlKFwiYXV0aFNlcnZpY2VcIiwgYXV0aFNlcnZpY2UpO1xuXG5cdGZ1bmN0aW9uIGNyZWF0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblx0XHR2YXIgYXV0aCA9IGZpcmViYXNlU2VydmljZS5mYi5hdXRoKCk7XG5cblx0XHRyZXR1cm4gYXV0aC5jcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQoZW1haWwsIHBhc3N3b3JkKTtcblx0fVxuXHRcbiAgICBmdW5jdGlvbiBhdXRoU2VydmljZSgkcSwgJHJvb3RTY29wZSwgdXNlciwgYnVpbGRpbmdzU2VydmljZSwgc2VsZWN0ZWRCdWlsZGluZykge1xuXHRcdHZhciBhdXRoID0gZmlyZWJhc2UuYXV0aCgpO1xuXHRcdFxuXHRcdCRyb290U2NvcGUuJG9uKCduYW1lLWNoYW5nZWQnLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciB1c3IgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7XG5cdFx0XHRpZiAodXNyID09IG51bGwpIHJldHVybjtcblx0XHRcdFxuXHRcdFx0ZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoJ3VzZXJzLycgKyB1c3IudWlkKS5zZXQoe1xuXHRcdFx0XHRuYW1lOiB1c3IuZGlzcGxheU5hbWUsXG5cdFx0XHRcdGVtYWlsOiB1c3IuZW1haWwsXG5cdFx0XHRcdGxhc3RBY3Rpdml0eTogbmV3IERhdGUoKS5nZXRUaW1lKClcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHtcbiAgICAgICAgICAgIGxvZ2luOiBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcblxuXHRcdFx0XHR2YXIgc3VjY2Vzc0hhbmRsZXIgPSBmdW5jdGlvbihpbmZvKSB7XG5cdFx0XHRcdFx0aW5mby5pc05ldyA9IGluZm8uZGlzcGxheU5hbWUgPT0gbnVsbDtcblx0XHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGluZm8pO1xuXHRcdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0dXNlciA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcblx0XHRcdFx0XHQkcm9vdFNjb3BlLiRlbWl0KCduYW1lLWNoYW5nZWQnKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHR2YXIgZXJyb3JIYW5kbGVyID0gZnVuY3Rpb24oZXJyb3IpIHtcblx0XHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdGF1dGguc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0XHRcdC50aGVuKHN1Y2Nlc3NIYW5kbGVyLCBmdW5jdGlvbiBlcnJvcihlcnJvcikge1xuXHRcdFx0XHRcdFx0aWYgKGVycm9yLmNvZGUgPT0gXCJhdXRoL3VzZXItbm90LWZvdW5kXCIpIHtcblx0XHRcdFx0XHRcdFx0YXV0aC5jcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0XHRcdFx0XHRcdC50aGVuKHN1Y2Nlc3NIYW5kbGVyLCBlcnJvckhhbmRsZXIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGVycm9ySGFuZGxlcihlcnJvcik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cbiAgICAgICAgICAgICAgICBwcm9taXNlLnN1Y2Nlc3MgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZm4pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvbWlzZS5lcnJvciA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb21pc2UudGhlbihudWxsLCBmbik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG5cblx0XHRcdGxvZ291dDogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRhdXRoLnNpZ25PdXQoKTtcblx0XHRcdFx0dXNlciA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcblx0XHRcdH0sXG5cbiAgICAgICAgICAgIHVzZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBidWlsZGluZ0NvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRpb25pY0xvYWRpbmdcIiwgXCIkc3RhdGVQYXJhbXNcIiwgXCJjaGFubmVsc1NlcnZpY2VcIl07XG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYnVpbGRpbmdzXCIpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoXCJidWlsZGluZ0NvbnRyb2xsZXJcIiwgYnVpbGRpbmdDb250cm9sbGVyKTtcblxuXG4gICAgZnVuY3Rpb24gYnVpbGRpbmdDb250cm9sbGVyKCRzY29wZSwgJGlvbmljTG9hZGluZywgJHN0YXRlUGFyYW1zLCBjaGFubmVsc1NlcnZpY2UpIHtcblxuICAgICAgICB2YXIgcmVmID0gY2hhbm5lbHNTZXJ2aWNlLmdldENoYW5uZWxzRnJvbSgkc3RhdGVQYXJhbXMuYnVpbGRpbmdJZCk7XG5cbiAgICAgICAgJGlvbmljTG9hZGluZy5zaG93KCk7XG4gICAgICAgIHJlZi5vbihcInZhbHVlXCIsIGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICAgICAgdmFyIHZhbCA9IHNuYXBzaG90LnZhbCgpO1xuXG4gICAgICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5uZWxzID0gYW5ndWxhci5leHRlbmQodmFsLmNvbW1vbiwgdmFsLnNlcnZpY2VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblxuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3JPYmplY3QpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3IgcmVhZGluZzogXCIgKyBlcnJvck9iamVjdC5jb2RlKTtcbiAgICAgICAgICAgIHZhciBhbGVydFBvcHVwID0gJGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnT3BzIScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdTb3JyeSEgQW4gZXJyb3Igb2N1cnJlZC4nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgICAgICB9KTtcblxuICAgIH1cbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGJ1aWxkaW5nc0NvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcIiRpb25pY0xvYWRpbmdcIiwgXCJidWlsZGluZ3NTZXJ2aWNlXCIsIFwic2VsZWN0ZWRCdWlsZGluZ1wiXTtcbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5idWlsZGluZ3NcIilcblxuICAgICAgICAuY29udHJvbGxlcihcImJ1aWxkaW5nc0NvbnRyb2xsZXJcIiwgYnVpbGRpbmdzQ29udHJvbGxlcik7XG5cblxuICAgIGZ1bmN0aW9uIGJ1aWxkaW5nc0NvbnRyb2xsZXIoJHNjb3BlLCAkaW9uaWNMb2FkaW5nLCBidWlsZGluZ3NTZXJ2aWNlLCBzZWxlY3RlZEJ1aWxkaW5nKSB7XG4gICAgICAgIHZhciByZWYgPSBidWlsZGluZ3NTZXJ2aWNlLmdldEJ1aWxkaW5ncygpO1xuXHRcdFxuXHRcdCRzY29wZS5zZWxlY3RlZEtleSA9IHNlbGVjdGVkQnVpbGRpbmcgPyBzZWxlY3RlZEJ1aWxkaW5nLmtleSA6IG51bGw7XG5cdFx0XG5cdFx0JHNjb3BlLnNlbGVjdCA9IGZ1bmN0aW9uKGtleSwgYnVpbGRpbmcpIHtcblx0XHRcdCRzY29wZS5zZWxlY3RlZEtleSA9IGJ1aWxkaW5nLmtleSA9IGtleTtcblx0XHRcdHNlbGVjdGVkQnVpbGRpbmcgPSBidWlsZGluZztcblx0XHRcdCRzY29wZS4kZW1pdChcImJ1aWxkaW5nLXNlbGVjdGVkXCIsIHNlbGVjdGVkQnVpbGRpbmcpO1xuXHRcdH07XHRcdFxuXG4gICAgICAgICRpb25pY0xvYWRpbmcuc2hvdygpO1xuICAgICAgICByZWYub24oXCJ2YWx1ZVwiLCBmdW5jdGlvbiAoc25hcHNob3QpIHtcbiAgICAgICAgICAgICRzY29wZS5idWlsZGluZ3MgPSBzbmFwc2hvdC52YWwoKTtcbiAgICAgICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3JPYmplY3QpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3IgcmVhZGluZzogXCIgKyBlcnJvck9iamVjdC5jb2RlKTtcbiAgICAgICAgICAgIHZhciBhbGVydFBvcHVwID0gJGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnT3BzIScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdTb3JyeSEgQW4gZXJyb3Igb2N1cnJlZCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGJ1aWxkaW5nc1NlcnZpY2UuJGluamVjdCA9IFtcImZpcmViYXNlU2VydmljZVwiLCBcIiRyb290U2NvcGVcIl07XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuYnVpbGRpbmdzJylcbiAgICAgICAgLnNlcnZpY2UoJ2J1aWxkaW5nc1NlcnZpY2UnLCBidWlsZGluZ3NTZXJ2aWNlKTtcblxuICAgIGZ1bmN0aW9uIGJ1aWxkaW5nc1NlcnZpY2UoZmlyZWJhc2VTZXJ2aWNlLCAkcm9vdFNjb3BlKSB7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEJ1aWxkaW5nczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZignYnVpbGRpbmdzJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuY2hhbm5lbHMnKVxuICAgICAgICAuc2VydmljZSgnY2hhbm5lbHNTZXJ2aWNlJywgY2hhbm5lbHNTZXJ2aWNlKTtcblxuICAgIGZ1bmN0aW9uIGNoYW5uZWxzU2VydmljZSgpIHtcblx0XHR2YXIgc2VydmljZSA9IHt9O1xuXHRcdFxuXHRcdHNlcnZpY2UuY2hhbm5lbHMgPSB7XG5cdFx0XHRcImxhbmRsb3JkXCI6IFwiVGFsayB0byBsYW5kbG9yZFwiLFxuXHRcdFx0XCJnZW5lcmFsXCI6IFwiR2VuZXJhbFwiLFxuXHRcdFx0XCJwYXJraW5nXCI6IFwiUGFya2luZyBHYXJhZ2VcIixcblx0XHRcdFwiZ2FyZGVuXCI6IFwiR2FyZGVuXCIsXG5cdFx0XHRcImxvc3Rmb3VuZFwiOiBcIkxvc3QgJiBGb3VuZFwiLFxuXHRcdFx0XCJtYWludGVuYW5jZVwiOiBcIlJlcXVlc3QgTWFpbnRlbmFuY2VcIlxuXHRcdH07XG5cdFx0XG5cdFx0c2VydmljZS5nZXRDaGFubmVsc0Zyb20gPSBmdW5jdGlvbiAoYnVpbGRpbmcpIHtcblx0XHRcdHJldHVybiBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZignYnVpbGRpbmdzLycgKyBidWlsZGluZyArIFwiL2NoYW5uZWxzXCIpO1xuXHRcdH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgfVxufSkoKTtcblxuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmRpcmVjdG1lc3NhZ2VzJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ2RpcmVjdE1lc3NhZ2VzQ29udHJvbGxlcicsIFtcbiAgICAgICAgICAgICckc2NvcGUnLFxuICAgICAgICAgICAgJyRpb25pY0xvYWRpbmcnLFxuICAgICAgICAgICAgJ2RpcmVjdE1lc3NhZ2VzU2VydmljZScsXG4gICAgICAgICAgICAnYXV0aFNlcnZpY2UnLFxuICAgICAgICAgICAgZGlyZWN0TWVzc2FnZXNDb250cm9sbGVyXG4gICAgICAgIF0pO1xuXG4gICAgZnVuY3Rpb24gZGlyZWN0TWVzc2FnZXNDb250cm9sbGVyKCRzY29wZSwgJGlvbmljTG9hZGluZywgY29udGFjdHNTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuICAgICAgICB2YXIgdXNlciA9IGF1dGhTZXJ2aWNlLnVzZXIoKTtcblxuICAgICAgICBjb25zb2xlLmxvZyh1c2VyLnVpZCk7XG5cbiAgICAgICAgdmFyIHJlZiA9IGNvbnRhY3RzU2VydmljZS5nZXRVc2VyQ29udGFjdHModXNlci51aWQpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKHJlZik7XG5cbiAgICAgICAgJGlvbmljTG9hZGluZy5zaG93KCk7XG4gICAgICAgIHJlZi5vbihcInZhbHVlXCIsIGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICAgICAgdmFyIHZhbCA9IHNuYXBzaG90LnZhbCgpO1xuXG4gICAgICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNvbnRhY3RzID0gYW5ndWxhci5leHRlbmQodmFsLmNvbW1vbiwgdmFsLnNlcnZpY2VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHZhbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yT2JqZWN0KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImVycm9yIHJlYWRpbmc6IFwiICsgZXJyb3JPYmplY3QuY29kZSk7XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgICAgIHZhciBhbGVydFBvcHVwID0gJGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnT3BzIScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdTb3JyeSEgQW4gZXJyb3Igb2N1cnJlZC4nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coJHNjb3BlLmNvbnRhY3RzKTtcbiAgICB9XG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBkaXJlY3RNZXNzYWdlc1NlcnZpY2UuJGluamVjdCA9IFtcImZpcmViYXNlU2VydmljZVwiXTtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5kaXJlY3RtZXNzYWdlcycpXG4gICAgICAgIC5zZXJ2aWNlKCdkaXJlY3RNZXNzYWdlc1NlcnZpY2UnLCBkaXJlY3RNZXNzYWdlc1NlcnZpY2UpO1xuXG4gICAgZnVuY3Rpb24gZGlyZWN0TWVzc2FnZXNTZXJ2aWNlKGZpcmViYXNlU2VydmljZSkge1xuICAgICAgICB2YXIgc2VydmljZSA9IHt9O1xuXG4gICAgICAgIHNlcnZpY2UuZ2V0VXNlckNvbnRhY3RzID0gZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBmaXJlYmFzZVNlcnZpY2UuZmIuZGF0YWJhc2UoKS5yZWYoJ3VzZXJzLycgKyB1c2VyICsgJy9jb250YWN0cycpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuZmlyZWJhc2UnKVxuICAgICAgICAuc2VydmljZSgnZmlyZWJhc2VTZXJ2aWNlJywgZmlyZWJhc2VTZXJ2aWNlKTtcblxuXG4gICAgZnVuY3Rpb24gZmlyZWJhc2VTZXJ2aWNlKCkge1xuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgYXBpS2V5OiBcIkFJemFTeUI1cTgxQUdHb3g0aTgtUUwyS090bkREZmkwNWlyZ2NIRVwiLFxuICAgICAgICAgICAgYXV0aERvbWFpbjogXCJzb2NpYWxzdHJhdGFpZGVhdGVhbS5maXJlYmFzZWFwcC5jb21cIixcbiAgICAgICAgICAgIGRhdGFiYXNlVVJMOiBcImh0dHBzOi8vc29jaWFsc3RyYXRhaWRlYXRlYW0uZmlyZWJhc2Vpby5jb21cIixcbiAgICAgICAgICAgIHN0b3JhZ2VCdWNrZXQ6IFwiXCIsXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5mYiA9IGZpcmViYXNlLmluaXRpYWxpemVBcHAoY29uZmlnKTtcbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLm1lc3NhZ2VzJylcblxuICAgICAgICAuY29udHJvbGxlcignbWVzc2FnZXNDb250cm9sbGVyJywgWyckc2NvcGUnLCAnJHJvb3RTY29wZScsICckc3RhdGUnLFxuICAgICAgICAgICAgJyRzdGF0ZVBhcmFtcycsICckaW9uaWNBY3Rpb25TaGVldCcsXG4gICAgICAgICAgICAnJGlvbmljUG9wdXAnLCAnJGlvbmljU2Nyb2xsRGVsZWdhdGUnLCAnJHRpbWVvdXQnLCAnJGludGVydmFsJywgJ2NoYW5uZWxzU2VydmljZScsXG4gICAgICAgICAgICBtZXNzYWdlc0NvbnRyb2xsZXJcbiAgICAgICAgXSlcblxuICAgIGZ1bmN0aW9uIG1lc3NhZ2VzQ29udHJvbGxlcigkc2NvcGUsICRyb290U2NvcGUsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkaW9uaWNBY3Rpb25TaGVldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGlvbmljUG9wdXAsICRpb25pY1Njcm9sbERlbGVnYXRlLCAkdGltZW91dCwgJGludGVydmFsLCBjaGFubmVsc1NlcnZpY2UpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFxuXHRcdCRzY29wZS5jaGFubmVsTmFtZSA9IGNoYW5uZWxzU2VydmljZS5jaGFubmVsc1skc3RhdGUucGFyYW1zLmNoYW5uZWxJZF07XHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0XHRcdFxuICAgICAgICAvLyBtb2NrIGFjcXVpcmluZyBkYXRhIHZpYSAkc3RhdGVQYXJhbXNcbiAgICAgICAgJHNjb3BlLnRvVXNlciA9IHtcbiAgICAgICAgICAgIF9pZDogJzUzNGI4ZTVhYWE1ZTdhZmMxYjIzZTY5YicsXG4gICAgICAgICAgICBwaWM6ICdodHRwOi8vaW9uaWNmcmFtZXdvcmsuY29tL2ltZy9kb2NzL3ZlbmttYW4uanBnJyxcbiAgICAgICAgICAgIGNoYW5uZWw6ICRzdGF0ZS5wYXJhbXMuY2hhbm5lbElkXG4gICAgICAgIH1cblxuICAgICAgICAvLyB0aGlzIGNvdWxkIGJlIG9uICRyb290U2NvcGUgcmF0aGVyIHRoYW4gaW4gJHN0YXRlUGFyYW1zXG4gICAgICAgICRzY29wZS51c2VyID0ge1xuICAgICAgICAgICAgX2lkOiAnNTM0YjhmYjJhYTVlN2FmYzFiMjNlNjljJyxcbiAgICAgICAgICAgIHBpYzogJ2h0dHA6Ly9pb25pY2ZyYW1ld29yay5jb20vaW1nL2RvY3MvbWNmbHkuanBnJyxcbiAgICAgICAgICAgIHVzZXJuYW1lOiAnTWFydHknXG4gICAgICAgIH07XG5cbiAgICAgICAgJHNjb3BlLmlucHV0ID0ge1xuICAgICAgICAgICAgbWVzc2FnZTogbG9jYWxTdG9yYWdlWyd1c2VyTWVzc2FnZS0nICsgJHNjb3BlLnRvVXNlci5faWRdIHx8ICcnXG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIG1lc3NhZ2VDaGVja1RpbWVyO1xuXG4gICAgICAgIHZhciB2aWV3U2Nyb2xsID0gJGlvbmljU2Nyb2xsRGVsZWdhdGUuJGdldEJ5SGFuZGxlKCd1c2VyTWVzc2FnZVNjcm9sbCcpO1xuICAgICAgICB2YXIgZm9vdGVyQmFyOyAvLyBnZXRzIHNldCBpbiAkaW9uaWNWaWV3LmVudGVyXG4gICAgICAgIHZhciBzY3JvbGxlcjtcbiAgICAgICAgdmFyIHR4dElucHV0OyAvLyBeXl5cblxuICAgICAgICAkc2NvcGUuJG9uKCckaW9uaWNWaWV3LmVudGVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzZXJNZXNzYWdlcyAkaW9uaWNWaWV3LmVudGVyJyk7XG5cbiAgICAgICAgICAgIGdldE1lc3NhZ2VzKCk7XG5cbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBmb290ZXJCYXIgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJyN1c2VyTWVzc2FnZXNWaWV3IC5iYXItZm9vdGVyJyk7XG4gICAgICAgICAgICAgICAgc2Nyb2xsZXIgPSBkb2N1bWVudC5ib2R5LnF1ZXJ5U2VsZWN0b3IoJyN1c2VyTWVzc2FnZXNWaWV3IC5zY3JvbGwtY29udGVudCcpO1xuICAgICAgICAgICAgICAgIHR4dElucHV0ID0gYW5ndWxhci5lbGVtZW50KGZvb3RlckJhci5xdWVyeVNlbGVjdG9yKCd0ZXh0YXJlYScpKTtcbiAgICAgICAgICAgIH0sIDApO1xuXG4gICAgICAgICAgICBtZXNzYWdlQ2hlY2tUaW1lciA9ICRpbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy8gaGVyZSB5b3UgY291bGQgY2hlY2sgZm9yIG5ldyBtZXNzYWdlcyBpZiB5b3VyIGFwcCBkb2Vzbid0IHVzZSBwdXNoIG5vdGlmaWNhdGlvbnMgb3IgdXNlciBkaXNhYmxlZCB0aGVtXG4gICAgICAgICAgICB9LCAyMDAwMCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kb24oJyRpb25pY1ZpZXcubGVhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbGVhdmluZyBVc2VyTWVzc2FnZXMgdmlldywgZGVzdHJveWluZyBpbnRlcnZhbCcpO1xuICAgICAgICAgICAgLy8gTWFrZSBzdXJlIHRoYXQgdGhlIGludGVydmFsIGlzIGRlc3Ryb3llZFxuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKG1lc3NhZ2VDaGVja1RpbWVyKSkge1xuICAgICAgICAgICAgICAgICRpbnRlcnZhbC5jYW5jZWwobWVzc2FnZUNoZWNrVGltZXIpO1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VDaGVja1RpbWVyID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCckaW9uaWNWaWV3LmJlZm9yZUxlYXZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCEkc2NvcGUuaW5wdXQubWVzc2FnZSB8fCAkc2NvcGUuaW5wdXQubWVzc2FnZSA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlck1lc3NhZ2UtJyArICRzY29wZS50b1VzZXIuX2lkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0TWVzc2FnZXMoKSB7XG4gICAgICAgICAgICAkc2NvcGUubWVzc2FnZXMgPSBbe1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTM1ZDYyNWY4OThkZjRlODBlMmExMjVlXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiSW9uaWMgaGFzIGNoYW5nZWQgdGhlIGdhbWUgZm9yIGh5YnJpZCBhcHAgZGV2ZWxvcG1lbnQuXCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGZiMmFhNWU3YWZjMWIyM2U2OWNcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTA0LTI3VDIwOjAyOjM5LjA4MlpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozNy45NDRaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjUzNWYxM2ZmZWUzYjJhNjgxMTJiOWZjMFwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIkkgbGlrZSBJb25pYyBiZXR0ZXIgdGhhbiBpY2UgY3JlYW0hXCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWJcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTA0LTI5VDAyOjUyOjQ3LjcwNlpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozNy45NDRaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NmE1ODQzZmQ0YzVkNTgxZWZhMjYzYVwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0LCBjb25zZWN0ZXR1ciBhZGlwaXNjaW5nIGVsaXQsIHNlZCBkbyBlaXVzbW9kIHRlbXBvciBpbmNpZGlkdW50IHV0IGxhYm9yZSBldCBkb2xvcmUgbWFnbmEgYWxpcXVhLiBVdCBlbmltIGFkIG1pbmltIHZlbmlhbSwgcXVpcyBub3N0cnVkIGV4ZXJjaXRhdGlvbiB1bGxhbWNvIGxhYm9yaXMgbmlzaSB1dCBhbGlxdWlwIGV4IGVhIGNvbW1vZG8gY29uc2VxdWF0LiBEdWlzIGF1dGUgaXJ1cmUgZG9sb3IgaW4gcmVwcmVoZW5kZXJpdCBpbiB2b2x1cHRhdGUgdmVsaXQgZXNzZSBjaWxsdW0gZG9sb3JlIGV1IGZ1Z2lhdCBudWxsYSBwYXJpYXR1ci4gRXhjZXB0ZXVyIHNpbnQgb2NjYWVjYXQgY3VwaWRhdGF0IG5vbiBwcm9pZGVudCwgc3VudCBpbiBjdWxwYSBxdWkgb2ZmaWNpYSBkZXNlcnVudCBtb2xsaXQgYW5pbSBpZCBlc3QgbGFib3J1bS5cIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZmIyYWE1ZTdhZmMxYjIzZTY5Y1wiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMTEtMTdUMjA6MTk6MTUuMjg5WlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM4LjMyOFpcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTQ3NjQzOTlhYjQzZDFkNDExM2FiZmQxXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiQW0gSSBkcmVhbWluZz9cIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZTVhYWE1ZTdhZmMxYjIzZTY5YlwiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMTEtMjZUMjE6MTg6MTcuNTkxWlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM4LjMzN1pcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTQ3NjQzYWVhYjQzZDFkNDExM2FiZmQyXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiSXMgdGhpcyBtYWdpYz9cIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZmIyYWE1ZTdhZmMxYjIzZTY5Y1wiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMTEtMjZUMjE6MTg6MzguNTQ5WlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM4LjMzOFpcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTQ3ODE1ZGJhYjQzZDFkNDExM2FiZmVmXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiR2VlIHdpeiwgdGhpcyBpcyBzb21ldGhpbmcgc3BlY2lhbC5cIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZTVhYWE1ZTdhZmMxYjIzZTY5YlwiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMTEtMjhUMDY6Mjc6NDAuMDAxWlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM4LjMzOFpcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTQ3ODFjNjlhYjQzZDFkNDExM2FiZmYwXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiSSB0aGluayBJIGxpa2UgSW9uaWMgbW9yZSB0aGFuIEkgbGlrZSBpY2UgY3JlYW0hXCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGZiMmFhNWU3YWZjMWIyM2U2OWNcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI4VDA2OjU1OjM3LjM1MFpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzhaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzgxY2E0YWI0M2QxZDQxMTNhYmZmMVwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIlllYSwgaXQncyBwcmV0dHkgc3dlZXRcIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZTVhYWE1ZTdhZmMxYjIzZTY5YlwiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMTEtMjhUMDY6NTY6MzYuNDcyWlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM4LjMzOFpcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTQ3OGRmODZhYjQzZDFkNDExM2FiZmY0XCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiV293LCB0aGlzIGlzIHJlYWxseSBzb21ldGhpbmcgaHVoP1wiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhmYjJhYTVlN2FmYzFiMjNlNjljXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0yOFQyMDo0ODowNi41NzJaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzM5WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDc4MWNhNGFiNDNkMWQ0MTEzYWJmZjFcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJDcmVhdGUgYW1hemluZyBhcHBzIC0gaW9uaWNmcmFtZXdvcmsuY29tXCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWJcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI5VDA2OjU2OjM2LjQ3MlpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzhaXCJcbiAgICAgICAgICAgIH1dO1xuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnaW5wdXQubWVzc2FnZScsIGZ1bmN0aW9uIChuZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpbnB1dC5tZXNzYWdlICR3YXRjaCwgbmV3VmFsdWUgJyArIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIGlmICghbmV3VmFsdWUpIG5ld1ZhbHVlID0gJyc7XG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2VbJ3VzZXJNZXNzYWdlLScgKyAkc2NvcGUudG9Vc2VyLl9pZF0gPSBuZXdWYWx1ZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLnNlbmRNZXNzYWdlID0gZnVuY3Rpb24gKHNlbmRNZXNzYWdlRm9ybSkge1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSB7XG4gICAgICAgICAgICAgICAgdG9JZDogJHNjb3BlLnRvVXNlci5faWQsXG4gICAgICAgICAgICAgICAgdGV4dDogJHNjb3BlLmlucHV0Lm1lc3NhZ2VcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIGlmIHlvdSBkbyBhIHdlYiBzZXJ2aWNlIGNhbGwgdGhpcyB3aWxsIGJlIG5lZWRlZCBhcyB3ZWxsIGFzIGJlZm9yZSB0aGUgdmlld1Njcm9sbCBjYWxsc1xuICAgICAgICAgICAgLy8geW91IGNhbid0IHNlZSB0aGUgZWZmZWN0IG9mIHRoaXMgaW4gdGhlIGJyb3dzZXIgaXQgbmVlZHMgdG8gYmUgdXNlZCBvbiBhIHJlYWwgZGV2aWNlXG4gICAgICAgICAgICAvLyBmb3Igc29tZSByZWFzb24gdGhlIG9uZSB0aW1lIGJsdXIgZXZlbnQgaXMgbm90IGZpcmluZyBpbiB0aGUgYnJvd3NlciBidXQgZG9lcyBvbiBkZXZpY2VzXG4gICAgICAgICAgICBrZWVwS2V5Ym9hcmRPcGVuKCk7XG5cbiAgICAgICAgICAgIC8vTW9ja1NlcnZpY2Uuc2VuZE1lc3NhZ2UobWVzc2FnZSkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuaW5wdXQubWVzc2FnZSA9ICcnO1xuXG4gICAgICAgICAgICBtZXNzYWdlLl9pZCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpOyAvLyA6filcbiAgICAgICAgICAgIG1lc3NhZ2UuZGF0ZSA9IG5ldyBEYXRlKCk7XG4gICAgICAgICAgICBtZXNzYWdlLnVzZXJuYW1lID0gJHNjb3BlLnVzZXIudXNlcm5hbWU7XG4gICAgICAgICAgICBtZXNzYWdlLnVzZXJJZCA9ICRzY29wZS51c2VyLl9pZDtcbiAgICAgICAgICAgIG1lc3NhZ2UucGljID0gJHNjb3BlLnVzZXIucGljdHVyZTtcblxuICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2VzLnB1c2gobWVzc2FnZSk7XG5cbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBrZWVwS2V5Ym9hcmRPcGVuKCk7XG4gICAgICAgICAgICAgICAgdmlld1Njcm9sbC5zY3JvbGxCb3R0b20odHJ1ZSk7XG4gICAgICAgICAgICB9LCAwKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlcy5wdXNoKE1vY2tTZXJ2aWNlLmdldE1vY2tNZXNzYWdlKCkpO1xuICAgICAgICAgICAgICAgIGtlZXBLZXlib2FyZE9wZW4oKTtcbiAgICAgICAgICAgICAgICB2aWV3U2Nyb2xsLnNjcm9sbEJvdHRvbSh0cnVlKTtcbiAgICAgICAgICAgIH0sIDIwMDApO1xuXG4gICAgICAgICAgICAvL30pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHRoaXMga2VlcHMgdGhlIGtleWJvYXJkIG9wZW4gb24gYSBkZXZpY2Ugb25seSBhZnRlciBzZW5kaW5nIGEgbWVzc2FnZSwgaXQgaXMgbm9uIG9idHJ1c2l2ZVxuICAgICAgICBmdW5jdGlvbiBrZWVwS2V5Ym9hcmRPcGVuKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2tlZXBLZXlib2FyZE9wZW4nKTtcbiAgICAgICAgICAgIHR4dElucHV0Lm9uZSgnYmx1cicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndGV4dGFyZWEgYmx1ciwgZm9jdXMgYmFjayBvbiBpdCcpO1xuICAgICAgICAgICAgICAgIHR4dElucHV0WzBdLmZvY3VzKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG9uUHJvZmlsZVBpY0Vycm9yKGVsZSkge1xuICAgICAgICAgICAgdGhpcy5lbGUuc3JjID0gJyc7IC8vIHNldCBhIGZhbGxiYWNrXG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUub25NZXNzYWdlSG9sZCA9IGZ1bmN0aW9uIChlLCBpdGVtSW5kZXgsIG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdvbk1lc3NhZ2VIb2xkJyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbWVzc2FnZTogJyArIEpTT04uc3RyaW5naWZ5KG1lc3NhZ2UsIG51bGwsIDIpKTtcbiAgICAgICAgICAgICRpb25pY0FjdGlvblNoZWV0LnNob3coe1xuICAgICAgICAgICAgICAgIGJ1dHRvbnM6IFt7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdDb3B5IFRleHQnXG4gICAgICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnRGVsZXRlIE1lc3NhZ2UnXG4gICAgICAgICAgICAgICAgfV0sXG4gICAgICAgICAgICAgICAgYnV0dG9uQ2xpY2tlZDogZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDogLy8gQ29weSBUZXh0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9jb3Jkb3ZhLnBsdWdpbnMuY2xpcGJvYXJkLmNvcHkobWVzc2FnZS50ZXh0KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxOiAvLyBEZWxldGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBubyBzZXJ2ZXIgc2lkZSBzZWNyZXRzIGhlcmUgOn4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2VzLnNwbGljZShpdGVtSW5kZXgsIDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlld1Njcm9sbC5yZXNpemUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gdGhpcyBwcm9iIHNlZW1zIHdlaXJkIGhlcmUgYnV0IEkgaGF2ZSByZWFzb25zIGZvciB0aGlzIGluIG15IGFwcCwgc2VjcmV0IVxuICAgICAgICAkc2NvcGUudmlld1Byb2ZpbGUgPSBmdW5jdGlvbiAobXNnKSB7XG4gICAgICAgICAgICBpZiAobXNnLnVzZXJJZCA9PT0gJHNjb3BlLnVzZXIuX2lkKSB7XG4gICAgICAgICAgICAgICAgLy8gZ28gdG8geW91ciBwcm9maWxlXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGdvIHRvIG90aGVyIHVzZXJzIHByb2ZpbGVcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuXG4gICAgICAgICRzY29wZS4kb24oJ3RhUmVzaXplJywgZnVuY3Rpb24gKGUsIHRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygndGFSZXNpemUnKTtcbiAgICAgICAgICAgIGlmICghdGEpIHJldHVybjtcblxuICAgICAgICAgICAgdmFyIHRhSGVpZ2h0ID0gdGFbMF0ub2Zmc2V0SGVpZ2h0O1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3RhSGVpZ2h0OiAnICsgdGFIZWlnaHQpO1xuXG4gICAgICAgICAgICBpZiAoIWZvb3RlckJhcikgcmV0dXJuO1xuXG4gICAgICAgICAgICB2YXIgbmV3Rm9vdGVySGVpZ2h0ID0gdGFIZWlnaHQgKyAxMDtcbiAgICAgICAgICAgIG5ld0Zvb3RlckhlaWdodCA9IChuZXdGb290ZXJIZWlnaHQgPiA0NCkgPyBuZXdGb290ZXJIZWlnaHQgOiA0NDtcblxuICAgICAgICAgICAgZm9vdGVyQmFyLnN0eWxlLmhlaWdodCA9IG5ld0Zvb3RlckhlaWdodCArICdweCc7XG4gICAgICAgICAgICBzY3JvbGxlci5zdHlsZS5ib3R0b20gPSBuZXdGb290ZXJIZWlnaHQgKyAncHgnO1xuICAgICAgICB9KTtcblxuICAgIH1cbn0pKCk7XG5cblxuXG5cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5tZXNzYWdlcycpXG5cbiAgICAgICAgLmZpbHRlcignbmwyYnInLCBbJyRmaWx0ZXInLCBubDJicl0pXG5cbiAgICBmdW5jdGlvbiBubDJicigkZmlsdGVyKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLnJlcGxhY2UoL1xcblxccj8vZywgJzxiciAvPicpO1xuICAgICAgICB9O1xuICAgIH1cbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIG1lc3NhZ2VzU2VydmljZS4kaW5qZWN0ID0gW1wiZmlyZWJhc2VTZXJ2aWNlXCJdO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLm1lc3NhZ2VzJylcbiAgICAgICAgLnNlcnZpY2UoJ21lc3NhZ2VzU2VydmljZScsIG1lc3NhZ2VzU2VydmljZSk7XG5cbiAgICBmdW5jdGlvbiBtZXNzYWdlc1NlcnZpY2UoZmlyZWJhc2VTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge307XG5cdFx0XG4gICAgICAgIHNlcnZpY2UuZ2V0TWVzc2FnZXNSZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyZWJhc2VTZXJ2aWNlLmZiLmRhdGFiYXNlKCkucmVmKCdtZXNzYWdlcycpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNlcnZpY2UuYWRkTWVzc2FnZSA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyZWJhc2VTZXJ2aWNlLmZiLmRhdGFiYXNlKCkucHVzaChtZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBwcm9maWxlQ29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJGlvbmljTG9hZGluZ1wiLCBcIiRpb25pY1BvcHVwXCIsIFwiYXV0aFNlcnZpY2VcIiwgXCJwcm9maWxlc1NlcnZpY2VcIl07XG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAucHJvZmlsZXNcIilcblxuICAgICAgICAuY29udHJvbGxlcihcInByb2ZpbGVDb250cm9sbGVyXCIsIHByb2ZpbGVDb250cm9sbGVyKTtcblxuXG4gICAgZnVuY3Rpb24gcHJvZmlsZUNvbnRyb2xsZXIoJHNjb3BlLCAkaW9uaWNMb2FkaW5nLCAkaW9uaWNQb3B1cCwgYXV0aFNlcnZpY2UsIHByb2ZpbGVzU2VydmljZSkge1xuXG5cdFx0dmFyIHVzZXIgPSBhdXRoU2VydmljZS51c2VyKCk7XG5cdFx0XG5cdFx0JHNjb3BlLmRhdGEgPSB7XG5cdFx0XHRkaXNwbGF5TmFtZSA6IHVzZXIgPyB1c2VyLmRpc3BsYXlOYW1lIDogXCJcIixcblx0XHRcdGVtYWlsIDogdXNlciA/IHVzZXIuZW1haWwgOiBcIlwiXG5cdFx0fTtcblxuICAgICAgICAkc2NvcGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHQkaW9uaWNMb2FkaW5nLnNob3coKTtcblxuICAgICAgICAgICAgcHJvZmlsZXNTZXJ2aWNlLnVwZGF0ZVByb2ZpbGUoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzcyhtc2cpIHtcblx0XHRcdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cblx0XHRcdFx0JGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1Byb2ZpbGVVcGRhdGUhJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6IG1zZ1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvcihlcnJvcikge1xuXHRcdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblxuXHRcdFx0XHQkaW9uaWNQb3B1cC5hbGVydCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnVXBkYXRlIGZhaWxlZCEnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogZXJyb3IubWVzc2FnZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHByb2ZpbGVzU2VydmljZS4kaW5qZWN0ID0gW1wiJHFcIiwgXCIkcm9vdFNjb3BlXCIsIFwiYXV0aFNlcnZpY2VcIiwgXCJ1c2VyXCJdO1xuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLnByb2ZpbGVzXCIpXG5cbiAgICAgICAgLnNlcnZpY2UoXCJwcm9maWxlc1NlcnZpY2VcIiwgcHJvZmlsZXNTZXJ2aWNlKTtcblxuXG4gICAgZnVuY3Rpb24gcHJvZmlsZXNTZXJ2aWNlKCRxLCAkcm9vdFNjb3BlLCBhdXRoU2VydmljZSwgdXNlcikge1xuXHRcdFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdXBkYXRlUHJvZmlsZTogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgICBhdXRoU2VydmljZS51c2VyKCkudXBkYXRlUHJvZmlsZShkYXRhKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShcIlByb2ZpbGUgdXBkYXRlZCFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCduYW1lLWNoYW5nZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3IoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgfVxufSkoKTtcbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgc2lkZW1lbnVDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkc3RhdGVcIiwgXCJjaGFubmVsc1NlcnZpY2VcIiwgXCJhdXRoU2VydmljZVwiXTtcbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5zaWRlbWVudVwiKVxuXG4gICAgICAgIC5jb250cm9sbGVyKFwic2lkZW1lbnVDb250cm9sbGVyXCIsIHNpZGVtZW51Q29udHJvbGxlcik7XG5cblxuICAgIGZ1bmN0aW9uIHNpZGVtZW51Q29udHJvbGxlcigkc2NvcGUsICRzdGF0ZSwgY2hhbm5lbHNTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuXG4gICAgICAgICRzY29wZS51c2VyID0gYXV0aFNlcnZpY2UudXNlcigpO1xuXG4gICAgICAgICRzY29wZS5jaGFubmVscyA9IGNoYW5uZWxzU2VydmljZS5jaGFubmVscztcblxuICAgICAgICAkc2NvcGUuYnVpbGRpbmcgPSB7XG4gICAgICAgICAgICBuYW1lOiBcIlNlbGVjdCBhIGJ1aWxkaW5nXCIsXG4gICAgICAgICAgICBhZGRyZXNzOiBcIlwiLFxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS4kb24oJ2J1aWxkaW5nLXNlbGVjdGVkJywgZnVuY3Rpb24gKGV2ZW50LCBkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuYnVpbGRpbmcubmFtZSA9IGRhdGEubmFtZTtcbiAgICAgICAgICAgICRzY29wZS5idWlsZGluZy5hZGRyZXNzID0gZGF0YS5hZGRyZXNzO1xuXG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS5vcGVuQ2hhbm5lbCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnYXBwLmNoYW5uZWwnLCB7Y2hhbm5lbElkOiBrZXl9KTtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdXNlcnNTZXJ2aWNlLiRpbmplY3QgPSBbXCIkcVwiLCBcImF1dGhTZXJ2aWNlXCJdO1xuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLnVzZXJzXCIpXG5cbiAgICAgICAgLnNlcnZpY2UoXCJ1c2Vyc1NlcnZpY2VcIiwgdXNlcnNTZXJ2aWNlKTtcblxuXG4gICAgZnVuY3Rpb24gdXNlcnNTZXJ2aWNlKCRxLCBhdXRoU2VydmljZSkge1xuXHQgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVwZGF0ZVByb2ZpbGU6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgYXV0aFNlcnZpY2UudXNlcigpLnVwZGF0ZVByb2ZpbGUoZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2VzcygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoXCJQcm9maWxlIHVwZGF0ZWQhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlciA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbmFtZS1jaGFuZ2VkJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcblxuICAgICAgICAubW9kdWxlKCdhcHAnLCBbXG4gICAgICAgICAgICAnaW9uaWMnLFxuICAgICAgICAgICAgJ21vbm9zcGFjZWQuZWxhc3RpYycsXG5cbiAgICAgICAgICAgICdhcHAuZmlyZWJhc2UnLFxuICAgICAgICAgICAgJ2FwcC5hdXRoJyxcblx0XHRcdCdhcHAuY2hhbm5lbHMnLFxuICAgICAgICAgICAgJ2FwcC5zaWRlbWVudScsXG4gICAgICAgICAgICAnYXBwLmJ1aWxkaW5ncycsXG4gICAgICAgICAgICAnYXBwLnByb2ZpbGVzJyxcbiAgICAgICAgICAgICdhcHAubWVzc2FnZXMnLFxuICAgICAgICAgICAgJ2FwcC5kaXJlY3RtZXNzYWdlcydcbiAgICAgICAgXSlcblx0XHRcblx0XHQudmFsdWUoXCJ1c2VyXCIsIG51bGwpXG5cdFx0LnZhbHVlKFwic2VsZWN0ZWRCdWlsZGluZ1wiLCBudWxsKVxuXG4gICAgICAgIC52YWx1ZShcInVzZXJcIiwgbnVsbClcblxuICAgICAgICAucnVuKFtcIiRpb25pY1BsYXRmb3JtXCIsIFwiJHRpbWVvdXRcIiwgXCIkcm9vdFNjb3BlXCIsIGZ1bmN0aW9uICgkaW9uaWNQbGF0Zm9ybSwgJHRpbWVvdXQsICRyb290U2NvcGUpIHtcbiAgICAgICAgICAgICRpb25pY1BsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LmNvcmRvdmEgJiYgd2luZG93LmNvcmRvdmEucGx1Z2lucy5LZXlib2FyZCkge1xuICAgICAgICAgICAgICAgICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvcmRvdmEucGx1Z2lucy5LZXlib2FyZC5kaXNhYmxlU2Nyb2xsKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAod2luZG93LlN0YXR1c0Jhcikge1xuICAgICAgICAgICAgICAgICAgICBTdGF0dXNCYXIuc3R5bGVEZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCduYW1lLWNoYW5nZWQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSk7XG59KSgpO1xuXG5cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG5cbiAgICAgICAgLm1vZHVsZSgnYXBwJylcblxuICAgICAgICAucnVuKFsnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHN0YXRlLCBhdXRoU2VydmljZSkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UudXNlcigpID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSlcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXG5cbiAgICAgICAgLmNvbmZpZyhbXCIkc3RhdGVQcm92aWRlclwiLCBcIiR1cmxSb3V0ZXJQcm92aWRlclwiLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXG4gICAgICAgICAgICAkc3RhdGVQcm92aWRlclxuXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdhcHAnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hcHAnLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NpZGVtZW51Lmh0bWwnLFxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcC5idWlsZGluZ3MnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9idWlsZGluZ3MnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvYnVpbGRpbmdzLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdhcHAuYnVpbGRpbmcnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9idWlsZGluZ3MvOmJ1aWxkaW5nSWQnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvYnVpbGRpbmcuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcC5jaGFubmVsJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvY2hhbm5lbC86Y2hhbm5lbElkJyxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdtZW51Q29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL21lc3NhZ2VzL2NoYXQuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcC5wcm9maWxlJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvcHJvZmlsZScsXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdtZW51Q29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3Byb2ZpbGUvcHJvZmlsZS5odG1sJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnYXBwLm1lc3NhZ2VzJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvbWVzc2FnZXMnLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbWVudUNvbnRlbnQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9tZXNzYWdlcy9tZXNzYWdlcy5odG1sJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcblxuXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdhcHAubG9nb3V0Jywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2xvZ2luXCIsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlUHJvdmlkZXI6IFtcImF1dGhTZXJ2aWNlXCIsIFwiJHN0YXRlXCIsIGZ1bmN0aW9uIChhdXRoU2VydmljZSwgJHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhdXRoU2VydmljZS5sb2dvdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgICAgICAgICAgICAgICAgfV1cbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogXCIvbG9naW5cIixcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwidmlld3MvYXV0aC9sb2dpbi5odG1sXCJcbiAgICAgICAgICAgICAgICB9KTtcblxuXG4gICAgICAgICAgICAvL2ZhbGxiYWNrXG4gICAgICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvbG9naW4nKTtcblxuICAgICAgICB9XSk7XG59KSgpO1xuXG5cblxuXG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYXV0aFwiKVxuXG4gICAgICAgIC5zZXJ2aWNlKFwiYXV0aFNlcnZpY2VcIiwgYXV0aFNlcnZpY2UpO1xuXG5cdGZ1bmN0aW9uIGNyZWF0ZVVzZXIodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG5cdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblx0XHR2YXIgYXV0aCA9IGZpcmViYXNlU2VydmljZS5mYi5hdXRoKCk7XG5cblx0XHRyZXR1cm4gYXV0aC5jcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQoZW1haWwsIHBhc3N3b3JkKTtcblx0fVxuXHRcbiAgICBmdW5jdGlvbiBhdXRoU2VydmljZSgkcSwgJHJvb3RTY29wZSwgdXNlciwgYnVpbGRpbmdzU2VydmljZSwgc2VsZWN0ZWRCdWlsZGluZykge1xuXHRcdHZhciBhdXRoID0gZmlyZWJhc2UuYXV0aCgpO1xuXHRcdFxuXHRcdCRyb290U2NvcGUuJG9uKCduYW1lLWNoYW5nZWQnLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciB1c3IgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7XG5cdFx0XHRpZiAodXNyID09IG51bGwpIHJldHVybjtcblx0XHRcdFxuXHRcdFx0ZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoJ3VzZXJzLycgKyB1c3IudWlkKS5zZXQoe1xuXHRcdFx0XHRuYW1lOiB1c3IuZGlzcGxheU5hbWUsXG5cdFx0XHRcdGVtYWlsOiB1c3IuZW1haWwsXG5cdFx0XHRcdGxhc3RBY3Rpdml0eTogbmV3IERhdGUoKS5nZXRUaW1lKClcblx0XHRcdH0pO1xuXHRcdH0pO1xuXG5cdFx0cmV0dXJuIHtcbiAgICAgICAgICAgIGxvZ2luOiBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICAgICAgICAgIHZhciBwcm9taXNlID0gZGVmZXJyZWQucHJvbWlzZTtcblxuXHRcdFx0XHR2YXIgc3VjY2Vzc0hhbmRsZXIgPSBmdW5jdGlvbihpbmZvKSB7XG5cdFx0XHRcdFx0aW5mby5pc05ldyA9IGluZm8uZGlzcGxheU5hbWUgPT0gbnVsbDtcblx0XHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGluZm8pO1xuXHRcdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0dXNlciA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcblx0XHRcdFx0XHQkcm9vdFNjb3BlLiRlbWl0KCduYW1lLWNoYW5nZWQnKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHR2YXIgZXJyb3JIYW5kbGVyID0gZnVuY3Rpb24oZXJyb3IpIHtcblx0XHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuXHRcdFx0XHR9O1xuXG5cdFx0XHRcdGF1dGguc2lnbkluV2l0aEVtYWlsQW5kUGFzc3dvcmQodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0XHRcdC50aGVuKHN1Y2Nlc3NIYW5kbGVyLCBmdW5jdGlvbiBlcnJvcihlcnJvcikge1xuXHRcdFx0XHRcdFx0aWYgKGVycm9yLmNvZGUgPT0gXCJhdXRoL3VzZXItbm90LWZvdW5kXCIpIHtcblx0XHRcdFx0XHRcdFx0YXV0aC5jcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0XHRcdFx0XHRcdC50aGVuKHN1Y2Nlc3NIYW5kbGVyLCBlcnJvckhhbmRsZXIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0XHRcdGVycm9ySGFuZGxlcihlcnJvcik7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSk7XG5cbiAgICAgICAgICAgICAgICBwcm9taXNlLnN1Y2Nlc3MgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4oZm4pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcHJvbWlzZS5lcnJvciA9IGZ1bmN0aW9uKGZuKSB7XG4gICAgICAgICAgICAgICAgICAgIHByb21pc2UudGhlbihudWxsLCBmbik7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwcm9taXNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG5cblx0XHRcdGxvZ291dDogZnVuY3Rpb24gKCkge1xuXHRcdFx0XHRhdXRoLnNpZ25PdXQoKTtcblx0XHRcdFx0dXNlciA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcblx0XHRcdH0sXG5cbiAgICAgICAgICAgIHVzZXI6IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRyZXR1cm4gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYnVpbGRpbmdzXCIpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoXCJidWlsZGluZ0NvbnRyb2xsZXJcIiwgYnVpbGRpbmdDb250cm9sbGVyKTtcblxuXG4gICAgZnVuY3Rpb24gYnVpbGRpbmdDb250cm9sbGVyKCRzY29wZSwgJGlvbmljTG9hZGluZywgJHN0YXRlUGFyYW1zLCBjaGFubmVsc1NlcnZpY2UpIHtcblxuICAgICAgICB2YXIgcmVmID0gY2hhbm5lbHNTZXJ2aWNlLmdldENoYW5uZWxzRnJvbSgkc3RhdGVQYXJhbXMuYnVpbGRpbmdJZCk7XG5cbiAgICAgICAgJGlvbmljTG9hZGluZy5zaG93KCk7XG4gICAgICAgIHJlZi5vbihcInZhbHVlXCIsIGZ1bmN0aW9uIChzbmFwc2hvdCkge1xuICAgICAgICAgICAgdmFyIHZhbCA9IHNuYXBzaG90LnZhbCgpO1xuXG4gICAgICAgICAgICBpZiAodmFsKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmNoYW5uZWxzID0gYW5ndWxhci5leHRlbmQodmFsLmNvbW1vbiwgdmFsLnNlcnZpY2VzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblxuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3JPYmplY3QpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3IgcmVhZGluZzogXCIgKyBlcnJvck9iamVjdC5jb2RlKTtcbiAgICAgICAgICAgIHZhciBhbGVydFBvcHVwID0gJGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnT3BzIScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdTb3JyeSEgQW4gZXJyb3Igb2N1cnJlZC4nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgICAgICB9KTtcblxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5idWlsZGluZ3NcIilcblxuICAgICAgICAuY29udHJvbGxlcihcImJ1aWxkaW5nc0NvbnRyb2xsZXJcIiwgYnVpbGRpbmdzQ29udHJvbGxlcik7XG5cblxuICAgIGZ1bmN0aW9uIGJ1aWxkaW5nc0NvbnRyb2xsZXIoJHNjb3BlLCAkaW9uaWNMb2FkaW5nLCBidWlsZGluZ3NTZXJ2aWNlLCBzZWxlY3RlZEJ1aWxkaW5nKSB7XG4gICAgICAgIHZhciByZWYgPSBidWlsZGluZ3NTZXJ2aWNlLmdldEJ1aWxkaW5ncygpO1xuXHRcdFxuXHRcdCRzY29wZS5zZWxlY3RlZEtleSA9IHNlbGVjdGVkQnVpbGRpbmcgPyBzZWxlY3RlZEJ1aWxkaW5nLmtleSA6IG51bGw7XG5cdFx0XG5cdFx0JHNjb3BlLnNlbGVjdCA9IGZ1bmN0aW9uKGtleSwgYnVpbGRpbmcpIHtcblx0XHRcdCRzY29wZS5zZWxlY3RlZEtleSA9IGJ1aWxkaW5nLmtleSA9IGtleTtcblx0XHRcdHNlbGVjdGVkQnVpbGRpbmcgPSBidWlsZGluZztcblx0XHRcdCRzY29wZS4kZW1pdChcImJ1aWxkaW5nLXNlbGVjdGVkXCIsIHNlbGVjdGVkQnVpbGRpbmcpO1xuXHRcdH07XHRcdFxuXG4gICAgICAgICRpb25pY0xvYWRpbmcuc2hvdygpO1xuICAgICAgICByZWYub24oXCJ2YWx1ZVwiLCBmdW5jdGlvbiAoc25hcHNob3QpIHtcbiAgICAgICAgICAgICRzY29wZS5idWlsZGluZ3MgPSBzbmFwc2hvdC52YWwoKTtcbiAgICAgICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3JPYmplY3QpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3IgcmVhZGluZzogXCIgKyBlcnJvck9iamVjdC5jb2RlKTtcbiAgICAgICAgICAgIHZhciBhbGVydFBvcHVwID0gJGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgIHRpdGxlOiAnT3BzIScsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdTb3JyeSEgQW4gZXJyb3Igb2N1cnJlZCdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5idWlsZGluZ3MnKVxuICAgICAgICAuc2VydmljZSgnYnVpbGRpbmdzU2VydmljZScsIGJ1aWxkaW5nc1NlcnZpY2UpO1xuXG4gICAgZnVuY3Rpb24gYnVpbGRpbmdzU2VydmljZShmaXJlYmFzZVNlcnZpY2UsICRyb290U2NvcGUpIHtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0QnVpbGRpbmdzOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCdidWlsZGluZ3MnKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuY2hhbm5lbHMnKVxuICAgICAgICAuc2VydmljZSgnY2hhbm5lbHNTZXJ2aWNlJywgY2hhbm5lbHNTZXJ2aWNlKTtcblxuICAgIGZ1bmN0aW9uIGNoYW5uZWxzU2VydmljZSgpIHtcblx0XHR2YXIgc2VydmljZSA9IHt9O1xuXHRcdFxuXHRcdHNlcnZpY2UuY2hhbm5lbHMgPSB7XG5cdFx0XHRcImxhbmRsb3JkXCI6IFwiVGFsayB0byBsYW5kbG9yZFwiLFxuXHRcdFx0XCJnZW5lcmFsXCI6IFwiR2VuZXJhbFwiLFxuXHRcdFx0XCJwYXJraW5nXCI6IFwiUGFya2luZyBHYXJhZ2VcIixcblx0XHRcdFwiZ2FyZGVuXCI6IFwiR2FyZGVuXCIsXG5cdFx0XHRcImxvc3Rmb3VuZFwiOiBcIkxvc3QgJiBGb3VuZFwiLFxuXHRcdFx0XCJtYWludGVuYW5jZVwiOiBcIlJlcXVlc3QgTWFpbnRlbmFuY2VcIlxuXHRcdH07XG5cdFx0XG5cdFx0c2VydmljZS5nZXRDaGFubmVsc0Zyb20gPSBmdW5jdGlvbiAoYnVpbGRpbmcpIHtcblx0XHRcdHJldHVybiBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZignYnVpbGRpbmdzLycgKyBidWlsZGluZyArIFwiL2NoYW5uZWxzXCIpO1xuXHRcdH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgfVxufSkoKTtcblxuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5kaXJlY3RtZXNzYWdlcycpXG4gICAgICAgIC5jb250cm9sbGVyKCdkaXJlY3RNZXNzYWdlc0NvbnRyb2xsZXInLCBbXG4gICAgICAgICAgICAnJHNjb3BlJyxcbiAgICAgICAgICAgICckaW9uaWNMb2FkaW5nJyxcbiAgICAgICAgICAgICdkaXJlY3RNZXNzYWdlc1NlcnZpY2UnLFxuICAgICAgICAgICAgJ2F1dGhTZXJ2aWNlJyxcbiAgICAgICAgICAgIGRpcmVjdE1lc3NhZ2VzQ29udHJvbGxlclxuICAgICAgICBdKTtcblxuICAgIGZ1bmN0aW9uIGRpcmVjdE1lc3NhZ2VzQ29udHJvbGxlcigkc2NvcGUsICRpb25pY0xvYWRpbmcsIGNvbnRhY3RzU2VydmljZSwgYXV0aFNlcnZpY2UpIHtcbiAgICAgICAgdmFyIHVzZXIgPSBhdXRoU2VydmljZS51c2VyKCk7XG5cbiAgICAgICAgY29uc29sZS5sb2codXNlci51aWQpO1xuXG4gICAgICAgIHZhciByZWYgPSBjb250YWN0c1NlcnZpY2UuZ2V0VXNlckNvbnRhY3RzKHVzZXIudWlkKTtcblxuICAgICAgICBjb25zb2xlLmxvZyhyZWYpO1xuXG4gICAgICAgICRpb25pY0xvYWRpbmcuc2hvdygpO1xuICAgICAgICByZWYub24oXCJ2YWx1ZVwiLCBmdW5jdGlvbiAoc25hcHNob3QpIHtcbiAgICAgICAgICAgIHZhciB2YWwgPSBzbmFwc2hvdC52YWwoKTtcblxuICAgICAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jb250YWN0cyA9IGFuZ3VsYXIuZXh0ZW5kKHZhbC5jb21tb24sIHZhbC5zZXJ2aWNlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh2YWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvck9iamVjdCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJlcnJvciByZWFkaW5nOiBcIiArIGVycm9yT2JqZWN0LmNvZGUpO1xuICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG4gICAgICAgICAgICB2YXIgYWxlcnRQb3B1cCA9ICRpb25pY1BvcHVwLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ09wcyEnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnU29ycnkhIEFuIGVycm9yIG9jdXJyZWQuJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKCRzY29wZS5jb250YWN0cyk7XG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmRpcmVjdG1lc3NhZ2VzJylcbiAgICAgICAgLnNlcnZpY2UoJ2RpcmVjdE1lc3NhZ2VzU2VydmljZScsIGRpcmVjdE1lc3NhZ2VzU2VydmljZSk7XG5cbiAgICBmdW5jdGlvbiBkaXJlY3RNZXNzYWdlc1NlcnZpY2UoZmlyZWJhc2VTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge307XG5cbiAgICAgICAgc2VydmljZS5nZXRVc2VyQ29udGFjdHMgPSBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICAgICAgcmV0dXJuIGZpcmViYXNlU2VydmljZS5mYi5kYXRhYmFzZSgpLnJlZigndXNlcnMvJyArIHVzZXIgKyAnL2NvbnRhY3RzJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuZmlyZWJhc2UnKVxuICAgICAgICAuc2VydmljZSgnZmlyZWJhc2VTZXJ2aWNlJywgZmlyZWJhc2VTZXJ2aWNlKTtcblxuXG4gICAgZnVuY3Rpb24gZmlyZWJhc2VTZXJ2aWNlKCkge1xuICAgICAgICB2YXIgY29uZmlnID0ge1xuICAgICAgICAgICAgYXBpS2V5OiBcIkFJemFTeUI1cTgxQUdHb3g0aTgtUUwyS090bkREZmkwNWlyZ2NIRVwiLFxuICAgICAgICAgICAgYXV0aERvbWFpbjogXCJzb2NpYWxzdHJhdGFpZGVhdGVhbS5maXJlYmFzZWFwcC5jb21cIixcbiAgICAgICAgICAgIGRhdGFiYXNlVVJMOiBcImh0dHBzOi8vc29jaWFsc3RyYXRhaWRlYXRlYW0uZmlyZWJhc2Vpby5jb21cIixcbiAgICAgICAgICAgIHN0b3JhZ2VCdWNrZXQ6IFwiXCIsXG4gICAgICAgIH07XG5cbiAgICAgICAgdGhpcy5mYiA9IGZpcmViYXNlLmluaXRpYWxpemVBcHAoY29uZmlnKTtcbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5tZXNzYWdlcycpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ21lc3NhZ2VzQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJHN0YXRlJyxcbiAgICAgICAgICAgICckc3RhdGVQYXJhbXMnLCAnJGlvbmljQWN0aW9uU2hlZXQnLFxuICAgICAgICAgICAgJyRpb25pY1BvcHVwJywgJyRpb25pY1Njcm9sbERlbGVnYXRlJywgJyR0aW1lb3V0JywgJyRpbnRlcnZhbCcsICdjaGFubmVsc1NlcnZpY2UnLFxuICAgICAgICAgICAgbWVzc2FnZXNDb250cm9sbGVyXG4gICAgICAgIF0pXG5cbiAgICBmdW5jdGlvbiBtZXNzYWdlc0NvbnRyb2xsZXIoJHNjb3BlLCAkcm9vdFNjb3BlLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgJGlvbmljQWN0aW9uU2hlZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpb25pY1BvcHVwLCAkaW9uaWNTY3JvbGxEZWxlZ2F0ZSwgJHRpbWVvdXQsICRpbnRlcnZhbCwgY2hhbm5lbHNTZXJ2aWNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcblx0XHQkc2NvcGUuY2hhbm5lbE5hbWUgPSBjaGFubmVsc1NlcnZpY2UuY2hhbm5lbHNbJHN0YXRlLnBhcmFtcy5jaGFubmVsSWRdO1x0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0XHRcbiAgICAgICAgLy8gbW9jayBhY3F1aXJpbmcgZGF0YSB2aWEgJHN0YXRlUGFyYW1zXG4gICAgICAgICRzY29wZS50b1VzZXIgPSB7XG4gICAgICAgICAgICBfaWQ6ICc1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWInLFxuICAgICAgICAgICAgcGljOiAnaHR0cDovL2lvbmljZnJhbWV3b3JrLmNvbS9pbWcvZG9jcy92ZW5rbWFuLmpwZycsXG4gICAgICAgICAgICBjaGFubmVsOiAkc3RhdGUucGFyYW1zLmNoYW5uZWxJZFxuICAgICAgICB9XG5cbiAgICAgICAgLy8gdGhpcyBjb3VsZCBiZSBvbiAkcm9vdFNjb3BlIHJhdGhlciB0aGFuIGluICRzdGF0ZVBhcmFtc1xuICAgICAgICAkc2NvcGUudXNlciA9IHtcbiAgICAgICAgICAgIF9pZDogJzUzNGI4ZmIyYWE1ZTdhZmMxYjIzZTY5YycsXG4gICAgICAgICAgICBwaWM6ICdodHRwOi8vaW9uaWNmcmFtZXdvcmsuY29tL2ltZy9kb2NzL21jZmx5LmpwZycsXG4gICAgICAgICAgICB1c2VybmFtZTogJ01hcnR5J1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pbnB1dCA9IHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IGxvY2FsU3RvcmFnZVsndXNlck1lc3NhZ2UtJyArICRzY29wZS50b1VzZXIuX2lkXSB8fCAnJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBtZXNzYWdlQ2hlY2tUaW1lcjtcblxuICAgICAgICB2YXIgdmlld1Njcm9sbCA9ICRpb25pY1Njcm9sbERlbGVnYXRlLiRnZXRCeUhhbmRsZSgndXNlck1lc3NhZ2VTY3JvbGwnKTtcbiAgICAgICAgdmFyIGZvb3RlckJhcjsgLy8gZ2V0cyBzZXQgaW4gJGlvbmljVmlldy5lbnRlclxuICAgICAgICB2YXIgc2Nyb2xsZXI7XG4gICAgICAgIHZhciB0eHRJbnB1dDsgLy8gXl5eXG5cbiAgICAgICAgJHNjb3BlLiRvbignJGlvbmljVmlldy5lbnRlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyTWVzc2FnZXMgJGlvbmljVmlldy5lbnRlcicpO1xuXG4gICAgICAgICAgICBnZXRNZXNzYWdlcygpO1xuXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZm9vdGVyQmFyID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcjdXNlck1lc3NhZ2VzVmlldyAuYmFyLWZvb3RlcicpO1xuICAgICAgICAgICAgICAgIHNjcm9sbGVyID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcjdXNlck1lc3NhZ2VzVmlldyAuc2Nyb2xsLWNvbnRlbnQnKTtcbiAgICAgICAgICAgICAgICB0eHRJbnB1dCA9IGFuZ3VsYXIuZWxlbWVudChmb290ZXJCYXIucXVlcnlTZWxlY3RvcigndGV4dGFyZWEnKSk7XG4gICAgICAgICAgICB9LCAwKTtcblxuICAgICAgICAgICAgbWVzc2FnZUNoZWNrVGltZXIgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vIGhlcmUgeW91IGNvdWxkIGNoZWNrIGZvciBuZXcgbWVzc2FnZXMgaWYgeW91ciBhcHAgZG9lc24ndCB1c2UgcHVzaCBub3RpZmljYXRpb25zIG9yIHVzZXIgZGlzYWJsZWQgdGhlbVxuICAgICAgICAgICAgfSwgMjAwMDApO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCckaW9uaWNWaWV3LmxlYXZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2xlYXZpbmcgVXNlck1lc3NhZ2VzIHZpZXcsIGRlc3Ryb3lpbmcgaW50ZXJ2YWwnKTtcbiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBpbnRlcnZhbCBpcyBkZXN0cm95ZWRcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChtZXNzYWdlQ2hlY2tUaW1lcikpIHtcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKG1lc3NhZ2VDaGVja1RpbWVyKTtcbiAgICAgICAgICAgICAgICBtZXNzYWdlQ2hlY2tUaW1lciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJGlvbmljVmlldy5iZWZvcmVMZWF2ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghJHNjb3BlLmlucHV0Lm1lc3NhZ2UgfHwgJHNjb3BlLmlucHV0Lm1lc3NhZ2UgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXJNZXNzYWdlLScgKyAkc2NvcGUudG9Vc2VyLl9pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldE1lc3NhZ2VzKCkge1xuICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2VzID0gW3tcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjUzNWQ2MjVmODk4ZGY0ZTgwZTJhMTI1ZVwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIklvbmljIGhhcyBjaGFuZ2VkIHRoZSBnYW1lIGZvciBoeWJyaWQgYXBwIGRldmVsb3BtZW50LlwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhmYjJhYTVlN2FmYzFiMjNlNjljXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0wNC0yN1QyMDowMjozOS4wODJaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzcuOTQ0WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1MzVmMTNmZmVlM2IyYTY4MTEyYjlmYzBcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJJIGxpa2UgSW9uaWMgYmV0dGVyIHRoYW4gaWNlIGNyZWFtIVwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhlNWFhYTVlN2FmYzFiMjNlNjliXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0wNC0yOVQwMjo1Mjo0Ny43MDZaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzcuOTQ0WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDZhNTg0M2ZkNGM1ZDU4MWVmYTI2M2FcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCwgY29uc2VjdGV0dXIgYWRpcGlzY2luZyBlbGl0LCBzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRpZHVudCB1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YS4gVXQgZW5pbSBhZCBtaW5pbSB2ZW5pYW0sIHF1aXMgbm9zdHJ1ZCBleGVyY2l0YXRpb24gdWxsYW1jbyBsYWJvcmlzIG5pc2kgdXQgYWxpcXVpcCBleCBlYSBjb21tb2RvIGNvbnNlcXVhdC4gRHVpcyBhdXRlIGlydXJlIGRvbG9yIGluIHJlcHJlaGVuZGVyaXQgaW4gdm9sdXB0YXRlIHZlbGl0IGVzc2UgY2lsbHVtIGRvbG9yZSBldSBmdWdpYXQgbnVsbGEgcGFyaWF0dXIuIEV4Y2VwdGV1ciBzaW50IG9jY2FlY2F0IGN1cGlkYXRhdCBub24gcHJvaWRlbnQsIHN1bnQgaW4gY3VscGEgcXVpIG9mZmljaWEgZGVzZXJ1bnQgbW9sbGl0IGFuaW0gaWQgZXN0IGxhYm9ydW0uXCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGZiMmFhNWU3YWZjMWIyM2U2OWNcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTE3VDIwOjE5OjE1LjI4OVpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMjhaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzY0Mzk5YWI0M2QxZDQxMTNhYmZkMVwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIkFtIEkgZHJlYW1pbmc/XCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWJcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI2VDIxOjE4OjE3LjU5MVpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzdaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzY0M2FlYWI0M2QxZDQxMTNhYmZkMlwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIklzIHRoaXMgbWFnaWM/XCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGZiMmFhNWU3YWZjMWIyM2U2OWNcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI2VDIxOjE4OjM4LjU0OVpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzhaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzgxNWRiYWI0M2QxZDQxMTNhYmZlZlwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIkdlZSB3aXosIHRoaXMgaXMgc29tZXRoaW5nIHNwZWNpYWwuXCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWJcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI4VDA2OjI3OjQwLjAwMVpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzhaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzgxYzY5YWI0M2QxZDQxMTNhYmZmMFwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIkkgdGhpbmsgSSBsaWtlIElvbmljIG1vcmUgdGhhbiBJIGxpa2UgaWNlIGNyZWFtIVwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhmYjJhYTVlN2FmYzFiMjNlNjljXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0yOFQwNjo1NTozNy4zNTBaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzM4WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDc4MWNhNGFiNDNkMWQ0MTEzYWJmZjFcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJZZWEsIGl0J3MgcHJldHR5IHN3ZWV0XCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWJcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI4VDA2OjU2OjM2LjQ3MlpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzhaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzhkZjg2YWI0M2QxZDQxMTNhYmZmNFwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIldvdywgdGhpcyBpcyByZWFsbHkgc29tZXRoaW5nIGh1aD9cIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZmIyYWE1ZTdhZmMxYjIzZTY5Y1wiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMTEtMjhUMjA6NDg6MDYuNTcyWlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM4LjMzOVpcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTQ3ODFjYTRhYjQzZDFkNDExM2FiZmYxXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiQ3JlYXRlIGFtYXppbmcgYXBwcyAtIGlvbmljZnJhbWV3b3JrLmNvbVwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhlNWFhYTVlN2FmYzFiMjNlNjliXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0yOVQwNjo1NjozNi40NzJaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzM4WlwiXG4gICAgICAgICAgICB9XTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2lucHV0Lm1lc3NhZ2UnLCBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnaW5wdXQubWVzc2FnZSAkd2F0Y2gsIG5ld1ZhbHVlICcgKyBuZXdWYWx1ZSk7XG4gICAgICAgICAgICBpZiAoIW5ld1ZhbHVlKSBuZXdWYWx1ZSA9ICcnO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlWyd1c2VyTWVzc2FnZS0nICsgJHNjb3BlLnRvVXNlci5faWRdID0gbmV3VmFsdWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uIChzZW5kTWVzc2FnZUZvcm0pIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIHRvSWQ6ICRzY29wZS50b1VzZXIuX2lkLFxuICAgICAgICAgICAgICAgIHRleHQ6ICRzY29wZS5pbnB1dC5tZXNzYWdlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBpZiB5b3UgZG8gYSB3ZWIgc2VydmljZSBjYWxsIHRoaXMgd2lsbCBiZSBuZWVkZWQgYXMgd2VsbCBhcyBiZWZvcmUgdGhlIHZpZXdTY3JvbGwgY2FsbHNcbiAgICAgICAgICAgIC8vIHlvdSBjYW4ndCBzZWUgdGhlIGVmZmVjdCBvZiB0aGlzIGluIHRoZSBicm93c2VyIGl0IG5lZWRzIHRvIGJlIHVzZWQgb24gYSByZWFsIGRldmljZVxuICAgICAgICAgICAgLy8gZm9yIHNvbWUgcmVhc29uIHRoZSBvbmUgdGltZSBibHVyIGV2ZW50IGlzIG5vdCBmaXJpbmcgaW4gdGhlIGJyb3dzZXIgYnV0IGRvZXMgb24gZGV2aWNlc1xuICAgICAgICAgICAga2VlcEtleWJvYXJkT3BlbigpO1xuXG4gICAgICAgICAgICAvL01vY2tTZXJ2aWNlLnNlbmRNZXNzYWdlKG1lc3NhZ2UpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLmlucHV0Lm1lc3NhZ2UgPSAnJztcblxuICAgICAgICAgICAgbWVzc2FnZS5faWQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgLy8gOn4pXG4gICAgICAgICAgICBtZXNzYWdlLmRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgbWVzc2FnZS51c2VybmFtZSA9ICRzY29wZS51c2VyLnVzZXJuYW1lO1xuICAgICAgICAgICAgbWVzc2FnZS51c2VySWQgPSAkc2NvcGUudXNlci5faWQ7XG4gICAgICAgICAgICBtZXNzYWdlLnBpYyA9ICRzY29wZS51c2VyLnBpY3R1cmU7XG5cbiAgICAgICAgICAgICRzY29wZS5tZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAga2VlcEtleWJvYXJkT3BlbigpO1xuICAgICAgICAgICAgICAgIHZpZXdTY3JvbGwuc2Nyb2xsQm90dG9tKHRydWUpO1xuICAgICAgICAgICAgfSwgMCk7XG5cbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZXMucHVzaChNb2NrU2VydmljZS5nZXRNb2NrTWVzc2FnZSgpKTtcbiAgICAgICAgICAgICAgICBrZWVwS2V5Ym9hcmRPcGVuKCk7XG4gICAgICAgICAgICAgICAgdmlld1Njcm9sbC5zY3JvbGxCb3R0b20odHJ1ZSk7XG4gICAgICAgICAgICB9LCAyMDAwKTtcblxuICAgICAgICAgICAgLy99KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyB0aGlzIGtlZXBzIHRoZSBrZXlib2FyZCBvcGVuIG9uIGEgZGV2aWNlIG9ubHkgYWZ0ZXIgc2VuZGluZyBhIG1lc3NhZ2UsIGl0IGlzIG5vbiBvYnRydXNpdmVcbiAgICAgICAgZnVuY3Rpb24ga2VlcEtleWJvYXJkT3BlbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdrZWVwS2V5Ym9hcmRPcGVuJyk7XG4gICAgICAgICAgICB0eHRJbnB1dC5vbmUoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3RleHRhcmVhIGJsdXIsIGZvY3VzIGJhY2sgb24gaXQnKTtcbiAgICAgICAgICAgICAgICB0eHRJbnB1dFswXS5mb2N1cygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBvblByb2ZpbGVQaWNFcnJvcihlbGUpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlLnNyYyA9ICcnOyAvLyBzZXQgYSBmYWxsYmFja1xuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLm9uTWVzc2FnZUhvbGQgPSBmdW5jdGlvbiAoZSwgaXRlbUluZGV4LCBtZXNzYWdlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnb25NZXNzYWdlSG9sZCcpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ21lc3NhZ2U6ICcgKyBKU09OLnN0cmluZ2lmeShtZXNzYWdlLCBudWxsLCAyKSk7XG4gICAgICAgICAgICAkaW9uaWNBY3Rpb25TaGVldC5zaG93KHtcbiAgICAgICAgICAgICAgICBidXR0b25zOiBbe1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnQ29weSBUZXh0J1xuICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0RlbGV0ZSBNZXNzYWdlJ1xuICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNsaWNrZWQ6IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IC8vIENvcHkgVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29yZG92YS5wbHVnaW5zLmNsaXBib2FyZC5jb3B5KG1lc3NhZ2UudGV4dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTogLy8gRGVsZXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm8gc2VydmVyIHNpZGUgc2VjcmV0cyBoZXJlIDp+KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlcy5zcGxpY2UoaXRlbUluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdTY3JvbGwucmVzaXplKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHRoaXMgcHJvYiBzZWVtcyB3ZWlyZCBoZXJlIGJ1dCBJIGhhdmUgcmVhc29ucyBmb3IgdGhpcyBpbiBteSBhcHAsIHNlY3JldCFcbiAgICAgICAgJHNjb3BlLnZpZXdQcm9maWxlID0gZnVuY3Rpb24gKG1zZykge1xuICAgICAgICAgICAgaWYgKG1zZy51c2VySWQgPT09ICRzY29wZS51c2VyLl9pZCkge1xuICAgICAgICAgICAgICAgIC8vIGdvIHRvIHlvdXIgcHJvZmlsZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBnbyB0byBvdGhlciB1c2VycyBwcm9maWxlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cblxuICAgICAgICAkc2NvcGUuJG9uKCd0YVJlc2l6ZScsIGZ1bmN0aW9uIChlLCB0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3RhUmVzaXplJyk7XG4gICAgICAgICAgICBpZiAoIXRhKSByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciB0YUhlaWdodCA9IHRhWzBdLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YUhlaWdodDogJyArIHRhSGVpZ2h0KTtcblxuICAgICAgICAgICAgaWYgKCFmb290ZXJCYXIpIHJldHVybjtcblxuICAgICAgICAgICAgdmFyIG5ld0Zvb3RlckhlaWdodCA9IHRhSGVpZ2h0ICsgMTA7XG4gICAgICAgICAgICBuZXdGb290ZXJIZWlnaHQgPSAobmV3Rm9vdGVySGVpZ2h0ID4gNDQpID8gbmV3Rm9vdGVySGVpZ2h0IDogNDQ7XG5cbiAgICAgICAgICAgIGZvb3RlckJhci5zdHlsZS5oZWlnaHQgPSBuZXdGb290ZXJIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgc2Nyb2xsZXIuc3R5bGUuYm90dG9tID0gbmV3Rm9vdGVySGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgfSk7XG5cbiAgICB9XG59KSgpO1xuXG5cblxuXG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLm1lc3NhZ2VzJylcblxuICAgICAgICAuZmlsdGVyKCdubDJicicsIFsnJGZpbHRlcicsIG5sMmJyXSlcblxuICAgIGZ1bmN0aW9uIG5sMmJyKCRmaWx0ZXIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgICAgICBpZiAoIWRhdGEpIHJldHVybiBkYXRhO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGEucmVwbGFjZSgvXFxuXFxyPy9nLCAnPGJyIC8+Jyk7XG4gICAgICAgIH07XG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLm1lc3NhZ2VzJylcbiAgICAgICAgLnNlcnZpY2UoJ21lc3NhZ2VzU2VydmljZScsIG1lc3NhZ2VzU2VydmljZSk7XG5cbiAgICBmdW5jdGlvbiBtZXNzYWdlc1NlcnZpY2UoZmlyZWJhc2VTZXJ2aWNlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge307XG5cdFx0XG4gICAgICAgIHNlcnZpY2UuZ2V0TWVzc2FnZXNSZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyZWJhc2VTZXJ2aWNlLmZiLmRhdGFiYXNlKCkucmVmKCdtZXNzYWdlcycpO1xuICAgICAgICB9O1xuXG4gICAgICAgIHNlcnZpY2UuYWRkTWVzc2FnZSA9IGZ1bmN0aW9uIChtZXNzYWdlKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyZWJhc2VTZXJ2aWNlLmZiLmRhdGFiYXNlKCkucHVzaChtZXNzYWdlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAucHJvZmlsZXNcIilcblxuICAgICAgICAuY29udHJvbGxlcihcInByb2ZpbGVDb250cm9sbGVyXCIsIHByb2ZpbGVDb250cm9sbGVyKTtcblxuXG4gICAgZnVuY3Rpb24gcHJvZmlsZUNvbnRyb2xsZXIoJHNjb3BlLCAkaW9uaWNMb2FkaW5nLCAkaW9uaWNQb3B1cCwgYXV0aFNlcnZpY2UsIHByb2ZpbGVzU2VydmljZSkge1xuXG5cdFx0dmFyIHVzZXIgPSBhdXRoU2VydmljZS51c2VyKCk7XG5cdFx0XG5cdFx0JHNjb3BlLmRhdGEgPSB7XG5cdFx0XHRkaXNwbGF5TmFtZSA6IHVzZXIgPyB1c2VyLmRpc3BsYXlOYW1lIDogXCJcIixcblx0XHRcdGVtYWlsIDogdXNlciA/IHVzZXIuZW1haWwgOiBcIlwiXG5cdFx0fTtcblxuICAgICAgICAkc2NvcGUudXBkYXRlID0gZnVuY3Rpb24oKSB7XG5cdFx0XHQkaW9uaWNMb2FkaW5nLnNob3coKTtcblxuICAgICAgICAgICAgcHJvZmlsZXNTZXJ2aWNlLnVwZGF0ZVByb2ZpbGUoJHNjb3BlLmRhdGEpLnRoZW4oZnVuY3Rpb24gc3VjY2Vzcyhtc2cpIHtcblx0XHRcdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cblx0XHRcdFx0JGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1Byb2ZpbGVVcGRhdGUhJyxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGU6IG1zZ1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvcihlcnJvcikge1xuXHRcdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblxuXHRcdFx0XHQkaW9uaWNQb3B1cC5hbGVydCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnVXBkYXRlIGZhaWxlZCEnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogZXJyb3IubWVzc2FnZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5wcm9maWxlc1wiKVxuXG4gICAgICAgIC5zZXJ2aWNlKFwicHJvZmlsZXNTZXJ2aWNlXCIsIHByb2ZpbGVzU2VydmljZSk7XG5cblxuICAgIGZ1bmN0aW9uIHByb2ZpbGVzU2VydmljZSgkcSwgJHJvb3RTY29wZSwgYXV0aFNlcnZpY2UsIHVzZXIpIHtcblx0XHRcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVwZGF0ZVByb2ZpbGU6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgYXV0aFNlcnZpY2UudXNlcigpLnVwZGF0ZVByb2ZpbGUoZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2VzcygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoXCJQcm9maWxlIHVwZGF0ZWQhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlciA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbmFtZS1jaGFuZ2VkJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5zaWRlbWVudVwiKVxuXG4gICAgICAgIC5jb250cm9sbGVyKFwic2lkZW1lbnVDb250cm9sbGVyXCIsIHNpZGVtZW51Q29udHJvbGxlcik7XG5cblxuICAgIGZ1bmN0aW9uIHNpZGVtZW51Q29udHJvbGxlcigkc2NvcGUsICRzdGF0ZSwgY2hhbm5lbHNTZXJ2aWNlLCBhdXRoU2VydmljZSkge1xuXG4gICAgICAgICRzY29wZS51c2VyID0gYXV0aFNlcnZpY2UudXNlcigpO1xuXG4gICAgICAgICRzY29wZS5jaGFubmVscyA9IGNoYW5uZWxzU2VydmljZS5jaGFubmVscztcblxuICAgICAgICAkc2NvcGUuYnVpbGRpbmcgPSB7XG4gICAgICAgICAgICBuYW1lOiBcIlNlbGVjdCBhIGJ1aWxkaW5nXCIsXG4gICAgICAgICAgICBhZGRyZXNzOiBcIlwiLFxuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS4kb24oJ2J1aWxkaW5nLXNlbGVjdGVkJywgZnVuY3Rpb24gKGV2ZW50LCBkYXRhKSB7XG4gICAgICAgICAgICAkc2NvcGUuYnVpbGRpbmcubmFtZSA9IGRhdGEubmFtZTtcbiAgICAgICAgICAgICRzY29wZS5idWlsZGluZy5hZGRyZXNzID0gZGF0YS5hZGRyZXNzO1xuXG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS5vcGVuQ2hhbm5lbCA9IGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICRzdGF0ZS5nbygnYXBwLmNoYW5uZWwnLCB7Y2hhbm5lbElkOiBrZXl9KTtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLnVzZXJzXCIpXG5cbiAgICAgICAgLnNlcnZpY2UoXCJ1c2Vyc1NlcnZpY2VcIiwgdXNlcnNTZXJ2aWNlKTtcblxuXG4gICAgZnVuY3Rpb24gdXNlcnNTZXJ2aWNlKCRxLCBhdXRoU2VydmljZSkge1xuXHQgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVwZGF0ZVByb2ZpbGU6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgYXV0aFNlcnZpY2UudXNlcigpLnVwZGF0ZVByb2ZpbGUoZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2VzcygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoXCJQcm9maWxlIHVwZGF0ZWQhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlciA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbmFtZS1jaGFuZ2VkJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG5cbiAgICAgICAgLm1vZHVsZSgnYXBwJywgW1xuICAgICAgICAgICAgJ2lvbmljJyxcbiAgICAgICAgICAgICdtb25vc3BhY2VkLmVsYXN0aWMnLFxuXG4gICAgICAgICAgICAnYXBwLmZpcmViYXNlJyxcbiAgICAgICAgICAgICdhcHAuYXV0aCcsXG5cdFx0XHQnYXBwLmNoYW5uZWxzJyxcbiAgICAgICAgICAgICdhcHAuc2lkZW1lbnUnLFxuICAgICAgICAgICAgJ2FwcC5idWlsZGluZ3MnLFxuICAgICAgICAgICAgJ2FwcC5wcm9maWxlcycsXG4gICAgICAgICAgICAnYXBwLm1lc3NhZ2VzJyxcbiAgICAgICAgICAgICdhcHAuZGlyZWN0bWVzc2FnZXMnXG4gICAgICAgIF0pXG5cdFx0XG5cdFx0LnZhbHVlKFwidXNlclwiLCBudWxsKVxuXHRcdC52YWx1ZShcInNlbGVjdGVkQnVpbGRpbmdcIiwgbnVsbClcblxuICAgICAgICAudmFsdWUoXCJ1c2VyXCIsIG51bGwpXG5cbiAgICAgICAgLnJ1bihmdW5jdGlvbiAoJGlvbmljUGxhdGZvcm0sICR0aW1lb3V0LCAkcm9vdFNjb3BlKSB7XG4gICAgICAgICAgICAkaW9uaWNQbGF0Zm9ybS5yZWFkeShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5jb3Jkb3ZhICYmIHdpbmRvdy5jb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29yZG92YS5wbHVnaW5zLktleWJvYXJkLmhpZGVLZXlib2FyZEFjY2Vzc29yeUJhcih0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuZGlzYWJsZVNjcm9sbCh0cnVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5TdGF0dXNCYXIpIHtcbiAgICAgICAgICAgICAgICAgICAgU3RhdHVzQmFyLnN0eWxlRGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbmFtZS1jaGFuZ2VkJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG59KSgpO1xuXG5cbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXG5cbiAgICAgICAgLnJ1bihbJyRyb290U2NvcGUnLCAnJGxvY2F0aW9uJywgJ2F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRyb290U2NvcGUsICRzdGF0ZSwgYXV0aFNlcnZpY2UpIHtcbiAgICAgICAgICAgICRyb290U2NvcGUuJG9uKCckcm91dGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uIChldmVudCkge1xuXG4gICAgICAgICAgICAgICAgaWYgKGF1dGhTZXJ2aWNlLnVzZXIoKSA9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnbG9naW4nKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfV0pXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG5cbiAgICAgICAgLm1vZHVsZSgnYXBwJylcblxuICAgICAgICAuY29uZmlnKGZ1bmN0aW9uICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG5cbiAgICAgICAgICAgICRzdGF0ZVByb3ZpZGVyXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcCcsIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2FwcCcsXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3Mvc2lkZW1lbnUuaHRtbCcsXG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnYXBwLmJ1aWxkaW5ncycsIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2J1aWxkaW5ncycsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbWVudUNvbnRlbnQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9idWlsZGluZ3MuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcC5idWlsZGluZycsIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2J1aWxkaW5ncy86YnVpbGRpbmdJZCcsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbWVudUNvbnRlbnQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9idWlsZGluZy5odG1sJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnYXBwLmNoYW5uZWwnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9jaGFubmVsLzpjaGFubmVsSWQnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvbWVzc2FnZXMvY2hhdC5odG1sJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnYXBwLnByb2ZpbGUnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9wcm9maWxlJyxcbiAgICAgICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcHJvZmlsZS9wcm9maWxlLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdhcHAubWVzc2FnZXMnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9tZXNzYWdlcycsXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdtZW51Q29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL21lc3NhZ2VzL21lc3NhZ2VzLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcC5sb2dvdXQnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogXCIvbG9naW5cIixcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVQcm92aWRlcjogZnVuY3Rpb24gKGF1dGhTZXJ2aWNlLCAkc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2xvZ2luXCIsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL2F1dGgvbG9naW4uaHRtbFwiXG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgLy9mYWxsYmFja1xuICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2xvZ2luJyk7XG5cbiAgICAgICAgfSk7XG59KSgpO1xuXG5cblxuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
