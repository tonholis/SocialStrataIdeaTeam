!function(){"use strict";angular.module("app.auth",[])}(),function(){"use strict";angular.module("app.buildings",["app.firebase"])}(),function(){"use strict";angular.module("app.firebase",[])}(),function(){"use strict";angular.module("monospaced.elastic",[]).constant("msdElasticConfig",{append:""}).directive("msdElastic",["$timeout","$window","msdElasticConfig",function(e,t,a){return{require:"ngModel",restrict:"A, C",link:function(n,i,r,o){function s(){var e=h;g=c,w=getComputedStyle(c),angular.forEach(T,function(t){e+=t+":"+w.getPropertyValue(t)+";"}),$.setAttribute("style",e)}function u(){var t,a,i,r,o;g!==c&&s(),f||(f=!0,$.value=c.value+m,$.style.overflowY=c.style.overflowY,t=""===c.style.height?"auto":parseInt(c.style.height,10),a=getComputedStyle(c).getPropertyValue("width"),"px"===a.substr(a.length-2,2)&&(r=parseInt(a,10)-x.width,$.style.width=r+"px"),i=$.scrollHeight,i>C?(i=C,o="scroll"):k>i&&(i=k),i+=x.height,c.style.overflowY=o||"hidden",t!==i&&(n.$emit("elastic:resize",d,t,i),c.style.height=i+"px"),e(function(){f=!1},1,!1))}function l(){f=!1,u()}var c=i[0],d=i;if("TEXTAREA"===c.nodeName&&t.getComputedStyle){d.css({overflow:"hidden","overflow-y":"hidden","word-wrap":"break-word"});var p=c.value;c.value="",c.value=p;var g,f,m=r.msdElastic?r.msdElastic.replace(/\\n/g,"\n"):a.append,b=angular.element(t),h="position: absolute; top: -999px; right: auto; bottom: auto;left: 0; overflow: hidden; -webkit-box-sizing: content-box;-moz-box-sizing: content-box; box-sizing: content-box;min-height: 0 !important; height: 0 !important; padding: 0;word-wrap: break-word; border: 0;",v=angular.element('<textarea aria-hidden="true" tabindex="-1" style="'+h+'"/>').data("elastic",!0),$=v[0],w=getComputedStyle(c),y=w.getPropertyValue("resize"),S="border-box"===w.getPropertyValue("box-sizing")||"border-box"===w.getPropertyValue("-moz-box-sizing")||"border-box"===w.getPropertyValue("-webkit-box-sizing"),x=S?{width:parseInt(w.getPropertyValue("border-right-width"),10)+parseInt(w.getPropertyValue("padding-right"),10)+parseInt(w.getPropertyValue("padding-left"),10)+parseInt(w.getPropertyValue("border-left-width"),10),height:parseInt(w.getPropertyValue("border-top-width"),10)+parseInt(w.getPropertyValue("padding-top"),10)+parseInt(w.getPropertyValue("padding-bottom"),10)+parseInt(w.getPropertyValue("border-bottom-width"),10)}:{width:0,height:0},I=parseInt(w.getPropertyValue("min-height"),10),P=parseInt(w.getPropertyValue("height"),10),k=Math.max(I,P)-x.height,C=parseInt(w.getPropertyValue("max-height"),10),T=["font-family","font-size","font-weight","font-style","letter-spacing","line-height","text-transform","word-spacing","text-indent"];d.data("elastic")||(C=C&&C>0?C:9e4,$.parentNode!==document.body&&angular.element(document.body).append($),d.css({resize:"none"===y||"vertical"===y?"none":"horizontal"}).data("elastic",!0),"onpropertychange"in c&&"oninput"in c?c.oninput=c.onkeyup=u:c.oninput=u,b.bind("resize",l),n.$watch(function(){return o.$modelValue},function(e){l()}),n.$on("elastic:adjust",function(){s(),l()}),e(u,0,!1),n.$on("$destroy",function(){v.remove(),b.unbind("resize",l)}))}}}}]),angular.module("app.messages",["monospaced.elastic"])}(),function(){"use strict";angular.module("app.profiles",["app.auth"])}(),function(){"use strict";angular.module("app.sidemenu",[])}(),function(){"use strict";angular.module("app.users",["app.auth"])}(),function(){"use strict";function e(e,t,a,n,i,r){e.data={},e.login=function(){n.show(),t.login(e.data.username,e.data.password).success(function(e){n.hide(),i.go("app.buildings")}).error(function(e){r(function(){n.hide()},100);a.alert({title:"Login failed!",template:e.message})})},e.facebookLogin=function(){a.alert({title:"Facebook login",template:"Planned!"})}}e.$inject=["$scope","authService","$ionicPopup","$ionicLoading","$state","$timeout"],angular.module("app.auth").controller("authController",e)}(),function(){"use strict";function e(e,t,a,n,i){var r=firebase.auth();return t.$on("name-changed",function(){var e=firebase.auth().currentUser;null!=e&&firebase.database().ref("users/"+e.uid).set({name:e.displayName,email:e.email,lastActivity:(new Date).getTime()})}),{login:function(n,i){var o=e.defer(),s=o.promise,u=function(e){e.isNew=null==e.displayName,o.resolve(e),a=firebase.auth().currentUser,t.$emit("name-changed")},l=function(e){o.reject(e)};return r.signInWithEmailAndPassword(n,i).then(u,function c(c){"auth/user-not-found"==c.code?r.createUserWithEmailAndPassword(n,i).then(u,l):l(c)}),s.success=function(e){return s.then(e),s},s.error=function(e){return s.then(null,e),s},s},logout:function(){r.signOut(),a=firebase.auth().currentUser},user:function(){return firebase.auth().currentUser}}}e.$inject=["$q","$rootScope","user","buildingsService","selectedBuilding"],angular.module("app.auth").service("authService",e)}(),function(){"use strict";function e(e){return{getChannelsFrom:function(t){return e.fb.database().ref("buildings/"+t+"/channels")}}}e.$inject=["firebaseService"],angular.module("app.buildings").service("buildingChannelsService",e)}(),function(){"use strict";function e(e,t,a,n){var i=n.getChannelsFrom(a.buildingId);t.show(),i.on("value",function(a){var n=a.val();n&&(e.channels=angular.extend(n.common,n.services)),t.hide()},function(e){console.log("error reading: "+e.code);$ionicPopup.alert({title:"Ops!",template:"Sorry! An error ocurred."});t.hide()})}e.$inject=["$scope","$ionicLoading","$stateParams","buildingChannelsService"],angular.module("app.buildings").controller("buildingController",e)}(),function(){"use strict";function e(e,t,a,n){var i=a.getBuildings();e.selectedKey=n?n.key:null,e.select=function(t,a){e.selectedKey=a.key=t,n=a,e.$emit("building-selected",n)},t.show(),i.on("value",function(a){e.buildings=a.val(),t.hide()},function(e){console.log("error reading: "+e.code);$ionicPopup.alert({title:"Ops!",template:"Sorry! An error ocurred"});t.hide()})}e.$inject=["$scope","$ionicLoading","buildingsService","selectedBuilding"],angular.module("app.buildings").controller("buildingsController",e)}(),function(){"use strict";function e(e,t){return{getBuildings:function(){return firebase.database().ref("buildings")}}}e.$inject=["firebaseService","$rootScope"],angular.module("app.buildings").service("buildingsService",e)}(),function(){"use strict";function e(){var e={apiKey:"AIzaSyB5q81AGGox4i8-QL2KOtnDDfi05irgcHE",authDomain:"socialstrataideateam.firebaseapp.com",databaseURL:"https://socialstrataideateam.firebaseio.com",storageBucket:""};this.fb=firebase.initializeApp(e)}angular.module("app.firebase").service("firebaseService",e)}(),function(){"use strict";function e(e,t,a,n,i,r,o,s,u){function l(){e.messages=[{_id:"535d625f898df4e80e2a125e",text:"Ionic has changed the game for hybrid app development.",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-04-27T20:02:39.082Z",read:!0,readDate:"2014-12-01T06:27:37.944Z"},{_id:"535f13ffee3b2a68112b9fc0",text:"I like Ionic better than ice cream!",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-04-29T02:52:47.706Z",read:!0,readDate:"2014-12-01T06:27:37.944Z"},{_id:"546a5843fd4c5d581efa263a",text:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-11-17T20:19:15.289Z",read:!0,readDate:"2014-12-01T06:27:38.328Z"},{_id:"54764399ab43d1d4113abfd1",text:"Am I dreaming?",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-11-26T21:18:17.591Z",read:!0,readDate:"2014-12-01T06:27:38.337Z"},{_id:"547643aeab43d1d4113abfd2",text:"Is this magic?",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-11-26T21:18:38.549Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"},{_id:"547815dbab43d1d4113abfef",text:"Gee wiz, this is something special.",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-11-28T06:27:40.001Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"},{_id:"54781c69ab43d1d4113abff0",text:"I think I like Ionic more than I like ice cream!",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-11-28T06:55:37.350Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"},{_id:"54781ca4ab43d1d4113abff1",text:"Yea, it's pretty sweet",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-11-28T06:56:36.472Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"},{_id:"5478df86ab43d1d4113abff4",text:"Wow, this is really something huh?",userId:"534b8fb2aa5e7afc1b23e69c",date:"2014-11-28T20:48:06.572Z",read:!0,readDate:"2014-12-01T06:27:38.339Z"},{_id:"54781ca4ab43d1d4113abff1",text:"Create amazing apps - ionicframework.com",userId:"534b8e5aaa5e7afc1b23e69b",date:"2014-11-29T06:56:36.472Z",read:!0,readDate:"2014-12-01T06:27:38.338Z"}]}function c(){console.log("keepKeyboardOpen"),f.one("blur",function(){console.log("textarea blur, focus back on it"),f[0].focus()})}e.toUser={_id:"534b8e5aaa5e7afc1b23e69b",pic:"http://ionicframework.com/img/docs/venkman.jpg",channel:a.params.channelId},e.user={_id:"534b8fb2aa5e7afc1b23e69c",pic:"http://ionicframework.com/img/docs/mcfly.jpg",username:"Marty"},e.input={message:localStorage["userMessage-"+e.toUser._id]||""};var d,p,g,f,m=o.$getByHandle("userMessageScroll");e.$on("$ionicView.enter",function(){console.log("UserMessages $ionicView.enter"),l(),s(function(){p=document.body.querySelector("#userMessagesView .bar-footer"),g=document.body.querySelector("#userMessagesView .scroll-content"),f=angular.element(p.querySelector("textarea"))},0),d=u(function(){},2e4)}),e.$on("$ionicView.leave",function(){console.log("leaving UserMessages view, destroying interval"),angular.isDefined(d)&&(u.cancel(d),d=void 0)}),e.$on("$ionicView.beforeLeave",function(){e.input.message&&""!==e.input.message||localStorage.removeItem("userMessage-"+e.toUser._id)}),e.$watch("input.message",function(t,a){console.log("input.message $watch, newValue "+t),t||(t=""),localStorage["userMessage-"+e.toUser._id]=t}),e.sendMessage=function(t){var a={toId:e.toUser._id,text:e.input.message};c(),e.input.message="",a._id=(new Date).getTime(),a.date=new Date,a.username=e.user.username,a.userId=e.user._id,a.pic=e.user.picture,e.messages.push(a),s(function(){c(),m.scrollBottom(!0)},0),s(function(){e.messages.push(MockService.getMockMessage()),c(),m.scrollBottom(!0)},2e3)},e.onMessageHold=function(t,a,n){console.log("onMessageHold"),console.log("message: "+JSON.stringify(n,null,2)),i.show({buttons:[{text:"Copy Text"},{text:"Delete Message"}],buttonClicked:function(t){switch(t){case 0:break;case 1:e.messages.splice(a,1),s(function(){m.resize()},0)}return!0}})},e.viewProfile=function(t){t.userId===e.user._id},e.$on("taResize",function(e,t){if(console.log("taResize"),t){var a=t[0].offsetHeight;if(console.log("taHeight: "+a),p){var n=a+10;n=n>44?n:44,p.style.height=n+"px",g.style.bottom=n+"px"}}})}angular.module("app.messages").controller("messagesController",["$scope","$rootScope","$state","$stateParams","$ionicActionSheet","$ionicPopup","$ionicScrollDelegate","$timeout","$interval",e])}(),function(){"use strict";function e(e){return function(e){return e?e.replace(/\n\r?/g,"<br />"):e}}angular.module("app.messages").filter("nl2br",["$filter",e])}(),function(){"use strict";function e(e){var t={};return t.getMessagesRef=function(){return firebase.database().ref("messages")},t.addMessage=function(t){return e.fb.database().push(t)},t}e.$inject=["firebaseService"],angular.module("app.messages").service("messagesService",e)}(),function(){"use strict";function e(e,t,a,n,i){var r=n.user();e.data={displayName:r?r.displayName:"",email:r?r.email:""},e.update=function(){t.show(),i.updateProfile(e.data).then(function(e){t.hide(),a.alert({title:"ProfileUpdate!",template:e})},function n(n){t.hide(),a.alert({title:"Update failed!",template:n.message})})}}e.$inject=["$scope","$ionicLoading","$ionicPopup","authService","profilesService"],angular.module("app.profiles").controller("profileController",e)}(),function(){"use strict";function e(e,t,a,n){return{updateProfile:function(i){var r=e.defer();return a.user().updateProfile(i).then(function(){r.resolve("Profile updated!"),n=firebase.auth().currentUser,t.$broadcast("name-changed")},function o(o){r.reject(o)}),r.promise}}}e.$inject=["$q","$rootScope","authService","user"],angular.module("app.profiles").service("profilesService",e)}(),function(){"use strict";function e(e,t){e.building={name:"Select a building",address:""},e.$on("building-selected",function(t,a){e.building.name=a.name,e.building.address=a.address}),e.channel=function(e){t.go("app.channel",{channelId:e})}}e.$inject=["$scope","$state"],angular.module("app.sidemenu").controller("sidemenuController",e)}(),function(){"use strict";function e(e,t){return{updateProfile:function(a){var n=e.defer();return t.user().updateProfile(a).then(function(){n.resolve("Profile updated!"),user=firebase.auth().currentUser,$rootScope.$broadcast("name-changed")},function i(i){n.reject(i)}),n.promise}}}e.$inject=["$q","authService"],angular.module("app.users").service("usersService",e)}(),function(){"use strict";angular.module("app",["ionic","monospaced.elastic","app.firebase","app.auth","app.sidemenu","app.buildings","app.profiles","app.messages"]).value("user",null).value("selectedBuilding",null).value("user",null).run(["$ionicPlatform","$timeout","$rootScope",function(e,t,a){e.ready(function(){window.cordova&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault(),a.$broadcast("name-changed")})}])}(),function(){"use strict";angular.module("app").run(["$rootScope","$location","authService",function(e,t,a){e.$on("$routeChangeStart",function(e){null==a.user()&&(e.preventDefault(),t.go("login"))})}])}(),function(){"use strict";angular.module("app").config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("app",{url:"/app",cache:!1,"abstract":!0,templateUrl:"views/sidemenu.html"}).state("app.buildings",{url:"/buildings",views:{menuContent:{templateUrl:"views/buildings.html"}}}).state("app.building",{url:"/buildings/:buildingId",views:{menuContent:{templateUrl:"views/building.html"}}}).state("app.channel",{url:"/channel/:channelId",views:{menuContent:{templateUrl:"views/messages/chat.html"}}}).state("app.profile",{url:"/profile",cache:!1,views:{menuContent:{templateUrl:"views/profile/profile.html"}}}).state("app.logout",{url:"/login",templateProvider:["authService","$state",function(e,t){e.logout(),t.go("login")}]}).state("login",{url:"/login",templateUrl:"views/auth/login.html"}),t.otherwise("/login")}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgvYXV0aC5tb2R1bGUuanMiLCJidWlsZGluZ3MvYnVpbGRpbmdzLm1vZHVsZS5qcyIsImZpcmViYXNlL2ZpcmViYXNlLm1vZHVsZS5qcyIsIm1lc3NhZ2VzL21lc3NhZ2VzLm1vZHVsZS5qcyIsInByb2ZpbGUvcHJvZmlsZXMubW9kdWxlLmpzIiwic2lkZW1lbnUvc2lkZW1lbnUubW9kdWxlLmpzIiwidXNlcnMvdXNlcnMubW9kdWxlLmpzIiwiYXV0aC9hdXRoQ29udHJvbGxlci5qcyIsImFwcC5idW5kbGUuanMiLCJhdXRoL2F1dGhTZXJ2aWNlLmpzIiwiYnVpbGRpbmdzL2J1aWxkaW5nQ2hhbm5lbHNTZXJ2aWNlLmpzIiwiYnVpbGRpbmdzL2J1aWxkaW5nQ29udHJvbGxlci5qcyIsImJ1aWxkaW5ncy9idWlsZGluZ3NDb250cm9sbGVyLmpzIiwiYnVpbGRpbmdzL2J1aWxkaW5nc1NlcnZpY2UuanMiLCJmaXJlYmFzZS9maXJlYmFzZVNlcnZpY2UuanMiLCJtZXNzYWdlcy9tZXNzYWdlc0NvbnRyb2xsZXIuanMiLCJtZXNzYWdlcy9tZXNzYWdlc0ZpbHRlcnMuanMiLCJtZXNzYWdlcy9tZXNzYWdlc1NlcnZpY2UuanMiLCJwcm9maWxlL3Byb2ZpbGVDb250cm9sbGVyLmpzIiwicHJvZmlsZS9wcm9maWxlc1NlcnZpY2UuanMiLCJzaWRlbWVudS9zaWRlbWVudUNvbnRyb2xsZXIuanMiLCJ1c2Vycy91c2Vyc1NlcnZpY2UuanMiLCJhcHAubW9kdWxlLmpzIiwiYXBwLnJvdXRlci5maWx0ZXIuanMiLCJhcHAucm91dGVyLmpzIl0sIm5hbWVzIjpbImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25zdGFudCIsImFwcGVuZCIsImRpcmVjdGl2ZSIsIiR0aW1lb3V0IiwiJHdpbmRvdyIsImNvbmZpZyIsInJlcXVpcmUiLCJyZXN0cmljdCIsImxpbmsiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRycyIsIm5nTW9kZWwiLCJpbml0TWlycm9yIiwibWlycm9yU3R5bGUiLCJtaXJyb3JJbml0U3R5bGUiLCJtaXJyb3JlZCIsInRhIiwidGFTdHlsZSIsImdldENvbXB1dGVkU3R5bGUiLCJmb3JFYWNoIiwiY29weVN0eWxlIiwidmFsIiwiZ2V0UHJvcGVydHlWYWx1ZSIsIm1pcnJvciIsInNldEF0dHJpYnV0ZSIsImFkanVzdCIsInRhSGVpZ2h0IiwidGFDb21wdXRlZFN0eWxlV2lkdGgiLCJtaXJyb3JIZWlnaHQiLCJ3aWR0aCIsIm92ZXJmbG93IiwiYWN0aXZlIiwidmFsdWUiLCJzdHlsZSIsIm92ZXJmbG93WSIsImhlaWdodCIsInBhcnNlSW50Iiwic3Vic3RyIiwibGVuZ3RoIiwiYm94T3V0ZXIiLCJzY3JvbGxIZWlnaHQiLCJtYXhIZWlnaHQiLCJtaW5IZWlnaHQiLCIkZW1pdCIsIiR0YSIsImZvcmNlQWRqdXN0Iiwibm9kZU5hbWUiLCJjc3MiLCJvdmVyZmxvdy15Iiwid29yZC13cmFwIiwidGV4dCIsIm1zZEVsYXN0aWMiLCJyZXBsYWNlIiwiJHdpbiIsIiRtaXJyb3IiLCJkYXRhIiwicmVzaXplIiwiYm9yZGVyQm94IiwibWluSGVpZ2h0VmFsdWUiLCJoZWlnaHRWYWx1ZSIsIk1hdGgiLCJtYXgiLCJwYXJlbnROb2RlIiwiZG9jdW1lbnQiLCJib2R5Iiwib25rZXl1cCIsImJpbmQiLCIkd2F0Y2giLCIkbW9kZWxWYWx1ZSIsIm5ld1ZhbHVlIiwiJG9uIiwicmVtb3ZlIiwidW5iaW5kIiwiYXV0aENvbnRyb2xsZXIiLCIkc2NvcGUiLCJhdXRoU2VydmljZSIsIiRpb25pY1BvcHVwIiwiJGlvbmljTG9hZGluZyIsIiRzdGF0ZSIsImxvZ2luIiwic2hvdyIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJzdWNjZXNzIiwidXNlciIsImhpZGUiLCJnbyIsImVycm9yIiwiYWxlcnQiLCJ0aXRsZSIsInRlbXBsYXRlIiwibWVzc2FnZSIsImZhY2Vib29rTG9naW4iLCIkaW5qZWN0IiwiY29udHJvbGxlciIsIiRxIiwiJHJvb3RTY29wZSIsImJ1aWxkaW5nc1NlcnZpY2UiLCJzZWxlY3RlZEJ1aWxkaW5nIiwiYXV0aCIsImZpcmViYXNlIiwidXNyIiwiY3VycmVudFVzZXIiLCJkYXRhYmFzZSIsInJlZiIsInVpZCIsInNldCIsIm5hbWUiLCJkaXNwbGF5TmFtZSIsImVtYWlsIiwibGFzdEFjdGl2aXR5IiwiRGF0ZSIsImdldFRpbWUiLCJkZWZlcnJlZCIsImRlZmVyIiwicHJvbWlzZSIsInN1Y2Nlc3NIYW5kbGVyIiwiaW5mbyIsImlzTmV3IiwicmVzb2x2ZSIsImVycm9ySGFuZGxlciIsInJlamVjdCIsInNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkIiwidGhlbiIsImNvZGUiLCJjcmVhdGVVc2VyV2l0aEVtYWlsQW5kUGFzc3dvcmQiLCJmbiIsImxvZ291dCIsInNpZ25PdXQiLCJzZXJ2aWNlIiwiYnVpbGRpbmdDaGFubmVsc1NlcnZpY2UiLCJmaXJlYmFzZVNlcnZpY2UiLCJnZXRDaGFubmVsc0Zyb20iLCJidWlsZGluZyIsImZiIiwiYnVpbGRpbmdDb250cm9sbGVyIiwiJHN0YXRlUGFyYW1zIiwiYnVpbGRpbmdJZCIsIm9uIiwic25hcHNob3QiLCJjaGFubmVscyIsImV4dGVuZCIsImNvbW1vbiIsInNlcnZpY2VzIiwiZXJyb3JPYmplY3QiLCJjb25zb2xlIiwibG9nIiwiYnVpbGRpbmdzQ29udHJvbGxlciIsImdldEJ1aWxkaW5ncyIsInNlbGVjdGVkS2V5Iiwia2V5Iiwic2VsZWN0IiwiYnVpbGRpbmdzIiwiYXBpS2V5IiwiYXV0aERvbWFpbiIsImRhdGFiYXNlVVJMIiwic3RvcmFnZUJ1Y2tldCIsInRoaXMiLCJpbml0aWFsaXplQXBwIiwibWVzc2FnZXNDb250cm9sbGVyIiwiJGlvbmljQWN0aW9uU2hlZXQiLCIkaW9uaWNTY3JvbGxEZWxlZ2F0ZSIsIiRpbnRlcnZhbCIsImdldE1lc3NhZ2VzIiwibWVzc2FnZXMiLCJfaWQiLCJ1c2VySWQiLCJkYXRlIiwicmVhZCIsInJlYWREYXRlIiwia2VlcEtleWJvYXJkT3BlbiIsInR4dElucHV0Iiwib25lIiwiZm9jdXMiLCJ0b1VzZXIiLCJwaWMiLCJjaGFubmVsIiwicGFyYW1zIiwiY2hhbm5lbElkIiwiaW5wdXQiLCJsb2NhbFN0b3JhZ2UiLCJtZXNzYWdlQ2hlY2tUaW1lciIsImZvb3RlckJhciIsInNjcm9sbGVyIiwidmlld1Njcm9sbCIsIiRnZXRCeUhhbmRsZSIsInF1ZXJ5U2VsZWN0b3IiLCJpc0RlZmluZWQiLCJjYW5jZWwiLCJ1bmRlZmluZWQiLCJyZW1vdmVJdGVtIiwib2xkVmFsdWUiLCJzZW5kTWVzc2FnZSIsInNlbmRNZXNzYWdlRm9ybSIsInRvSWQiLCJwaWN0dXJlIiwicHVzaCIsInNjcm9sbEJvdHRvbSIsIk1vY2tTZXJ2aWNlIiwiZ2V0TW9ja01lc3NhZ2UiLCJvbk1lc3NhZ2VIb2xkIiwiZSIsIml0ZW1JbmRleCIsIkpTT04iLCJzdHJpbmdpZnkiLCJidXR0b25zIiwiYnV0dG9uQ2xpY2tlZCIsImluZGV4Iiwic3BsaWNlIiwidmlld1Byb2ZpbGUiLCJtc2ciLCJvZmZzZXRIZWlnaHQiLCJuZXdGb290ZXJIZWlnaHQiLCJib3R0b20iLCJubDJiciIsIiRmaWx0ZXIiLCJmaWx0ZXIiLCJtZXNzYWdlc1NlcnZpY2UiLCJnZXRNZXNzYWdlc1JlZiIsImFkZE1lc3NhZ2UiLCJwcm9maWxlQ29udHJvbGxlciIsInByb2ZpbGVzU2VydmljZSIsInVwZGF0ZSIsInVwZGF0ZVByb2ZpbGUiLCIkYnJvYWRjYXN0Iiwic2lkZW1lbnVDb250cm9sbGVyIiwiYWRkcmVzcyIsImV2ZW50IiwiY2hhbm5lbEtleSIsInVzZXJzU2VydmljZSIsInJ1biIsIiRpb25pY1BsYXRmb3JtIiwicmVhZHkiLCJ3aW5kb3ciLCJjb3Jkb3ZhIiwicGx1Z2lucyIsIktleWJvYXJkIiwiaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyIiwiZGlzYWJsZVNjcm9sbCIsIlN0YXR1c0JhciIsInN0eWxlRGVmYXVsdCIsInByZXZlbnREZWZhdWx0IiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJzdGF0ZSIsInVybCIsImNhY2hlIiwiYWJzdHJhY3QiLCJ0ZW1wbGF0ZVVybCIsInZpZXdzIiwibWVudUNvbnRlbnQiLCJ0ZW1wbGF0ZVByb3ZpZGVyIiwib3RoZXJ3aXNlIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBLFlBRUFBLFNBQUFDLE9BQUEsa0JDSEEsV0FDQSxZQUVBRCxTQUFBQyxPQUFBLGlCQUFBLG9CQ0hBLFdBQ0EsWUFFQUQsU0FDQUMsT0FBQSxzQkNKQSxXQUNBLFlBRUFELFNBQ0FDLE9BQUEseUJBQ0FDLFNBQUEsb0JBQ0FDLE9BQUEsS0FFQUMsVUFBQSxjQUNBLFdBQUEsVUFBQSxtQkFDQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUdBLE9BQ0FDLFFBQUEsVUFDQUMsU0FBQSxPQUNBQyxLQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBc0ZBLFFBQUFDLEtBQ0EsR0FBQUMsR0FBQUMsQ0FFQUMsR0FBQUMsRUFFQUMsRUFBQUMsaUJBQUFGLEdBQ0FuQixRQUFBc0IsUUFBQUMsRUFBQSxTQUFBQyxHQUNBUixHQUFBUSxFQUFBLElBQUFKLEVBQUFLLGlCQUFBRCxHQUFBLE1BRUFFLEVBQUFDLGFBQUEsUUFBQVgsR0FHQSxRQUFBWSxLQUNBLEdBQUFDLEdBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLENBRUFmLEtBQUFDLEdBQ0FKLElBSUFtQixJQUNBQSxHQUFBLEVBRUFSLEVBQUFTLE1BQUFoQixFQUFBZ0IsTUFBQWhDLEVBQ0F1QixFQUFBVSxNQUFBQyxVQUFBbEIsRUFBQWlCLE1BQUFDLFVBRUFSLEVBQUEsS0FBQVYsRUFBQWlCLE1BQUFFLE9BQUEsT0FBQUMsU0FBQXBCLEVBQUFpQixNQUFBRSxPQUFBLElBRUFSLEVBQUFULGlCQUFBRixHQUFBTSxpQkFBQSxTQUdBLE9BQUFLLEVBQUFVLE9BQUFWLEVBQUFXLE9BQUEsRUFBQSxLQUVBVCxFQUFBTyxTQUFBVCxFQUFBLElBQUFZLEVBQUFWLE1BQ0FOLEVBQUFVLE1BQUFKLE1BQUFBLEVBQUEsTUFHQUQsRUFBQUwsRUFBQWlCLGFBRUFaLEVBQUFhLEdBQ0FiLEVB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U0FDQWpELEVBQUFRLEdBQUEsYUFHQThKLE1BQUEsU0FDQUMsSUFBQSxTQUNBRyxZQUFBLDBCQUtBTCxFQUFBUyxVQUFBIiwiZmlsZSI6ImFwcC5idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLmF1dGhcIiwgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLmJ1aWxkaW5nc1wiLCBbJ2FwcC5maXJlYmFzZSddKTtcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmZpcmViYXNlJywgW10pO1xufSkoKTtcblxuXG5cblxuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ21vbm9zcGFjZWQuZWxhc3RpYycsIFtdKVxuICAgICAgICAuY29uc3RhbnQoJ21zZEVsYXN0aWNDb25maWcnLCB7XG4gICAgICAgICAgICBhcHBlbmQ6ICcnXG4gICAgICAgIH0pXG4gICAgICAgIC5kaXJlY3RpdmUoJ21zZEVsYXN0aWMnLCBbXG4gICAgICAgICAgICAnJHRpbWVvdXQnLCAnJHdpbmRvdycsICdtc2RFbGFzdGljQ29uZmlnJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uICgkdGltZW91dCwgJHdpbmRvdywgY29uZmlnKSB7XG4gICAgICAgICAgICAgICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxuICAgICAgICAgICAgICAgICAgICByZXN0cmljdDogJ0EsIEMnLFxuICAgICAgICAgICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBuZ01vZGVsKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNhY2hlIGEgcmVmZXJlbmNlIHRvIHRoZSBET00gZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhID0gZWxlbWVudFswXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGEgPSBlbGVtZW50O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBlbnN1cmUgdGhlIGVsZW1lbnQgaXMgYSB0ZXh0YXJlYSwgYW5kIGJyb3dzZXIgaXMgY2FwYWJsZVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhLm5vZGVOYW1lICE9PSAnVEVYVEFSRUEnIHx8ICEkd2luZG93LmdldENvbXB1dGVkU3R5bGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCB0aGVzZSBwcm9wZXJ0aWVzIGJlZm9yZSBtZWFzdXJpbmcgZGltZW5zaW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRhLmNzcyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ292ZXJmbG93JzogJ2hpZGRlbicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ292ZXJmbG93LXknOiAnaGlkZGVuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnd29yZC13cmFwJzogJ2JyZWFrLXdvcmQnXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9yY2UgdGV4dCByZWZsb3dcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZXh0ID0gdGEudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YS52YWx1ZSA9ICcnO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGEudmFsdWUgPSB0ZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXBwZW5kID0gYXR0cnMubXNkRWxhc3RpYyA/IGF0dHJzLm1zZEVsYXN0aWMucmVwbGFjZSgvXFxcXG4vZywgJ1xcbicpIDogY29uZmlnLmFwcGVuZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkd2luID0gYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvckluaXRTdHlsZSA9ICdwb3NpdGlvbjogYWJzb2x1dGU7IHRvcDogLTk5OXB4OyByaWdodDogYXV0bzsgYm90dG9tOiBhdXRvOycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGVmdDogMDsgb3ZlcmZsb3c6IGhpZGRlbjsgLXdlYmtpdC1ib3gtc2l6aW5nOiBjb250ZW50LWJveDsnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJy1tb3otYm94LXNpemluZzogY29udGVudC1ib3g7IGJveC1zaXppbmc6IGNvbnRlbnQtYm94OycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbWluLWhlaWdodDogMCAhaW1wb3J0YW50OyBoZWlnaHQ6IDAgIWltcG9ydGFudDsgcGFkZGluZzogMDsnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dvcmQtd3JhcDogYnJlYWstd29yZDsgYm9yZGVyOiAwOycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1pcnJvciA9IGFuZ3VsYXIuZWxlbWVudCgnPHRleHRhcmVhIGFyaWEtaGlkZGVuPVwidHJ1ZVwiIHRhYmluZGV4PVwiLTFcIiAnICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3N0eWxlPVwiJyArIG1pcnJvckluaXRTdHlsZSArICdcIi8+JykuZGF0YSgnZWxhc3RpYycsIHRydWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvciA9ICRtaXJyb3JbMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUodGEpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZSA9IHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncmVzaXplJyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyQm94ID0gdGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3gtc2l6aW5nJykgPT09ICdib3JkZXItYm94JyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy1tb3otYm94LXNpemluZycpID09PSAnYm9yZGVyLWJveCcgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCctd2Via2l0LWJveC1zaXppbmcnKSA9PT0gJ2JvcmRlci1ib3gnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJveE91dGVyID0gIWJvcmRlckJveCA/IHt3aWR0aDogMCwgaGVpZ2h0OiAwfSA6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLXJpZ2h0LXdpZHRoJyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1yaWdodCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctbGVmdCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2JvcmRlci1sZWZ0LXdpZHRoJyksIDEwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2JvcmRlci10b3Atd2lkdGgnKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdwYWRkaW5nLXRvcCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctYm90dG9tJyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLWJvdHRvbS13aWR0aCcpLCAxMClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbkhlaWdodFZhbHVlID0gcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdtaW4taGVpZ2h0JyksIDEwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHRWYWx1ZSA9IHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnaGVpZ2h0JyksIDEwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaW5IZWlnaHQgPSBNYXRoLm1heChtaW5IZWlnaHRWYWx1ZSwgaGVpZ2h0VmFsdWUpIC0gYm94T3V0ZXIuaGVpZ2h0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1heEhlaWdodCA9IHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnbWF4LWhlaWdodCcpLCAxMCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yZWQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvcHlTdHlsZSA9IFsnZm9udC1mYW1pbHknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZm9udC1zaXplJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ZvbnQtd2VpZ2h0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ZvbnQtc3R5bGUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGV0dGVyLXNwYWNpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbGluZS1oZWlnaHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGV4dC10cmFuc2Zvcm0nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnd29yZC1zcGFjaW5nJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RleHQtaW5kZW50J107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGV4aXQgaWYgZWxhc3RpYyBhbHJlYWR5IGFwcGxpZWQgKG9yIGlzIHRoZSBtaXJyb3IgZWxlbWVudClcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkdGEuZGF0YSgnZWxhc3RpYycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBPcGVyYSByZXR1cm5zIG1heC1oZWlnaHQgb2YgLTEgaWYgbm90IHNldFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gbWF4SGVpZ2h0ICYmIG1heEhlaWdodCA+IDAgPyBtYXhIZWlnaHQgOiA5ZTQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFwcGVuZCBtaXJyb3IgdG8gdGhlIERPTVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1pcnJvci5wYXJlbnROb2RlICE9PSBkb2N1bWVudC5ib2R5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpLmFwcGVuZChtaXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgcmVzaXplIGFuZCBhcHBseSBlbGFzdGljXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGEuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAncmVzaXplJzogKHJlc2l6ZSA9PT0gJ25vbmUnIHx8IHJlc2l6ZSA9PT0gJ3ZlcnRpY2FsJykgPyAnbm9uZScgOiAnaG9yaXpvbnRhbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLmRhdGEoJ2VsYXN0aWMnLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIG1ldGhvZHNcbiAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBpbml0TWlycm9yKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtaXJyb3JTdHlsZSA9IG1pcnJvckluaXRTdHlsZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvcmVkID0gdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29weSB0aGUgZXNzZW50aWFsIHN0eWxlcyBmcm9tIHRoZSB0ZXh0YXJlYSB0byB0aGUgbWlycm9yXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUodGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChjb3B5U3R5bGUsIGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yU3R5bGUgKz0gdmFsICsgJzonICsgdGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKHZhbCkgKyAnOyc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCBtaXJyb3JTdHlsZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGFkanVzdCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhQ29tcHV0ZWRTdHlsZVdpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaXJyb3JlZCAhPT0gdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdE1pcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFjdGl2ZSBmbGFnIHByZXZlbnRzIGFjdGlvbnMgaW4gZnVuY3Rpb24gZnJvbSBjYWxsaW5nIGFkanVzdCBhZ2FpblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yLnZhbHVlID0gdGEudmFsdWUgKyBhcHBlbmQ7IC8vIG9wdGlvbmFsIHdoaXRlc3BhY2UgdG8gaW1wcm92ZSBhbmltYXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yLnN0eWxlLm92ZXJmbG93WSA9IHRhLnN0eWxlLm92ZXJmbG93WTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YUhlaWdodCA9IHRhLnN0eWxlLmhlaWdodCA9PT0gJycgPyAnYXV0bycgOiBwYXJzZUludCh0YS5zdHlsZS5oZWlnaHQsIDEwKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YUNvbXB1dGVkU3R5bGVXaWR0aCA9IGdldENvbXB1dGVkU3R5bGUodGEpLmdldFByb3BlcnR5VmFsdWUoJ3dpZHRoJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW5zdXJlIGdldENvbXB1dGVkU3R5bGUgaGFzIHJldHVybmVkIGEgcmVhZGFibGUgJ3VzZWQgdmFsdWUnIHBpeGVsIHdpZHRoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YUNvbXB1dGVkU3R5bGVXaWR0aC5zdWJzdHIodGFDb21wdXRlZFN0eWxlV2lkdGgubGVuZ3RoIC0gMiwgMikgPT09ICdweCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVwZGF0ZSBtaXJyb3Igd2lkdGggaW4gY2FzZSB0aGUgdGV4dGFyZWEgd2lkdGggaGFzIGNoYW5nZWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpZHRoID0gcGFyc2VJbnQodGFDb21wdXRlZFN0eWxlV2lkdGgsIDEwKSAtIGJveE91dGVyLndpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yLnN0eWxlLndpZHRoID0gd2lkdGggKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9ySGVpZ2h0ID0gbWlycm9yLnNjcm9sbEhlaWdodDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobWlycm9ySGVpZ2h0ID4gbWF4SGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQgPSBtYXhIZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdmVyZmxvdyA9ICdzY3JvbGwnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1pcnJvckhlaWdodCA8IG1pbkhlaWdodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9ySGVpZ2h0ID0gbWluSGVpZ2h0O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvckhlaWdodCArPSBib3hPdXRlci5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhLnN0eWxlLm92ZXJmbG93WSA9IG92ZXJmbG93IHx8ICdoaWRkZW4nO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0YUhlaWdodCAhPT0gbWlycm9ySGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kZW1pdCgnZWxhc3RpYzpyZXNpemUnLCAkdGEsIHRhSGVpZ2h0LCBtaXJyb3JIZWlnaHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGEuc3R5bGUuaGVpZ2h0ID0gbWlycm9ySGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNtYWxsIGRlbGF5IHRvIHByZXZlbnQgYW4gaW5maW5pdGUgbG9vcFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMSwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBmb3JjZUFkanVzdCgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZGp1c3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLypcbiAgICAgICAgICAgICAgICAgICAgICAgICAqIGluaXRpYWxpc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBsaXN0ZW5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgnb25wcm9wZXJ0eWNoYW5nZScgaW4gdGEgJiYgJ29uaW5wdXQnIGluIHRhKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSUU5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFbJ29uaW5wdXQnXSA9IHRhLm9ua2V5dXAgPSBhZGp1c3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhWydvbmlucHV0J10gPSBhZGp1c3Q7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICR3aW4uYmluZCgncmVzaXplJywgZm9yY2VBZGp1c3QpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBuZ01vZGVsLiRtb2RlbFZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yY2VBZGp1c3QoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kb24oJ2VsYXN0aWM6YWRqdXN0JywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluaXRNaXJyb3IoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JjZUFkanVzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGFkanVzdCwgMCwgZmFsc2UpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICogZGVzdHJveVxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJG1pcnJvci5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkd2luLnVuYmluZCgncmVzaXplJywgZm9yY2VBZGp1c3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICBdKTtcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLm1lc3NhZ2VzJywgWydtb25vc3BhY2VkLmVsYXN0aWMnXSk7XG59KSgpO1xuXG5cblxuXG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLnByb2ZpbGVzXCIsIFsnYXBwLmF1dGgnXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuc2lkZW1lbnVcIiwgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLnVzZXJzXCIsIFsnYXBwLmF1dGgnXSk7XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5hdXRoXCIpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoXCJhdXRoQ29udHJvbGxlclwiLCBhdXRoQ29udHJvbGxlcik7XG5cblxuICAgIGZ1bmN0aW9uIGF1dGhDb250cm9sbGVyKCRzY29wZSwgYXV0aFNlcnZpY2UsICRpb25pY1BvcHVwLCAkaW9uaWNMb2FkaW5nLCAkc3RhdGUsICR0aW1lb3V0KSB7XG5cbiAgICAgICAgJHNjb3BlLmRhdGEgPSB7fTtcblxuICAgICAgICAkc2NvcGUubG9naW4gPSBmdW5jdGlvbigpIHtcblx0XHRcdCRpb25pY0xvYWRpbmcuc2hvdygpO1xuXG5cdFx0XHRhdXRoU2VydmljZS5sb2dpbigkc2NvcGUuZGF0YS51c2VybmFtZSwgJHNjb3BlLmRhdGEucGFzc3dvcmQpLnN1Y2Nlc3MoZnVuY3Rpb24odXNlcikge1xuXHRcdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblx0XHRcdFx0JHN0YXRlLmdvKCdhcHAuYnVpbGRpbmdzJyk7XG5cbiAgICAgICAgICAgIH0pLmVycm9yKGZ1bmN0aW9uKGVycm9yKSB7XG5cdFx0XHRcdCR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXHRcdFx0XHR9LCAxMDApO1xuXG4gICAgICAgICAgICAgICAgdmFyIGFsZXJ0UG9wdXAgPSAkaW9uaWNQb3B1cC5hbGVydCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnTG9naW4gZmFpbGVkIScsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBlcnJvci5tZXNzYWdlIC8vJ1BsZWFzZSBjaGVjayB5b3VyIGNyZWRlbnRpYWxzISdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cblx0XHQkc2NvcGUuZmFjZWJvb2tMb2dpbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dmFyIGFsZXJ0UG9wdXAgPSAkaW9uaWNQb3B1cC5hbGVydCh7XG5cdFx0XHRcdHRpdGxlOiAnRmFjZWJvb2sgbG9naW4nLFxuXHRcdFx0XHR0ZW1wbGF0ZTogJ1BsYW5uZWQhJ1xuXHRcdFx0fSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYXV0aFwiLCBbXSk7XG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5idWlsZGluZ3NcIiwgWydhcHAuZmlyZWJhc2UnXSk7XG59KSgpO1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmZpcmViYXNlJywgW10pO1xufSkoKTtcblxuXG5cblxuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbW9ub3NwYWNlZC5lbGFzdGljJywgW10pXG4gICAgICAgIC5jb25zdGFudCgnbXNkRWxhc3RpY0NvbmZpZycsIHtcbiAgICAgICAgICAgIGFwcGVuZDogJydcbiAgICAgICAgfSlcbiAgICAgICAgLmRpcmVjdGl2ZSgnbXNkRWxhc3RpYycsIFtcbiAgICAgICAgICAgICckdGltZW91dCcsICckd2luZG93JywgJ21zZEVsYXN0aWNDb25maWcnLFxuICAgICAgICAgICAgZnVuY3Rpb24gKCR0aW1lb3V0LCAkd2luZG93LCBjb25maWcpIHtcbiAgICAgICAgICAgICAgICAndXNlIHN0cmljdCc7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXG4gICAgICAgICAgICAgICAgICAgIHJlc3RyaWN0OiAnQSwgQycsXG4gICAgICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIG5nTW9kZWwpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2FjaGUgYSByZWZlcmVuY2UgdG8gdGhlIERPTSBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGEgPSBlbGVtZW50WzBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0YSA9IGVsZW1lbnQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVuc3VyZSB0aGUgZWxlbWVudCBpcyBhIHRleHRhcmVhLCBhbmQgYnJvd3NlciBpcyBjYXBhYmxlXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGEubm9kZU5hbWUgIT09ICdURVhUQVJFQScgfHwgISR3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHRoZXNlIHByb3BlcnRpZXMgYmVmb3JlIG1lYXN1cmluZyBkaW1lbnNpb25zXG4gICAgICAgICAgICAgICAgICAgICAgICAkdGEuY3NzKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cnOiAnaGlkZGVuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cteSc6ICdoaWRkZW4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3b3JkLXdyYXAnOiAnYnJlYWstd29yZCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBmb3JjZSB0ZXh0IHJlZmxvd1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRleHQgPSB0YS52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhLnZhbHVlID0gJyc7XG4gICAgICAgICAgICAgICAgICAgICAgICB0YS52YWx1ZSA9IHRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcHBlbmQgPSBhdHRycy5tc2RFbGFzdGljID8gYXR0cnMubXNkRWxhc3RpYy5yZXBsYWNlKC9cXFxcbi9nLCAnXFxuJykgOiBjb25maWcuYXBwZW5kLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3aW4gPSBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9ySW5pdFN0eWxlID0gJ3Bvc2l0aW9uOiBhYnNvbHV0ZTsgdG9wOiAtOTk5cHg7IHJpZ2h0OiBhdXRvOyBib3R0b206IGF1dG87JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsZWZ0OiAwOyBvdmVyZmxvdzogaGlkZGVuOyAtd2Via2l0LWJveC1zaXppbmc6IGNvbnRlbnQtYm94OycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnLW1vei1ib3gtc2l6aW5nOiBjb250ZW50LWJveDsgYm94LXNpemluZzogY29udGVudC1ib3g7JyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtaW4taGVpZ2h0OiAwICFpbXBvcnRhbnQ7IGhlaWdodDogMCAhaW1wb3J0YW50OyBwYWRkaW5nOiAwOycgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnd29yZC13cmFwOiBicmVhay13b3JkOyBib3JkZXI6IDA7JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWlycm9yID0gYW5ndWxhci5lbGVtZW50KCc8dGV4dGFyZWEgYXJpYS1oaWRkZW49XCJ0cnVlXCIgdGFiaW5kZXg9XCItMVwiICcgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc3R5bGU9XCInICsgbWlycm9ySW5pdFN0eWxlICsgJ1wiLz4nKS5kYXRhKCdlbGFzdGljJywgdHJ1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yID0gJG1pcnJvclswXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSh0YSksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplID0gdGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdyZXNpemUnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBib3JkZXJCb3ggPSB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ2JveC1zaXppbmcnKSA9PT0gJ2JvcmRlci1ib3gnIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnLW1vei1ib3gtc2l6aW5nJykgPT09ICdib3JkZXItYm94JyB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJy13ZWJraXQtYm94LXNpemluZycpID09PSAnYm9yZGVyLWJveCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYm94T3V0ZXIgPSAhYm9yZGVyQm94ID8ge3dpZHRoOiAwLCBoZWlnaHQ6IDB9IDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItcmlnaHQtd2lkdGgnKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdwYWRkaW5nLXJpZ2h0JyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1sZWZ0JyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLWxlZnQtd2lkdGgnKSwgMTApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgnYm9yZGVyLXRvcC13aWR0aCcpLCAxMCkgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ3BhZGRpbmctdG9wJyksIDEwKSArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlSW50KHRhU3R5bGUuZ2V0UHJvcGVydHlWYWx1ZSgncGFkZGluZy1ib3R0b20nKSwgMTApICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdib3JkZXItYm90dG9tLXdpZHRoJyksIDEwKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWluSGVpZ2h0VmFsdWUgPSBwYXJzZUludCh0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUoJ21pbi1oZWlnaHQnKSwgMTApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodFZhbHVlID0gcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdoZWlnaHQnKSwgMTApLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pbkhlaWdodCA9IE1hdGgubWF4KG1pbkhlaWdodFZhbHVlLCBoZWlnaHRWYWx1ZSkgLSBib3hPdXRlci5oZWlnaHQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4SGVpZ2h0ID0gcGFyc2VJbnQodGFTdHlsZS5nZXRQcm9wZXJ0eVZhbHVlKCdtYXgtaGVpZ2h0JyksIDEwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JlZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29weVN0eWxlID0gWydmb250LWZhbWlseScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmb250LXNpemUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZm9udC13ZWlnaHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZm9udC1zdHlsZScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsZXR0ZXItc3BhY2luZycsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdsaW5lLWhlaWdodCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd0ZXh0LXRyYW5zZm9ybScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICd3b3JkLXNwYWNpbmcnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGV4dC1pbmRlbnQnXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXhpdCBpZiBlbGFzdGljIGFscmVhZHkgYXBwbGllZCAob3IgaXMgdGhlIG1pcnJvciBlbGVtZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCR0YS5kYXRhKCdlbGFzdGljJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE9wZXJhIHJldHVybnMgbWF4LWhlaWdodCBvZiAtMSBpZiBub3Qgc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBtYXhIZWlnaHQgPSBtYXhIZWlnaHQgJiYgbWF4SGVpZ2h0ID4gMCA/IG1heEhlaWdodCA6IDllNDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gYXBwZW5kIG1pcnJvciB0byB0aGUgRE9NXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWlycm9yLnBhcmVudE5vZGUgIT09IGRvY3VtZW50LmJvZHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkuYXBwZW5kKG1pcnJvcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCByZXNpemUgYW5kIGFwcGx5IGVsYXN0aWNcbiAgICAgICAgICAgICAgICAgICAgICAgICR0YS5jc3Moe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdyZXNpemUnOiAocmVzaXplID09PSAnbm9uZScgfHwgcmVzaXplID09PSAndmVydGljYWwnKSA/ICdub25lJyA6ICdob3Jpem9udGFsJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkuZGF0YSgnZWxhc3RpYycsIHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICogbWV0aG9kc1xuICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGluaXRNaXJyb3IoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1pcnJvclN0eWxlID0gbWlycm9ySW5pdFN0eWxlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9yZWQgPSB0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjb3B5IHRoZSBlc3NlbnRpYWwgc3R5bGVzIGZyb20gdGhlIHRleHRhcmVhIHRvIHRoZSBtaXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZSh0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGNvcHlTdHlsZSwgZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JTdHlsZSArPSB2YWwgKyAnOicgKyB0YVN0eWxlLmdldFByb3BlcnR5VmFsdWUodmFsKSArICc7JztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3Iuc2V0QXR0cmlidXRlKCdzdHlsZScsIG1pcnJvclN0eWxlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gYWRqdXN0KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YUhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFDb21wdXRlZFN0eWxlV2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvckhlaWdodCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGgsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1pcnJvcmVkICE9PSB0YSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbml0TWlycm9yKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWN0aXZlIGZsYWcgcHJldmVudHMgYWN0aW9ucyBpbiBmdW5jdGlvbiBmcm9tIGNhbGxpbmcgYWRqdXN0IGFnYWluXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFhY3RpdmUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3IudmFsdWUgPSB0YS52YWx1ZSArIGFwcGVuZDsgLy8gb3B0aW9uYWwgd2hpdGVzcGFjZSB0byBpbXByb3ZlIGFuaW1hdGlvblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3Iuc3R5bGUub3ZlcmZsb3dZID0gdGEuc3R5bGUub3ZlcmZsb3dZO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhSGVpZ2h0ID0gdGEuc3R5bGUuaGVpZ2h0ID09PSAnJyA/ICdhdXRvJyA6IHBhcnNlSW50KHRhLnN0eWxlLmhlaWdodCwgMTApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhQ29tcHV0ZWRTdHlsZVdpZHRoID0gZ2V0Q29tcHV0ZWRTdHlsZSh0YSkuZ2V0UHJvcGVydHlWYWx1ZSgnd2lkdGgnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbnN1cmUgZ2V0Q29tcHV0ZWRTdHlsZSBoYXMgcmV0dXJuZWQgYSByZWFkYWJsZSAndXNlZCB2YWx1ZScgcGl4ZWwgd2lkdGhcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhQ29tcHV0ZWRTdHlsZVdpZHRoLnN1YnN0cih0YUNvbXB1dGVkU3R5bGVXaWR0aC5sZW5ndGggLSAyLCAyKSA9PT0gJ3B4Jykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlIG1pcnJvciB3aWR0aCBpbiBjYXNlIHRoZSB0ZXh0YXJlYSB3aWR0aCBoYXMgY2hhbmdlZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGggPSBwYXJzZUludCh0YUNvbXB1dGVkU3R5bGVXaWR0aCwgMTApIC0gYm94T3V0ZXIud2lkdGg7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3Iuc3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQgPSBtaXJyb3Iuc2Nyb2xsSGVpZ2h0O1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaXJyb3JIZWlnaHQgPiBtYXhIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pcnJvckhlaWdodCA9IG1heEhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG92ZXJmbG93ID0gJ3Njcm9sbCc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWlycm9ySGVpZ2h0IDwgbWluSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaXJyb3JIZWlnaHQgPSBtaW5IZWlnaHQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWlycm9ySGVpZ2h0ICs9IGJveE91dGVyLmhlaWdodDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGEuc3R5bGUub3ZlcmZsb3dZID0gb3ZlcmZsb3cgfHwgJ2hpZGRlbic7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRhSGVpZ2h0ICE9PSBtaXJyb3JIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdlbGFzdGljOnJlc2l6ZScsICR0YSwgdGFIZWlnaHQsIG1pcnJvckhlaWdodCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YS5zdHlsZS5oZWlnaHQgPSBtaXJyb3JIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc21hbGwgZGVsYXkgdG8gcHJldmVudCBhbiBpbmZpbml0ZSBsb29wXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAxLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIGZvcmNlQWRqdXN0KCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkanVzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICAgICAgICogaW5pdGlhbGlzZVxuICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGxpc3RlblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCdvbnByb3BlcnR5Y2hhbmdlJyBpbiB0YSAmJiAnb25pbnB1dCcgaW4gdGEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBJRTlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YVsnb25pbnB1dCddID0gdGEub25rZXl1cCA9IGFkanVzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFbJ29uaW5wdXQnXSA9IGFkanVzdDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgJHdpbi5iaW5kKCdyZXNpemUnLCBmb3JjZUFkanVzdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5nTW9kZWwuJG1vZGVsVmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JjZUFkanVzdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLiRvbignZWxhc3RpYzphZGp1c3QnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdE1pcnJvcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcmNlQWRqdXN0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoYWRqdXN0LCAwLCBmYWxzZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8qXG4gICAgICAgICAgICAgICAgICAgICAgICAgKiBkZXN0cm95XG4gICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkbWlycm9yLnJlbW92ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR3aW4udW5iaW5kKCdyZXNpemUnLCBmb3JjZUFkanVzdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgIF0pO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubWVzc2FnZXMnLCBbJ21vbm9zcGFjZWQuZWxhc3RpYyddKTtcbn0pKCk7XG5cblxuXG5cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5wcm9maWxlc1wiLCBbJ2FwcC5hdXRoJ10pO1xufSkoKTtcbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuc2lkZW1lbnVcIiwgW10pO1xufSkoKTtcbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAudXNlcnNcIiwgWydhcHAuYXV0aCddKTtcbn0pKCk7XG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYXV0aENvbnRyb2xsZXIuJGluamVjdCA9IFtcIiRzY29wZVwiLCBcImF1dGhTZXJ2aWNlXCIsIFwiJGlvbmljUG9wdXBcIiwgXCIkaW9uaWNMb2FkaW5nXCIsIFwiJHN0YXRlXCIsIFwiJHRpbWVvdXRcIl07XG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYXV0aFwiKVxuXG4gICAgICAgIC5jb250cm9sbGVyKFwiYXV0aENvbnRyb2xsZXJcIiwgYXV0aENvbnRyb2xsZXIpO1xuXG5cbiAgICBmdW5jdGlvbiBhdXRoQ29udHJvbGxlcigkc2NvcGUsIGF1dGhTZXJ2aWNlLCAkaW9uaWNQb3B1cCwgJGlvbmljTG9hZGluZywgJHN0YXRlLCAkdGltZW91dCkge1xuXG4gICAgICAgICRzY29wZS5kYXRhID0ge307XG5cbiAgICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24oKSB7XG5cdFx0XHQkaW9uaWNMb2FkaW5nLnNob3coKTtcblxuXHRcdFx0YXV0aFNlcnZpY2UubG9naW4oJHNjb3BlLmRhdGEudXNlcm5hbWUsICRzY29wZS5kYXRhLnBhc3N3b3JkKS5zdWNjZXNzKGZ1bmN0aW9uKHVzZXIpIHtcblx0XHRcdFx0JGlvbmljTG9hZGluZy5oaWRlKCk7XG5cdFx0XHRcdCRzdGF0ZS5nbygnYXBwLmJ1aWxkaW5ncycpO1xuXG4gICAgICAgICAgICB9KS5lcnJvcihmdW5jdGlvbihlcnJvcikge1xuXHRcdFx0XHQkdGltZW91dChmdW5jdGlvbigpIHtcblx0XHRcdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblx0XHRcdFx0fSwgMTAwKTtcblxuICAgICAgICAgICAgICAgIHZhciBhbGVydFBvcHVwID0gJGlvbmljUG9wdXAuYWxlcnQoe1xuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0xvZ2luIGZhaWxlZCEnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogZXJyb3IubWVzc2FnZSAvLydQbGVhc2UgY2hlY2sgeW91ciBjcmVkZW50aWFscyEnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG5cdFx0JHNjb3BlLmZhY2Vib29rTG9naW4gPSBmdW5jdGlvbigpIHtcblx0XHRcdHZhciBhbGVydFBvcHVwID0gJGlvbmljUG9wdXAuYWxlcnQoe1xuXHRcdFx0XHR0aXRsZTogJ0ZhY2Vib29rIGxvZ2luJyxcblx0XHRcdFx0dGVtcGxhdGU6ICdQbGFubmVkISdcblx0XHRcdH0pO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcbihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhdXRoU2VydmljZS4kaW5qZWN0ID0gW1wiJHFcIiwgXCIkcm9vdFNjb3BlXCIsIFwidXNlclwiLCBcImJ1aWxkaW5nc1NlcnZpY2VcIiwgXCJzZWxlY3RlZEJ1aWxkaW5nXCJdO1xuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLmF1dGhcIilcblxuICAgICAgICAuc2VydmljZShcImF1dGhTZXJ2aWNlXCIsIGF1dGhTZXJ2aWNlKTtcblxuXHRmdW5jdGlvbiBjcmVhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cdFx0dmFyIGF1dGggPSBmaXJlYmFzZVNlcnZpY2UuZmIuYXV0aCgpO1xuXG5cdFx0cmV0dXJuIGF1dGguY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkKGVtYWlsLCBwYXNzd29yZCk7XG5cdH1cblx0XG4gICAgZnVuY3Rpb24gYXV0aFNlcnZpY2UoJHEsICRyb290U2NvcGUsIHVzZXIsIGJ1aWxkaW5nc1NlcnZpY2UsIHNlbGVjdGVkQnVpbGRpbmcpIHtcblx0XHR2YXIgYXV0aCA9IGZpcmViYXNlLmF1dGgoKTtcblx0XHRcblx0XHQkcm9vdFNjb3BlLiRvbignbmFtZS1jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgdXNyID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyO1xuXHRcdFx0aWYgKHVzciA9PSBudWxsKSByZXR1cm47XG5cdFx0XHRcblx0XHRcdGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCd1c2Vycy8nICsgdXNyLnVpZCkuc2V0KHtcblx0XHRcdFx0bmFtZTogdXNyLmRpc3BsYXlOYW1lLFxuXHRcdFx0XHRlbWFpbDogdXNyLmVtYWlsLFxuXHRcdFx0XHRsYXN0QWN0aXZpdHk6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdHJldHVybiB7XG4gICAgICAgICAgICBsb2dpbjogZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG5cblx0XHRcdFx0dmFyIHN1Y2Nlc3NIYW5kbGVyID0gZnVuY3Rpb24oaW5mbykge1xuXHRcdFx0XHRcdGluZm8uaXNOZXcgPSBpbmZvLmRpc3BsYXlOYW1lID09IG51bGw7XG5cdFx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShpbmZvKTtcblx0XHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdHVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS4kZW1pdCgnbmFtZS1jaGFuZ2VkJyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0dmFyIGVycm9ySGFuZGxlciA9IGZ1bmN0aW9uKGVycm9yKSB7XG5cdFx0XHRcdFx0ZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRhdXRoLnNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHRcdFx0XHQudGhlbihzdWNjZXNzSGFuZGxlciwgZnVuY3Rpb24gZXJyb3IoZXJyb3IpIHtcblx0XHRcdFx0XHRcdGlmIChlcnJvci5jb2RlID09IFwiYXV0aC91c2VyLW5vdC1mb3VuZFwiKSB7XG5cdFx0XHRcdFx0XHRcdGF1dGguY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHRcdFx0XHRcdFx0XHQudGhlbihzdWNjZXNzSGFuZGxlciwgZXJyb3JIYW5kbGVyKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRlcnJvckhhbmRsZXIoZXJyb3IpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5zdWNjZXNzID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZS50aGVuKGZuKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb21pc2UuZXJyb3IgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4obnVsbCwgZm4pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgICAgICB9LFxuXG5cdFx0XHRsb2dvdXQ6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0YXV0aC5zaWduT3V0KCk7XG5cdFx0XHRcdHVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7XG5cdFx0XHR9LFxuXG4gICAgICAgICAgICB1c2VyOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYnVpbGRpbmdDaGFubmVsc1NlcnZpY2UuJGluamVjdCA9IFtcImZpcmViYXNlU2VydmljZVwiXTtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5idWlsZGluZ3MnKVxuICAgICAgICAuc2VydmljZSgnYnVpbGRpbmdDaGFubmVsc1NlcnZpY2UnLCBidWlsZGluZ0NoYW5uZWxzU2VydmljZSk7XG5cbiAgICBmdW5jdGlvbiBidWlsZGluZ0NoYW5uZWxzU2VydmljZShmaXJlYmFzZVNlcnZpY2UpIHtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0Q2hhbm5lbHNGcm9tOiBmdW5jdGlvbiAoYnVpbGRpbmcpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlyZWJhc2VTZXJ2aWNlLmZiLmRhdGFiYXNlKCkucmVmKCdidWlsZGluZ3MvJyArIGJ1aWxkaW5nICsgXCIvY2hhbm5lbHNcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYnVpbGRpbmdDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkaW9uaWNMb2FkaW5nXCIsIFwiJHN0YXRlUGFyYW1zXCIsIFwiYnVpbGRpbmdDaGFubmVsc1NlcnZpY2VcIl07XG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYnVpbGRpbmdzXCIpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoXCJidWlsZGluZ0NvbnRyb2xsZXJcIiwgYnVpbGRpbmdDb250cm9sbGVyKTtcblxuXG4gICAgZnVuY3Rpb24gYnVpbGRpbmdDb250cm9sbGVyKCRzY29wZSwgJGlvbmljTG9hZGluZywgJHN0YXRlUGFyYW1zLCBidWlsZGluZ0NoYW5uZWxzU2VydmljZSkge1xuXG4gICAgICAgIHZhciByZWYgPSBidWlsZGluZ0NoYW5uZWxzU2VydmljZS5nZXRDaGFubmVsc0Zyb20oJHN0YXRlUGFyYW1zLmJ1aWxkaW5nSWQpO1xuXG4gICAgICAgICRpb25pY0xvYWRpbmcuc2hvdygpO1xuICAgICAgICByZWYub24oXCJ2YWx1ZVwiLCBmdW5jdGlvbiAoc25hcHNob3QpIHtcbiAgICAgICAgICAgIHZhciB2YWwgPSBzbmFwc2hvdC52YWwoKTtcblxuICAgICAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGFubmVscyA9IGFuZ3VsYXIuZXh0ZW5kKHZhbC5jb21tb24sIHZhbC5zZXJ2aWNlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG5cbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yT2JqZWN0KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImVycm9yIHJlYWRpbmc6IFwiICsgZXJyb3JPYmplY3QuY29kZSk7XG4gICAgICAgICAgICB2YXIgYWxlcnRQb3B1cCA9ICRpb25pY1BvcHVwLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ09wcyEnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnU29ycnkhIEFuIGVycm9yIG9jdXJyZWQuJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBidWlsZGluZ3NDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkaW9uaWNMb2FkaW5nXCIsIFwiYnVpbGRpbmdzU2VydmljZVwiLCBcInNlbGVjdGVkQnVpbGRpbmdcIl07XG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYnVpbGRpbmdzXCIpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoXCJidWlsZGluZ3NDb250cm9sbGVyXCIsIGJ1aWxkaW5nc0NvbnRyb2xsZXIpO1xuXG5cbiAgICBmdW5jdGlvbiBidWlsZGluZ3NDb250cm9sbGVyKCRzY29wZSwgJGlvbmljTG9hZGluZywgYnVpbGRpbmdzU2VydmljZSwgc2VsZWN0ZWRCdWlsZGluZykge1xuICAgICAgICB2YXIgcmVmID0gYnVpbGRpbmdzU2VydmljZS5nZXRCdWlsZGluZ3MoKTtcblx0XHRcblx0XHQkc2NvcGUuc2VsZWN0ZWRLZXkgPSBzZWxlY3RlZEJ1aWxkaW5nID8gc2VsZWN0ZWRCdWlsZGluZy5rZXkgOiBudWxsO1xuXHRcdFxuXHRcdCRzY29wZS5zZWxlY3QgPSBmdW5jdGlvbihrZXksIGJ1aWxkaW5nKSB7XG5cdFx0XHQkc2NvcGUuc2VsZWN0ZWRLZXkgPSBidWlsZGluZy5rZXkgPSBrZXk7XG5cdFx0XHRzZWxlY3RlZEJ1aWxkaW5nID0gYnVpbGRpbmc7XG5cdFx0XHQkc2NvcGUuJGVtaXQoXCJidWlsZGluZy1zZWxlY3RlZFwiLCBzZWxlY3RlZEJ1aWxkaW5nKTtcblx0XHR9O1x0XHRcblxuICAgICAgICAkaW9uaWNMb2FkaW5nLnNob3coKTtcbiAgICAgICAgcmVmLm9uKFwidmFsdWVcIiwgZnVuY3Rpb24gKHNuYXBzaG90KSB7XG4gICAgICAgICAgICAkc2NvcGUuYnVpbGRpbmdzID0gc25hcHNob3QudmFsKCk7XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yT2JqZWN0KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImVycm9yIHJlYWRpbmc6IFwiICsgZXJyb3JPYmplY3QuY29kZSk7XG4gICAgICAgICAgICB2YXIgYWxlcnRQb3B1cCA9ICRpb25pY1BvcHVwLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ09wcyEnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnU29ycnkhIEFuIGVycm9yIG9jdXJyZWQnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBidWlsZGluZ3NTZXJ2aWNlLiRpbmplY3QgPSBbXCJmaXJlYmFzZVNlcnZpY2VcIiwgXCIkcm9vdFNjb3BlXCJdO1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmJ1aWxkaW5ncycpXG4gICAgICAgIC5zZXJ2aWNlKCdidWlsZGluZ3NTZXJ2aWNlJywgYnVpbGRpbmdzU2VydmljZSk7XG5cbiAgICBmdW5jdGlvbiBidWlsZGluZ3NTZXJ2aWNlKGZpcmViYXNlU2VydmljZSwgJHJvb3RTY29wZSkge1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRCdWlsZGluZ3M6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoJ2J1aWxkaW5ncycpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmZpcmViYXNlJylcbiAgICAgICAgLnNlcnZpY2UoJ2ZpcmViYXNlU2VydmljZScsIGZpcmViYXNlU2VydmljZSk7XG5cblxuICAgIGZ1bmN0aW9uIGZpcmViYXNlU2VydmljZSgpIHtcbiAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgIGFwaUtleTogXCJBSXphU3lCNXE4MUFHR294NGk4LVFMMktPdG5ERGZpMDVpcmdjSEVcIixcbiAgICAgICAgICAgIGF1dGhEb21haW46IFwic29jaWFsc3RyYXRhaWRlYXRlYW0uZmlyZWJhc2VhcHAuY29tXCIsXG4gICAgICAgICAgICBkYXRhYmFzZVVSTDogXCJodHRwczovL3NvY2lhbHN0cmF0YWlkZWF0ZWFtLmZpcmViYXNlaW8uY29tXCIsXG4gICAgICAgICAgICBzdG9yYWdlQnVja2V0OiBcIlwiLFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuZmIgPSBmaXJlYmFzZS5pbml0aWFsaXplQXBwKGNvbmZpZyk7XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5tZXNzYWdlcycpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoJ21lc3NhZ2VzQ29udHJvbGxlcicsIFsnJHNjb3BlJywgJyRyb290U2NvcGUnLCAnJHN0YXRlJyxcbiAgICAgICAgICAgICckc3RhdGVQYXJhbXMnLCAnJGlvbmljQWN0aW9uU2hlZXQnLFxuICAgICAgICAgICAgJyRpb25pY1BvcHVwJywgJyRpb25pY1Njcm9sbERlbGVnYXRlJywgJyR0aW1lb3V0JywgJyRpbnRlcnZhbCcsXG4gICAgICAgICAgICBtZXNzYWdlc0NvbnRyb2xsZXJcbiAgICAgICAgXSlcblxuICAgIGZ1bmN0aW9uIG1lc3NhZ2VzQ29udHJvbGxlcigkc2NvcGUsICRyb290U2NvcGUsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkaW9uaWNBY3Rpb25TaGVldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJGlvbmljUG9wdXAsICRpb25pY1Njcm9sbERlbGVnYXRlLCAkdGltZW91dCwgJGludGVydmFsKSB7XG5cbiAgICAgICAgLy8gbW9jayBhY3F1aXJpbmcgZGF0YSB2aWEgJHN0YXRlUGFyYW1zXG4gICAgICAgICRzY29wZS50b1VzZXIgPSB7XG4gICAgICAgICAgICBfaWQ6ICc1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWInLFxuICAgICAgICAgICAgcGljOiAnaHR0cDovL2lvbmljZnJhbWV3b3JrLmNvbS9pbWcvZG9jcy92ZW5rbWFuLmpwZycsXG4gICAgICAgICAgICBjaGFubmVsOiAkc3RhdGUucGFyYW1zLmNoYW5uZWxJZFxuICAgICAgICB9XG5cbiAgICAgICAgLy8gdGhpcyBjb3VsZCBiZSBvbiAkcm9vdFNjb3BlIHJhdGhlciB0aGFuIGluICRzdGF0ZVBhcmFtc1xuICAgICAgICAkc2NvcGUudXNlciA9IHtcbiAgICAgICAgICAgIF9pZDogJzUzNGI4ZmIyYWE1ZTdhZmMxYjIzZTY5YycsXG4gICAgICAgICAgICBwaWM6ICdodHRwOi8vaW9uaWNmcmFtZXdvcmsuY29tL2ltZy9kb2NzL21jZmx5LmpwZycsXG4gICAgICAgICAgICB1c2VybmFtZTogJ01hcnR5J1xuICAgICAgICB9O1xuXG4gICAgICAgICRzY29wZS5pbnB1dCA9IHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IGxvY2FsU3RvcmFnZVsndXNlck1lc3NhZ2UtJyArICRzY29wZS50b1VzZXIuX2lkXSB8fCAnJ1xuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBtZXNzYWdlQ2hlY2tUaW1lcjtcblxuICAgICAgICB2YXIgdmlld1Njcm9sbCA9ICRpb25pY1Njcm9sbERlbGVnYXRlLiRnZXRCeUhhbmRsZSgndXNlck1lc3NhZ2VTY3JvbGwnKTtcbiAgICAgICAgdmFyIGZvb3RlckJhcjsgLy8gZ2V0cyBzZXQgaW4gJGlvbmljVmlldy5lbnRlclxuICAgICAgICB2YXIgc2Nyb2xsZXI7XG4gICAgICAgIHZhciB0eHRJbnB1dDsgLy8gXl5eXG5cbiAgICAgICAgJHNjb3BlLiRvbignJGlvbmljVmlldy5lbnRlcicsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyTWVzc2FnZXMgJGlvbmljVmlldy5lbnRlcicpO1xuXG4gICAgICAgICAgICBnZXRNZXNzYWdlcygpO1xuXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgZm9vdGVyQmFyID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcjdXNlck1lc3NhZ2VzVmlldyAuYmFyLWZvb3RlcicpO1xuICAgICAgICAgICAgICAgIHNjcm9sbGVyID0gZG9jdW1lbnQuYm9keS5xdWVyeVNlbGVjdG9yKCcjdXNlck1lc3NhZ2VzVmlldyAuc2Nyb2xsLWNvbnRlbnQnKTtcbiAgICAgICAgICAgICAgICB0eHRJbnB1dCA9IGFuZ3VsYXIuZWxlbWVudChmb290ZXJCYXIucXVlcnlTZWxlY3RvcigndGV4dGFyZWEnKSk7XG4gICAgICAgICAgICB9LCAwKTtcblxuICAgICAgICAgICAgbWVzc2FnZUNoZWNrVGltZXIgPSAkaW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vIGhlcmUgeW91IGNvdWxkIGNoZWNrIGZvciBuZXcgbWVzc2FnZXMgaWYgeW91ciBhcHAgZG9lc24ndCB1c2UgcHVzaCBub3RpZmljYXRpb25zIG9yIHVzZXIgZGlzYWJsZWQgdGhlbVxuICAgICAgICAgICAgfSwgMjAwMDApO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuJG9uKCckaW9uaWNWaWV3LmxlYXZlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2xlYXZpbmcgVXNlck1lc3NhZ2VzIHZpZXcsIGRlc3Ryb3lpbmcgaW50ZXJ2YWwnKTtcbiAgICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IHRoZSBpbnRlcnZhbCBpcyBkZXN0cm95ZWRcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChtZXNzYWdlQ2hlY2tUaW1lcikpIHtcbiAgICAgICAgICAgICAgICAkaW50ZXJ2YWwuY2FuY2VsKG1lc3NhZ2VDaGVja1RpbWVyKTtcbiAgICAgICAgICAgICAgICBtZXNzYWdlQ2hlY2tUaW1lciA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJGlvbmljVmlldy5iZWZvcmVMZWF2ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghJHNjb3BlLmlucHV0Lm1lc3NhZ2UgfHwgJHNjb3BlLmlucHV0Lm1lc3NhZ2UgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VzZXJNZXNzYWdlLScgKyAkc2NvcGUudG9Vc2VyLl9pZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldE1lc3NhZ2VzKCkge1xuICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2VzID0gW3tcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjUzNWQ2MjVmODk4ZGY0ZTgwZTJhMTI1ZVwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIklvbmljIGhhcyBjaGFuZ2VkIHRoZSBnYW1lIGZvciBoeWJyaWQgYXBwIGRldmVsb3BtZW50LlwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhmYjJhYTVlN2FmYzFiMjNlNjljXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0wNC0yN1QyMDowMjozOS4wODJaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzcuOTQ0WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1MzVmMTNmZmVlM2IyYTY4MTEyYjlmYzBcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJJIGxpa2UgSW9uaWMgYmV0dGVyIHRoYW4gaWNlIGNyZWFtIVwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhlNWFhYTVlN2FmYzFiMjNlNjliXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0wNC0yOVQwMjo1Mjo0Ny43MDZaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzcuOTQ0WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDZhNTg0M2ZkNGM1ZDU4MWVmYTI2M2FcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJMb3JlbSBpcHN1bSBkb2xvciBzaXQgYW1ldCwgY29uc2VjdGV0dXIgYWRpcGlzY2luZyBlbGl0LCBzZWQgZG8gZWl1c21vZCB0ZW1wb3IgaW5jaWRpZHVudCB1dCBsYWJvcmUgZXQgZG9sb3JlIG1hZ25hIGFsaXF1YS4gVXQgZW5pbSBhZCBtaW5pbSB2ZW5pYW0sIHF1aXMgbm9zdHJ1ZCBleGVyY2l0YXRpb24gdWxsYW1jbyBsYWJvcmlzIG5pc2kgdXQgYWxpcXVpcCBleCBlYSBjb21tb2RvIGNvbnNlcXVhdC4gRHVpcyBhdXRlIGlydXJlIGRvbG9yIGluIHJlcHJlaGVuZGVyaXQgaW4gdm9sdXB0YXRlIHZlbGl0IGVzc2UgY2lsbHVtIGRvbG9yZSBldSBmdWdpYXQgbnVsbGEgcGFyaWF0dXIuIEV4Y2VwdGV1ciBzaW50IG9jY2FlY2F0IGN1cGlkYXRhdCBub24gcHJvaWRlbnQsIHN1bnQgaW4gY3VscGEgcXVpIG9mZmljaWEgZGVzZXJ1bnQgbW9sbGl0IGFuaW0gaWQgZXN0IGxhYm9ydW0uXCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGZiMmFhNWU3YWZjMWIyM2U2OWNcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTE3VDIwOjE5OjE1LjI4OVpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMjhaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzY0Mzk5YWI0M2QxZDQxMTNhYmZkMVwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIkFtIEkgZHJlYW1pbmc/XCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWJcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI2VDIxOjE4OjE3LjU5MVpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzdaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzY0M2FlYWI0M2QxZDQxMTNhYmZkMlwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIklzIHRoaXMgbWFnaWM/XCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGZiMmFhNWU3YWZjMWIyM2U2OWNcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI2VDIxOjE4OjM4LjU0OVpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzhaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzgxNWRiYWI0M2QxZDQxMTNhYmZlZlwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIkdlZSB3aXosIHRoaXMgaXMgc29tZXRoaW5nIHNwZWNpYWwuXCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWJcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI4VDA2OjI3OjQwLjAwMVpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzhaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzgxYzY5YWI0M2QxZDQxMTNhYmZmMFwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIkkgdGhpbmsgSSBsaWtlIElvbmljIG1vcmUgdGhhbiBJIGxpa2UgaWNlIGNyZWFtIVwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhmYjJhYTVlN2FmYzFiMjNlNjljXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0yOFQwNjo1NTozNy4zNTBaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzM4WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDc4MWNhNGFiNDNkMWQ0MTEzYWJmZjFcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJZZWEsIGl0J3MgcHJldHR5IHN3ZWV0XCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGU1YWFhNWU3YWZjMWIyM2U2OWJcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI4VDA2OjU2OjM2LjQ3MlpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzhaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzhkZjg2YWI0M2QxZDQxMTNhYmZmNFwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIldvdywgdGhpcyBpcyByZWFsbHkgc29tZXRoaW5nIGh1aD9cIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZmIyYWE1ZTdhZmMxYjIzZTY5Y1wiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMTEtMjhUMjA6NDg6MDYuNTcyWlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM4LjMzOVpcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTQ3ODFjYTRhYjQzZDFkNDExM2FiZmYxXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiQ3JlYXRlIGFtYXppbmcgYXBwcyAtIGlvbmljZnJhbWV3b3JrLmNvbVwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhlNWFhYTVlN2FmYzFiMjNlNjliXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0yOVQwNjo1NjozNi40NzJaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzM4WlwiXG4gICAgICAgICAgICB9XTtcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2lucHV0Lm1lc3NhZ2UnLCBmdW5jdGlvbiAobmV3VmFsdWUsIG9sZFZhbHVlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnaW5wdXQubWVzc2FnZSAkd2F0Y2gsIG5ld1ZhbHVlICcgKyBuZXdWYWx1ZSk7XG4gICAgICAgICAgICBpZiAoIW5ld1ZhbHVlKSBuZXdWYWx1ZSA9ICcnO1xuICAgICAgICAgICAgbG9jYWxTdG9yYWdlWyd1c2VyTWVzc2FnZS0nICsgJHNjb3BlLnRvVXNlci5faWRdID0gbmV3VmFsdWU7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS5zZW5kTWVzc2FnZSA9IGZ1bmN0aW9uIChzZW5kTWVzc2FnZUZvcm0pIHtcbiAgICAgICAgICAgIHZhciBtZXNzYWdlID0ge1xuICAgICAgICAgICAgICAgIHRvSWQ6ICRzY29wZS50b1VzZXIuX2lkLFxuICAgICAgICAgICAgICAgIHRleHQ6ICRzY29wZS5pbnB1dC5tZXNzYWdlXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyBpZiB5b3UgZG8gYSB3ZWIgc2VydmljZSBjYWxsIHRoaXMgd2lsbCBiZSBuZWVkZWQgYXMgd2VsbCBhcyBiZWZvcmUgdGhlIHZpZXdTY3JvbGwgY2FsbHNcbiAgICAgICAgICAgIC8vIHlvdSBjYW4ndCBzZWUgdGhlIGVmZmVjdCBvZiB0aGlzIGluIHRoZSBicm93c2VyIGl0IG5lZWRzIHRvIGJlIHVzZWQgb24gYSByZWFsIGRldmljZVxuICAgICAgICAgICAgLy8gZm9yIHNvbWUgcmVhc29uIHRoZSBvbmUgdGltZSBibHVyIGV2ZW50IGlzIG5vdCBmaXJpbmcgaW4gdGhlIGJyb3dzZXIgYnV0IGRvZXMgb24gZGV2aWNlc1xuICAgICAgICAgICAga2VlcEtleWJvYXJkT3BlbigpO1xuXG4gICAgICAgICAgICAvL01vY2tTZXJ2aWNlLnNlbmRNZXNzYWdlKG1lc3NhZ2UpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgJHNjb3BlLmlucHV0Lm1lc3NhZ2UgPSAnJztcblxuICAgICAgICAgICAgbWVzc2FnZS5faWQgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsgLy8gOn4pXG4gICAgICAgICAgICBtZXNzYWdlLmRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgICAgICAgICAgbWVzc2FnZS51c2VybmFtZSA9ICRzY29wZS51c2VyLnVzZXJuYW1lO1xuICAgICAgICAgICAgbWVzc2FnZS51c2VySWQgPSAkc2NvcGUudXNlci5faWQ7XG4gICAgICAgICAgICBtZXNzYWdlLnBpYyA9ICRzY29wZS51c2VyLnBpY3R1cmU7XG5cbiAgICAgICAgICAgICRzY29wZS5tZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO1xuXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAga2VlcEtleWJvYXJkT3BlbigpO1xuICAgICAgICAgICAgICAgIHZpZXdTY3JvbGwuc2Nyb2xsQm90dG9tKHRydWUpO1xuICAgICAgICAgICAgfSwgMCk7XG5cbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZXMucHVzaChNb2NrU2VydmljZS5nZXRNb2NrTWVzc2FnZSgpKTtcbiAgICAgICAgICAgICAgICBrZWVwS2V5Ym9hcmRPcGVuKCk7XG4gICAgICAgICAgICAgICAgdmlld1Njcm9sbC5zY3JvbGxCb3R0b20odHJ1ZSk7XG4gICAgICAgICAgICB9LCAyMDAwKTtcblxuICAgICAgICAgICAgLy99KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyB0aGlzIGtlZXBzIHRoZSBrZXlib2FyZCBvcGVuIG9uIGEgZGV2aWNlIG9ubHkgYWZ0ZXIgc2VuZGluZyBhIG1lc3NhZ2UsIGl0IGlzIG5vbiBvYnRydXNpdmVcbiAgICAgICAgZnVuY3Rpb24ga2VlcEtleWJvYXJkT3BlbigpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdrZWVwS2V5Ym9hcmRPcGVuJyk7XG4gICAgICAgICAgICB0eHRJbnB1dC5vbmUoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3RleHRhcmVhIGJsdXIsIGZvY3VzIGJhY2sgb24gaXQnKTtcbiAgICAgICAgICAgICAgICB0eHRJbnB1dFswXS5mb2N1cygpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBvblByb2ZpbGVQaWNFcnJvcihlbGUpIHtcbiAgICAgICAgICAgIHRoaXMuZWxlLnNyYyA9ICcnOyAvLyBzZXQgYSBmYWxsYmFja1xuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLm9uTWVzc2FnZUhvbGQgPSBmdW5jdGlvbiAoZSwgaXRlbUluZGV4LCBtZXNzYWdlKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnb25NZXNzYWdlSG9sZCcpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ21lc3NhZ2U6ICcgKyBKU09OLnN0cmluZ2lmeShtZXNzYWdlLCBudWxsLCAyKSk7XG4gICAgICAgICAgICAkaW9uaWNBY3Rpb25TaGVldC5zaG93KHtcbiAgICAgICAgICAgICAgICBidXR0b25zOiBbe1xuICAgICAgICAgICAgICAgICAgICB0ZXh0OiAnQ29weSBUZXh0J1xuICAgICAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0RlbGV0ZSBNZXNzYWdlJ1xuICAgICAgICAgICAgICAgIH1dLFxuICAgICAgICAgICAgICAgIGJ1dHRvbkNsaWNrZWQ6IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGluZGV4KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6IC8vIENvcHkgVGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vY29yZG92YS5wbHVnaW5zLmNsaXBib2FyZC5jb3B5KG1lc3NhZ2UudGV4dCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTogLy8gRGVsZXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm8gc2VydmVyIHNpZGUgc2VjcmV0cyBoZXJlIDp+KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5tZXNzYWdlcy5zcGxpY2UoaXRlbUluZGV4LCAxKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdTY3JvbGwucmVzaXplKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwgMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuXG4gICAgICAgIC8vIHRoaXMgcHJvYiBzZWVtcyB3ZWlyZCBoZXJlIGJ1dCBJIGhhdmUgcmVhc29ucyBmb3IgdGhpcyBpbiBteSBhcHAsIHNlY3JldCFcbiAgICAgICAgJHNjb3BlLnZpZXdQcm9maWxlID0gZnVuY3Rpb24gKG1zZykge1xuICAgICAgICAgICAgaWYgKG1zZy51c2VySWQgPT09ICRzY29wZS51c2VyLl9pZCkge1xuICAgICAgICAgICAgICAgIC8vIGdvIHRvIHlvdXIgcHJvZmlsZVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBnbyB0byBvdGhlciB1c2VycyBwcm9maWxlXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gSSBlbWl0IHRoaXMgZXZlbnQgZnJvbSB0aGUgbW9ub3NwYWNlZC5lbGFzdGljIGRpcmVjdGl2ZSwgcmVhZCBsaW5lIDQ4MFxuICAgICAgICAkc2NvcGUuJG9uKCd0YVJlc2l6ZScsIGZ1bmN0aW9uIChlLCB0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3RhUmVzaXplJyk7XG4gICAgICAgICAgICBpZiAoIXRhKSByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciB0YUhlaWdodCA9IHRhWzBdLm9mZnNldEhlaWdodDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YUhlaWdodDogJyArIHRhSGVpZ2h0KTtcblxuICAgICAgICAgICAgaWYgKCFmb290ZXJCYXIpIHJldHVybjtcblxuICAgICAgICAgICAgdmFyIG5ld0Zvb3RlckhlaWdodCA9IHRhSGVpZ2h0ICsgMTA7XG4gICAgICAgICAgICBuZXdGb290ZXJIZWlnaHQgPSAobmV3Rm9vdGVySGVpZ2h0ID4gNDQpID8gbmV3Rm9vdGVySGVpZ2h0IDogNDQ7XG5cbiAgICAgICAgICAgIGZvb3RlckJhci5zdHlsZS5oZWlnaHQgPSBuZXdGb290ZXJIZWlnaHQgKyAncHgnO1xuICAgICAgICAgICAgc2Nyb2xsZXIuc3R5bGUuYm90dG9tID0gbmV3Rm9vdGVySGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgfSk7XG5cbiAgICB9XG59KSgpO1xuXG5cblxuXG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubWVzc2FnZXMnKVxuXG4gICAgICAgIC5maWx0ZXIoJ25sMmJyJywgWyckZmlsdGVyJywgbmwyYnJdKVxuXG4gICAgZnVuY3Rpb24gbmwyYnIoJGZpbHRlcikge1xuICAgICAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGlmICghZGF0YSkgcmV0dXJuIGRhdGE7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5yZXBsYWNlKC9cXG5cXHI/L2csICc8YnIgLz4nKTtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBtZXNzYWdlc1NlcnZpY2UuJGluamVjdCA9IFtcImZpcmViYXNlU2VydmljZVwiXTtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5tZXNzYWdlcycpXG4gICAgICAgIC5zZXJ2aWNlKCdtZXNzYWdlc1NlcnZpY2UnLCBtZXNzYWdlc1NlcnZpY2UpO1xuXG4gICAgZnVuY3Rpb24gbWVzc2FnZXNTZXJ2aWNlKGZpcmViYXNlU2VydmljZSkge1xuICAgICAgICB2YXIgc2VydmljZSA9IHt9O1xuXG4gICAgICAgIHNlcnZpY2UuZ2V0TWVzc2FnZXNSZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoJ21lc3NhZ2VzJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VydmljZS5hZGRNZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmaXJlYmFzZVNlcnZpY2UuZmIuZGF0YWJhc2UoKS5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHByb2ZpbGVDb250cm9sbGVyLiRpbmplY3QgPSBbXCIkc2NvcGVcIiwgXCIkaW9uaWNMb2FkaW5nXCIsIFwiJGlvbmljUG9wdXBcIiwgXCJhdXRoU2VydmljZVwiLCBcInByb2ZpbGVzU2VydmljZVwiXTtcbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5wcm9maWxlc1wiKVxuXG4gICAgICAgIC5jb250cm9sbGVyKFwicHJvZmlsZUNvbnRyb2xsZXJcIiwgcHJvZmlsZUNvbnRyb2xsZXIpO1xuXG5cbiAgICBmdW5jdGlvbiBwcm9maWxlQ29udHJvbGxlcigkc2NvcGUsICRpb25pY0xvYWRpbmcsICRpb25pY1BvcHVwLCBhdXRoU2VydmljZSwgcHJvZmlsZXNTZXJ2aWNlKSB7XG5cblx0XHR2YXIgdXNlciA9IGF1dGhTZXJ2aWNlLnVzZXIoKTtcblx0XHRcblx0XHQkc2NvcGUuZGF0YSA9IHtcblx0XHRcdGRpc3BsYXlOYW1lIDogdXNlciA/IHVzZXIuZGlzcGxheU5hbWUgOiBcIlwiLFxuXHRcdFx0ZW1haWwgOiB1c2VyID8gdXNlci5lbWFpbCA6IFwiXCJcblx0XHR9O1xuXG4gICAgICAgICRzY29wZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcblx0XHRcdCRpb25pY0xvYWRpbmcuc2hvdygpO1xuXG4gICAgICAgICAgICBwcm9maWxlc1NlcnZpY2UudXBkYXRlUHJvZmlsZSgkc2NvcGUuZGF0YSkudGhlbihmdW5jdGlvbiBzdWNjZXNzKG1zZykge1xuXHRcdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblxuXHRcdFx0XHQkaW9uaWNQb3B1cC5hbGVydCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnUHJvZmlsZVVwZGF0ZSEnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogbXNnXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yKGVycm9yKSB7XG5cdFx0XHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXG5cdFx0XHRcdCRpb25pY1BvcHVwLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdVcGRhdGUgZmFpbGVkIScsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBlcnJvci5tZXNzYWdlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgcHJvZmlsZXNTZXJ2aWNlLiRpbmplY3QgPSBbXCIkcVwiLCBcIiRyb290U2NvcGVcIiwgXCJhdXRoU2VydmljZVwiLCBcInVzZXJcIl07XG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAucHJvZmlsZXNcIilcblxuICAgICAgICAuc2VydmljZShcInByb2ZpbGVzU2VydmljZVwiLCBwcm9maWxlc1NlcnZpY2UpO1xuXG5cbiAgICBmdW5jdGlvbiBwcm9maWxlc1NlcnZpY2UoJHEsICRyb290U2NvcGUsIGF1dGhTZXJ2aWNlLCB1c2VyKSB7XG5cdFx0XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cGRhdGVQcm9maWxlOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnVzZXIoKS51cGRhdGVQcm9maWxlKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3MoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKFwiUHJvZmlsZSB1cGRhdGVkIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ25hbWUtY2hhbmdlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvcihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHNpZGVtZW51Q29udHJvbGxlci4kaW5qZWN0ID0gW1wiJHNjb3BlXCIsIFwiJHN0YXRlXCJdO1xuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLnNpZGVtZW51XCIpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoXCJzaWRlbWVudUNvbnRyb2xsZXJcIiwgc2lkZW1lbnVDb250cm9sbGVyKTtcblxuXG4gICAgZnVuY3Rpb24gc2lkZW1lbnVDb250cm9sbGVyKCRzY29wZSwgJHN0YXRlKSB7XG5cdFx0Ly8gJHNjb3BlLiRvbignbmFtZS1jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG5cdFx0Ly8gXHQkc2NvcGUuZGlzcGxheU5hbWUgPSBhdXRoU2VydmljZS51c2VyKCkuZGlzcGxheU5hbWU7XG5cdFx0Ly8gfSk7XG5cdFx0XG5cdFx0JHNjb3BlLmJ1aWxkaW5nID0ge1xuXHRcdFx0bmFtZTogXCJTZWxlY3QgYSBidWlsZGluZ1wiLFxuXHRcdFx0YWRkcmVzczogXCJcIixcblx0XHR9O1xuXHRcdFxuXHRcdCRzY29wZS4kb24oJ2J1aWxkaW5nLXNlbGVjdGVkJywgZnVuY3Rpb24oZXZlbnQsIGRhdGEpIHtcblx0XHRcdCRzY29wZS5idWlsZGluZy5uYW1lID0gZGF0YS5uYW1lO1xuXHRcdFx0JHNjb3BlLmJ1aWxkaW5nLmFkZHJlc3MgPSBkYXRhLmFkZHJlc3M7XG5cdFx0XHRcblx0XHR9KTtcblx0XHRcblx0XHQkc2NvcGUuY2hhbm5lbCA9IGZ1bmN0aW9uKGNoYW5uZWxLZXkpIHtcblx0XHRcdCRzdGF0ZS5nbygnYXBwLmNoYW5uZWwnLCB7IGNoYW5uZWxJZDogY2hhbm5lbEtleX0pO1xuXHRcdH07XG4gICAgfVxufSkoKTtcblxuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIHVzZXJzU2VydmljZS4kaW5qZWN0ID0gW1wiJHFcIiwgXCJhdXRoU2VydmljZVwiXTtcbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC51c2Vyc1wiKVxuXG4gICAgICAgIC5zZXJ2aWNlKFwidXNlcnNTZXJ2aWNlXCIsIHVzZXJzU2VydmljZSk7XG5cblxuICAgIGZ1bmN0aW9uIHVzZXJzU2VydmljZSgkcSwgYXV0aFNlcnZpY2UpIHtcblx0ICAgIHJldHVybiB7XG4gICAgICAgICAgICB1cGRhdGVQcm9maWxlOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLnVzZXIoKS51cGRhdGVQcm9maWxlKGRhdGEpXG4gICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIHN1Y2Nlc3MoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKFwiUHJvZmlsZSB1cGRhdGVkIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7XG4gICAgICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoJ25hbWUtY2hhbmdlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbiBlcnJvcihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH1cbiAgICB9XG59KSgpO1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG5cbiAgICAgICAgLm1vZHVsZSgnYXBwJywgW1xuICAgICAgICAgICAgJ2lvbmljJyxcbiAgICAgICAgICAgICdtb25vc3BhY2VkLmVsYXN0aWMnLFxuXG4gICAgICAgICAgICAnYXBwLmZpcmViYXNlJyxcbiAgICAgICAgICAgICdhcHAuYXV0aCcsXG4gICAgICAgICAgICAnYXBwLnNpZGVtZW51JyxcbiAgICAgICAgICAgICdhcHAuYnVpbGRpbmdzJyxcbiAgICAgICAgICAgICdhcHAucHJvZmlsZXMnLFxuICAgICAgICAgICAgJ2FwcC5tZXNzYWdlcydcbiAgICAgICAgXSlcblx0XHRcblx0XHQudmFsdWUoXCJ1c2VyXCIsIG51bGwpXG5cdFx0LnZhbHVlKFwic2VsZWN0ZWRCdWlsZGluZ1wiLCBudWxsKVxuXG4gICAgICAgIC52YWx1ZShcInVzZXJcIiwgbnVsbClcblxuICAgICAgICAucnVuKFtcIiRpb25pY1BsYXRmb3JtXCIsIFwiJHRpbWVvdXRcIiwgXCIkcm9vdFNjb3BlXCIsIGZ1bmN0aW9uICgkaW9uaWNQbGF0Zm9ybSwgJHRpbWVvdXQsICRyb290U2NvcGUpIHtcbiAgICAgICAgICAgICRpb25pY1BsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LmNvcmRvdmEgJiYgd2luZG93LmNvcmRvdmEucGx1Z2lucy5LZXlib2FyZCkge1xuICAgICAgICAgICAgICAgICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvcmRvdmEucGx1Z2lucy5LZXlib2FyZC5kaXNhYmxlU2Nyb2xsKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAod2luZG93LlN0YXR1c0Jhcikge1xuICAgICAgICAgICAgICAgICAgICBTdGF0dXNCYXIuc3R5bGVEZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCduYW1lLWNoYW5nZWQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSk7XG59KSgpO1xuXG5cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG5cbiAgICAgICAgLm1vZHVsZSgnYXBwJylcblxuICAgICAgICAucnVuKFsnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHN0YXRlLCBhdXRoU2VydmljZSkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UudXNlcigpID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSlcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXG5cbiAgICAgICAgLmNvbmZpZyhbXCIkc3RhdGVQcm92aWRlclwiLCBcIiR1cmxSb3V0ZXJQcm92aWRlclwiLCBmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuXG4gICAgICAgICAgICAkc3RhdGVQcm92aWRlclxuXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdhcHAnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9hcHAnLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3NpZGVtZW51Lmh0bWwnLFxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcC5idWlsZGluZ3MnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9idWlsZGluZ3MnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvYnVpbGRpbmdzLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdhcHAuYnVpbGRpbmcnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9idWlsZGluZ3MvOmJ1aWxkaW5nSWQnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ21lbnVDb250ZW50Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvYnVpbGRpbmcuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcC5jaGFubmVsJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvY2hhbm5lbC86Y2hhbm5lbElkJyxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdtZW51Q29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL21lc3NhZ2VzL2NoYXQuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcC5wcm9maWxlJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvcHJvZmlsZScsXG4gICAgICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdtZW51Q29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3Byb2ZpbGUvcHJvZmlsZS5odG1sJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnYXBwLmxvZ291dCcsIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBcIi9sb2dpblwiLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVByb3ZpZGVyOiBbXCJhdXRoU2VydmljZVwiLCBcIiRzdGF0ZVwiLCBmdW5jdGlvbiAoYXV0aFNlcnZpY2UsICRzdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXV0aFNlcnZpY2UubG9nb3V0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2xvZ2luJyk7XG4gICAgICAgICAgICAgICAgICAgIH1dXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2xvZ2luXCIsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL2F1dGgvbG9naW4uaHRtbFwiXG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgLy9mYWxsYmFja1xuICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2xvZ2luJyk7XG5cbiAgICAgICAgfV0pO1xufSkoKTtcblxuXG5cblxuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLmF1dGhcIilcblxuICAgICAgICAuc2VydmljZShcImF1dGhTZXJ2aWNlXCIsIGF1dGhTZXJ2aWNlKTtcblxuXHRmdW5jdGlvbiBjcmVhdGVVc2VyKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cdFx0dmFyIGF1dGggPSBmaXJlYmFzZVNlcnZpY2UuZmIuYXV0aCgpO1xuXG5cdFx0cmV0dXJuIGF1dGguY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkKGVtYWlsLCBwYXNzd29yZCk7XG5cdH1cblx0XG4gICAgZnVuY3Rpb24gYXV0aFNlcnZpY2UoJHEsICRyb290U2NvcGUsIHVzZXIsIGJ1aWxkaW5nc1NlcnZpY2UsIHNlbGVjdGVkQnVpbGRpbmcpIHtcblx0XHR2YXIgYXV0aCA9IGZpcmViYXNlLmF1dGgoKTtcblx0XHRcblx0XHQkcm9vdFNjb3BlLiRvbignbmFtZS1jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgdXNyID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyO1xuXHRcdFx0aWYgKHVzciA9PSBudWxsKSByZXR1cm47XG5cdFx0XHRcblx0XHRcdGZpcmViYXNlLmRhdGFiYXNlKCkucmVmKCd1c2Vycy8nICsgdXNyLnVpZCkuc2V0KHtcblx0XHRcdFx0bmFtZTogdXNyLmRpc3BsYXlOYW1lLFxuXHRcdFx0XHRlbWFpbDogdXNyLmVtYWlsLFxuXHRcdFx0XHRsYXN0QWN0aXZpdHk6IG5ldyBEYXRlKCkuZ2V0VGltZSgpXG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdHJldHVybiB7XG4gICAgICAgICAgICBsb2dpbjogZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XG4gICAgICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IGRlZmVycmVkLnByb21pc2U7XG5cblx0XHRcdFx0dmFyIHN1Y2Nlc3NIYW5kbGVyID0gZnVuY3Rpb24oaW5mbykge1xuXHRcdFx0XHRcdGluZm8uaXNOZXcgPSBpbmZvLmRpc3BsYXlOYW1lID09IG51bGw7XG5cdFx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShpbmZvKTtcblx0XHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdHVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS4kZW1pdCgnbmFtZS1jaGFuZ2VkJyk7XG5cdFx0XHRcdH07XG5cblx0XHRcdFx0dmFyIGVycm9ySGFuZGxlciA9IGZ1bmN0aW9uKGVycm9yKSB7XG5cdFx0XHRcdFx0ZGVmZXJyZWQucmVqZWN0KGVycm9yKTtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRhdXRoLnNpZ25JbldpdGhFbWFpbEFuZFBhc3N3b3JkKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHRcdFx0XHQudGhlbihzdWNjZXNzSGFuZGxlciwgZnVuY3Rpb24gZXJyb3IoZXJyb3IpIHtcblx0XHRcdFx0XHRcdGlmIChlcnJvci5jb2RlID09IFwiYXV0aC91c2VyLW5vdC1mb3VuZFwiKSB7XG5cdFx0XHRcdFx0XHRcdGF1dGguY3JlYXRlVXNlcldpdGhFbWFpbEFuZFBhc3N3b3JkKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHRcdFx0XHRcdFx0XHQudGhlbihzdWNjZXNzSGFuZGxlciwgZXJyb3JIYW5kbGVyKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRlcnJvckhhbmRsZXIoZXJyb3IpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXG4gICAgICAgICAgICAgICAgcHJvbWlzZS5zdWNjZXNzID0gZnVuY3Rpb24oZm4pIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvbWlzZS50aGVuKGZuKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHByb21pc2UuZXJyb3IgPSBmdW5jdGlvbihmbikge1xuICAgICAgICAgICAgICAgICAgICBwcm9taXNlLnRoZW4obnVsbCwgZm4pO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgICAgICAgICB9LFxuXG5cdFx0XHRsb2dvdXQ6IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0YXV0aC5zaWduT3V0KCk7XG5cdFx0XHRcdHVzZXIgPSBmaXJlYmFzZS5hdXRoKCkuY3VycmVudFVzZXI7XG5cdFx0XHR9LFxuXG4gICAgICAgICAgICB1c2VyOiBmdW5jdGlvbigpIHtcblx0XHRcdFx0cmV0dXJuIGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmJ1aWxkaW5ncycpXG4gICAgICAgIC5zZXJ2aWNlKCdidWlsZGluZ0NoYW5uZWxzU2VydmljZScsIGJ1aWxkaW5nQ2hhbm5lbHNTZXJ2aWNlKTtcblxuICAgIGZ1bmN0aW9uIGJ1aWxkaW5nQ2hhbm5lbHNTZXJ2aWNlKGZpcmViYXNlU2VydmljZSkge1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnZXRDaGFubmVsc0Zyb206IGZ1bmN0aW9uIChidWlsZGluZykge1xuICAgICAgICAgICAgICAgIHJldHVybiBmaXJlYmFzZVNlcnZpY2UuZmIuZGF0YWJhc2UoKS5yZWYoJ2J1aWxkaW5ncy8nICsgYnVpbGRpbmcgKyBcIi9jaGFubmVsc1wiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG5cbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYnVpbGRpbmdzXCIpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoXCJidWlsZGluZ0NvbnRyb2xsZXJcIiwgYnVpbGRpbmdDb250cm9sbGVyKTtcblxuXG4gICAgZnVuY3Rpb24gYnVpbGRpbmdDb250cm9sbGVyKCRzY29wZSwgJGlvbmljTG9hZGluZywgJHN0YXRlUGFyYW1zLCBidWlsZGluZ0NoYW5uZWxzU2VydmljZSkge1xuXG4gICAgICAgIHZhciByZWYgPSBidWlsZGluZ0NoYW5uZWxzU2VydmljZS5nZXRDaGFubmVsc0Zyb20oJHN0YXRlUGFyYW1zLmJ1aWxkaW5nSWQpO1xuXG4gICAgICAgICRpb25pY0xvYWRpbmcuc2hvdygpO1xuICAgICAgICByZWYub24oXCJ2YWx1ZVwiLCBmdW5jdGlvbiAoc25hcHNob3QpIHtcbiAgICAgICAgICAgIHZhciB2YWwgPSBzbmFwc2hvdC52YWwoKTtcblxuICAgICAgICAgICAgaWYgKHZhbCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5jaGFubmVscyA9IGFuZ3VsYXIuZXh0ZW5kKHZhbC5jb21tb24sIHZhbC5zZXJ2aWNlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJGlvbmljTG9hZGluZy5oaWRlKCk7XG5cbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yT2JqZWN0KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImVycm9yIHJlYWRpbmc6IFwiICsgZXJyb3JPYmplY3QuY29kZSk7XG4gICAgICAgICAgICB2YXIgYWxlcnRQb3B1cCA9ICRpb25pY1BvcHVwLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ09wcyEnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnU29ycnkhIEFuIGVycm9yIG9jdXJyZWQuJ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgfSk7XG5cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuYnVpbGRpbmdzXCIpXG5cbiAgICAgICAgLmNvbnRyb2xsZXIoXCJidWlsZGluZ3NDb250cm9sbGVyXCIsIGJ1aWxkaW5nc0NvbnRyb2xsZXIpO1xuXG5cbiAgICBmdW5jdGlvbiBidWlsZGluZ3NDb250cm9sbGVyKCRzY29wZSwgJGlvbmljTG9hZGluZywgYnVpbGRpbmdzU2VydmljZSwgc2VsZWN0ZWRCdWlsZGluZykge1xuICAgICAgICB2YXIgcmVmID0gYnVpbGRpbmdzU2VydmljZS5nZXRCdWlsZGluZ3MoKTtcblx0XHRcblx0XHQkc2NvcGUuc2VsZWN0ZWRLZXkgPSBzZWxlY3RlZEJ1aWxkaW5nID8gc2VsZWN0ZWRCdWlsZGluZy5rZXkgOiBudWxsO1xuXHRcdFxuXHRcdCRzY29wZS5zZWxlY3QgPSBmdW5jdGlvbihrZXksIGJ1aWxkaW5nKSB7XG5cdFx0XHQkc2NvcGUuc2VsZWN0ZWRLZXkgPSBidWlsZGluZy5rZXkgPSBrZXk7XG5cdFx0XHRzZWxlY3RlZEJ1aWxkaW5nID0gYnVpbGRpbmc7XG5cdFx0XHQkc2NvcGUuJGVtaXQoXCJidWlsZGluZy1zZWxlY3RlZFwiLCBzZWxlY3RlZEJ1aWxkaW5nKTtcblx0XHR9O1x0XHRcblxuICAgICAgICAkaW9uaWNMb2FkaW5nLnNob3coKTtcbiAgICAgICAgcmVmLm9uKFwidmFsdWVcIiwgZnVuY3Rpb24gKHNuYXBzaG90KSB7XG4gICAgICAgICAgICAkc2NvcGUuYnVpbGRpbmdzID0gc25hcHNob3QudmFsKCk7XG4gICAgICAgICAgICAkaW9uaWNMb2FkaW5nLmhpZGUoKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yT2JqZWN0KSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImVycm9yIHJlYWRpbmc6IFwiICsgZXJyb3JPYmplY3QuY29kZSk7XG4gICAgICAgICAgICB2YXIgYWxlcnRQb3B1cCA9ICRpb25pY1BvcHVwLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICB0aXRsZTogJ09wcyEnLFxuICAgICAgICAgICAgICAgIHRlbXBsYXRlOiAnU29ycnkhIEFuIGVycm9yIG9jdXJyZWQnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICRpb25pY0xvYWRpbmcuaGlkZSgpO1xuICAgICAgICB9KTtcbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAuYnVpbGRpbmdzJylcbiAgICAgICAgLnNlcnZpY2UoJ2J1aWxkaW5nc1NlcnZpY2UnLCBidWlsZGluZ3NTZXJ2aWNlKTtcblxuICAgIGZ1bmN0aW9uIGJ1aWxkaW5nc1NlcnZpY2UoZmlyZWJhc2VTZXJ2aWNlLCAkcm9vdFNjb3BlKSB7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldEJ1aWxkaW5nczogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmaXJlYmFzZS5kYXRhYmFzZSgpLnJlZignYnVpbGRpbmdzJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYXBwLmZpcmViYXNlJylcbiAgICAgICAgLnNlcnZpY2UoJ2ZpcmViYXNlU2VydmljZScsIGZpcmViYXNlU2VydmljZSk7XG5cblxuICAgIGZ1bmN0aW9uIGZpcmViYXNlU2VydmljZSgpIHtcbiAgICAgICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgICAgIGFwaUtleTogXCJBSXphU3lCNXE4MUFHR294NGk4LVFMMktPdG5ERGZpMDVpcmdjSEVcIixcbiAgICAgICAgICAgIGF1dGhEb21haW46IFwic29jaWFsc3RyYXRhaWRlYXRlYW0uZmlyZWJhc2VhcHAuY29tXCIsXG4gICAgICAgICAgICBkYXRhYmFzZVVSTDogXCJodHRwczovL3NvY2lhbHN0cmF0YWlkZWF0ZWFtLmZpcmViYXNlaW8uY29tXCIsXG4gICAgICAgICAgICBzdG9yYWdlQnVja2V0OiBcIlwiLFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuZmIgPSBmaXJlYmFzZS5pbml0aWFsaXplQXBwKGNvbmZpZyk7XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdhcHAubWVzc2FnZXMnKVxuXG4gICAgICAgIC5jb250cm9sbGVyKCdtZXNzYWdlc0NvbnRyb2xsZXInLCBbJyRzY29wZScsICckcm9vdFNjb3BlJywgJyRzdGF0ZScsXG4gICAgICAgICAgICAnJHN0YXRlUGFyYW1zJywgJyRpb25pY0FjdGlvblNoZWV0JyxcbiAgICAgICAgICAgICckaW9uaWNQb3B1cCcsICckaW9uaWNTY3JvbGxEZWxlZ2F0ZScsICckdGltZW91dCcsICckaW50ZXJ2YWwnLFxuICAgICAgICAgICAgbWVzc2FnZXNDb250cm9sbGVyXG4gICAgICAgIF0pXG5cbiAgICBmdW5jdGlvbiBtZXNzYWdlc0NvbnRyb2xsZXIoJHNjb3BlLCAkcm9vdFNjb3BlLCAkc3RhdGUsICRzdGF0ZVBhcmFtcywgJGlvbmljQWN0aW9uU2hlZXQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRpb25pY1BvcHVwLCAkaW9uaWNTY3JvbGxEZWxlZ2F0ZSwgJHRpbWVvdXQsICRpbnRlcnZhbCkge1xuXG4gICAgICAgIC8vIG1vY2sgYWNxdWlyaW5nIGRhdGEgdmlhICRzdGF0ZVBhcmFtc1xuICAgICAgICAkc2NvcGUudG9Vc2VyID0ge1xuICAgICAgICAgICAgX2lkOiAnNTM0YjhlNWFhYTVlN2FmYzFiMjNlNjliJyxcbiAgICAgICAgICAgIHBpYzogJ2h0dHA6Ly9pb25pY2ZyYW1ld29yay5jb20vaW1nL2RvY3MvdmVua21hbi5qcGcnLFxuICAgICAgICAgICAgY2hhbm5lbDogJHN0YXRlLnBhcmFtcy5jaGFubmVsSWRcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIHRoaXMgY291bGQgYmUgb24gJHJvb3RTY29wZSByYXRoZXIgdGhhbiBpbiAkc3RhdGVQYXJhbXNcbiAgICAgICAgJHNjb3BlLnVzZXIgPSB7XG4gICAgICAgICAgICBfaWQ6ICc1MzRiOGZiMmFhNWU3YWZjMWIyM2U2OWMnLFxuICAgICAgICAgICAgcGljOiAnaHR0cDovL2lvbmljZnJhbWV3b3JrLmNvbS9pbWcvZG9jcy9tY2ZseS5qcGcnLFxuICAgICAgICAgICAgdXNlcm5hbWU6ICdNYXJ0eSdcbiAgICAgICAgfTtcblxuICAgICAgICAkc2NvcGUuaW5wdXQgPSB7XG4gICAgICAgICAgICBtZXNzYWdlOiBsb2NhbFN0b3JhZ2VbJ3VzZXJNZXNzYWdlLScgKyAkc2NvcGUudG9Vc2VyLl9pZF0gfHwgJydcbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgbWVzc2FnZUNoZWNrVGltZXI7XG5cbiAgICAgICAgdmFyIHZpZXdTY3JvbGwgPSAkaW9uaWNTY3JvbGxEZWxlZ2F0ZS4kZ2V0QnlIYW5kbGUoJ3VzZXJNZXNzYWdlU2Nyb2xsJyk7XG4gICAgICAgIHZhciBmb290ZXJCYXI7IC8vIGdldHMgc2V0IGluICRpb25pY1ZpZXcuZW50ZXJcbiAgICAgICAgdmFyIHNjcm9sbGVyO1xuICAgICAgICB2YXIgdHh0SW5wdXQ7IC8vIF5eXlxuXG4gICAgICAgICRzY29wZS4kb24oJyRpb25pY1ZpZXcuZW50ZXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnVXNlck1lc3NhZ2VzICRpb25pY1ZpZXcuZW50ZXInKTtcblxuICAgICAgICAgICAgZ2V0TWVzc2FnZXMoKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGZvb3RlckJhciA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcignI3VzZXJNZXNzYWdlc1ZpZXcgLmJhci1mb290ZXInKTtcbiAgICAgICAgICAgICAgICBzY3JvbGxlciA9IGRvY3VtZW50LmJvZHkucXVlcnlTZWxlY3RvcignI3VzZXJNZXNzYWdlc1ZpZXcgLnNjcm9sbC1jb250ZW50Jyk7XG4gICAgICAgICAgICAgICAgdHh0SW5wdXQgPSBhbmd1bGFyLmVsZW1lbnQoZm9vdGVyQmFyLnF1ZXJ5U2VsZWN0b3IoJ3RleHRhcmVhJykpO1xuICAgICAgICAgICAgfSwgMCk7XG5cbiAgICAgICAgICAgIG1lc3NhZ2VDaGVja1RpbWVyID0gJGludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvLyBoZXJlIHlvdSBjb3VsZCBjaGVjayBmb3IgbmV3IG1lc3NhZ2VzIGlmIHlvdXIgYXBwIGRvZXNuJ3QgdXNlIHB1c2ggbm90aWZpY2F0aW9ucyBvciB1c2VyIGRpc2FibGVkIHRoZW1cbiAgICAgICAgICAgIH0sIDIwMDAwKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiRvbignJGlvbmljVmlldy5sZWF2ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsZWF2aW5nIFVzZXJNZXNzYWdlcyB2aWV3LCBkZXN0cm95aW5nIGludGVydmFsJyk7XG4gICAgICAgICAgICAvLyBNYWtlIHN1cmUgdGhhdCB0aGUgaW50ZXJ2YWwgaXMgZGVzdHJveWVkXG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQobWVzc2FnZUNoZWNrVGltZXIpKSB7XG4gICAgICAgICAgICAgICAgJGludGVydmFsLmNhbmNlbChtZXNzYWdlQ2hlY2tUaW1lcik7XG4gICAgICAgICAgICAgICAgbWVzc2FnZUNoZWNrVGltZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kb24oJyRpb25pY1ZpZXcuYmVmb3JlTGVhdmUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoISRzY29wZS5pbnB1dC5tZXNzYWdlIHx8ICRzY29wZS5pbnB1dC5tZXNzYWdlID09PSAnJykge1xuICAgICAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd1c2VyTWVzc2FnZS0nICsgJHNjb3BlLnRvVXNlci5faWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiBnZXRNZXNzYWdlcygpIHtcbiAgICAgICAgICAgICRzY29wZS5tZXNzYWdlcyA9IFt7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1MzVkNjI1Zjg5OGRmNGU4MGUyYTEyNWVcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJJb25pYyBoYXMgY2hhbmdlZCB0aGUgZ2FtZSBmb3IgaHlicmlkIGFwcCBkZXZlbG9wbWVudC5cIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZmIyYWE1ZTdhZmMxYjIzZTY5Y1wiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMDQtMjdUMjA6MDI6MzkuMDgyWlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM3Ljk0NFpcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTM1ZjEzZmZlZTNiMmE2ODExMmI5ZmMwXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiSSBsaWtlIElvbmljIGJldHRlciB0aGFuIGljZSBjcmVhbSFcIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZTVhYWE1ZTdhZmMxYjIzZTY5YlwiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMDQtMjlUMDI6NTI6NDcuNzA2WlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM3Ljk0NFpcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTQ2YTU4NDNmZDRjNWQ1ODFlZmEyNjNhXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiTG9yZW0gaXBzdW0gZG9sb3Igc2l0IGFtZXQsIGNvbnNlY3RldHVyIGFkaXBpc2NpbmcgZWxpdCwgc2VkIGRvIGVpdXNtb2QgdGVtcG9yIGluY2lkaWR1bnQgdXQgbGFib3JlIGV0IGRvbG9yZSBtYWduYSBhbGlxdWEuIFV0IGVuaW0gYWQgbWluaW0gdmVuaWFtLCBxdWlzIG5vc3RydWQgZXhlcmNpdGF0aW9uIHVsbGFtY28gbGFib3JpcyBuaXNpIHV0IGFsaXF1aXAgZXggZWEgY29tbW9kbyBjb25zZXF1YXQuIER1aXMgYXV0ZSBpcnVyZSBkb2xvciBpbiByZXByZWhlbmRlcml0IGluIHZvbHVwdGF0ZSB2ZWxpdCBlc3NlIGNpbGx1bSBkb2xvcmUgZXUgZnVnaWF0IG51bGxhIHBhcmlhdHVyLiBFeGNlcHRldXIgc2ludCBvY2NhZWNhdCBjdXBpZGF0YXQgbm9uIHByb2lkZW50LCBzdW50IGluIGN1bHBhIHF1aSBvZmZpY2lhIGRlc2VydW50IG1vbGxpdCBhbmltIGlkIGVzdCBsYWJvcnVtLlwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhmYjJhYTVlN2FmYzFiMjNlNjljXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0xN1QyMDoxOToxNS4yODlaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzI4WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDc2NDM5OWFiNDNkMWQ0MTEzYWJmZDFcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJBbSBJIGRyZWFtaW5nP1wiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhlNWFhYTVlN2FmYzFiMjNlNjliXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0yNlQyMToxODoxNy41OTFaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzM3WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDc2NDNhZWFiNDNkMWQ0MTEzYWJmZDJcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJJcyB0aGlzIG1hZ2ljP1wiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhmYjJhYTVlN2FmYzFiMjNlNjljXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0yNlQyMToxODozOC41NDlaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzM4WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDc4MTVkYmFiNDNkMWQ0MTEzYWJmZWZcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJHZWUgd2l6LCB0aGlzIGlzIHNvbWV0aGluZyBzcGVjaWFsLlwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhlNWFhYTVlN2FmYzFiMjNlNjliXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0yOFQwNjoyNzo0MC4wMDFaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzM4WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDc4MWM2OWFiNDNkMWQ0MTEzYWJmZjBcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJJIHRoaW5rIEkgbGlrZSBJb25pYyBtb3JlIHRoYW4gSSBsaWtlIGljZSBjcmVhbSFcIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZmIyYWE1ZTdhZmMxYjIzZTY5Y1wiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMTEtMjhUMDY6NTU6MzcuMzUwWlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM4LjMzOFpcIlxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIFwiX2lkXCI6IFwiNTQ3ODFjYTRhYjQzZDFkNDExM2FiZmYxXCIsXG4gICAgICAgICAgICAgICAgXCJ0ZXh0XCI6IFwiWWVhLCBpdCdzIHByZXR0eSBzd2VldFwiLFxuICAgICAgICAgICAgICAgIFwidXNlcklkXCI6IFwiNTM0YjhlNWFhYTVlN2FmYzFiMjNlNjliXCIsXG4gICAgICAgICAgICAgICAgXCJkYXRlXCI6IFwiMjAxNC0xMS0yOFQwNjo1NjozNi40NzJaXCIsXG4gICAgICAgICAgICAgICAgXCJyZWFkXCI6IHRydWUsXG4gICAgICAgICAgICAgICAgXCJyZWFkRGF0ZVwiOiBcIjIwMTQtMTItMDFUMDY6Mjc6MzguMzM4WlwiXG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgXCJfaWRcIjogXCI1NDc4ZGY4NmFiNDNkMWQ0MTEzYWJmZjRcIixcbiAgICAgICAgICAgICAgICBcInRleHRcIjogXCJXb3csIHRoaXMgaXMgcmVhbGx5IHNvbWV0aGluZyBodWg/XCIsXG4gICAgICAgICAgICAgICAgXCJ1c2VySWRcIjogXCI1MzRiOGZiMmFhNWU3YWZjMWIyM2U2OWNcIixcbiAgICAgICAgICAgICAgICBcImRhdGVcIjogXCIyMDE0LTExLTI4VDIwOjQ4OjA2LjU3MlpcIixcbiAgICAgICAgICAgICAgICBcInJlYWRcIjogdHJ1ZSxcbiAgICAgICAgICAgICAgICBcInJlYWREYXRlXCI6IFwiMjAxNC0xMi0wMVQwNjoyNzozOC4zMzlaXCJcbiAgICAgICAgICAgIH0sIHtcbiAgICAgICAgICAgICAgICBcIl9pZFwiOiBcIjU0NzgxY2E0YWI0M2QxZDQxMTNhYmZmMVwiLFxuICAgICAgICAgICAgICAgIFwidGV4dFwiOiBcIkNyZWF0ZSBhbWF6aW5nIGFwcHMgLSBpb25pY2ZyYW1ld29yay5jb21cIixcbiAgICAgICAgICAgICAgICBcInVzZXJJZFwiOiBcIjUzNGI4ZTVhYWE1ZTdhZmMxYjIzZTY5YlwiLFxuICAgICAgICAgICAgICAgIFwiZGF0ZVwiOiBcIjIwMTQtMTEtMjlUMDY6NTY6MzYuNDcyWlwiLFxuICAgICAgICAgICAgICAgIFwicmVhZFwiOiB0cnVlLFxuICAgICAgICAgICAgICAgIFwicmVhZERhdGVcIjogXCIyMDE0LTEyLTAxVDA2OjI3OjM4LjMzOFpcIlxuICAgICAgICAgICAgfV07XG4gICAgICAgIH1cblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdpbnB1dC5tZXNzYWdlJywgZnVuY3Rpb24gKG5ld1ZhbHVlLCBvbGRWYWx1ZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2lucHV0Lm1lc3NhZ2UgJHdhdGNoLCBuZXdWYWx1ZSAnICsgbmV3VmFsdWUpO1xuICAgICAgICAgICAgaWYgKCFuZXdWYWx1ZSkgbmV3VmFsdWUgPSAnJztcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZVsndXNlck1lc3NhZ2UtJyArICRzY29wZS50b1VzZXIuX2lkXSA9IG5ld1ZhbHVlO1xuICAgICAgICB9KTtcblxuICAgICAgICAkc2NvcGUuc2VuZE1lc3NhZ2UgPSBmdW5jdGlvbiAoc2VuZE1lc3NhZ2VGb3JtKSB7XG4gICAgICAgICAgICB2YXIgbWVzc2FnZSA9IHtcbiAgICAgICAgICAgICAgICB0b0lkOiAkc2NvcGUudG9Vc2VyLl9pZCxcbiAgICAgICAgICAgICAgICB0ZXh0OiAkc2NvcGUuaW5wdXQubWVzc2FnZVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gaWYgeW91IGRvIGEgd2ViIHNlcnZpY2UgY2FsbCB0aGlzIHdpbGwgYmUgbmVlZGVkIGFzIHdlbGwgYXMgYmVmb3JlIHRoZSB2aWV3U2Nyb2xsIGNhbGxzXG4gICAgICAgICAgICAvLyB5b3UgY2FuJ3Qgc2VlIHRoZSBlZmZlY3Qgb2YgdGhpcyBpbiB0aGUgYnJvd3NlciBpdCBuZWVkcyB0byBiZSB1c2VkIG9uIGEgcmVhbCBkZXZpY2VcbiAgICAgICAgICAgIC8vIGZvciBzb21lIHJlYXNvbiB0aGUgb25lIHRpbWUgYmx1ciBldmVudCBpcyBub3QgZmlyaW5nIGluIHRoZSBicm93c2VyIGJ1dCBkb2VzIG9uIGRldmljZXNcbiAgICAgICAgICAgIGtlZXBLZXlib2FyZE9wZW4oKTtcblxuICAgICAgICAgICAgLy9Nb2NrU2VydmljZS5zZW5kTWVzc2FnZShtZXNzYWdlKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICRzY29wZS5pbnB1dC5tZXNzYWdlID0gJyc7XG5cbiAgICAgICAgICAgIG1lc3NhZ2UuX2lkID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7IC8vIDp+KVxuICAgICAgICAgICAgbWVzc2FnZS5kYXRlID0gbmV3IERhdGUoKTtcbiAgICAgICAgICAgIG1lc3NhZ2UudXNlcm5hbWUgPSAkc2NvcGUudXNlci51c2VybmFtZTtcbiAgICAgICAgICAgIG1lc3NhZ2UudXNlcklkID0gJHNjb3BlLnVzZXIuX2lkO1xuICAgICAgICAgICAgbWVzc2FnZS5waWMgPSAkc2NvcGUudXNlci5waWN0dXJlO1xuXG4gICAgICAgICAgICAkc2NvcGUubWVzc2FnZXMucHVzaChtZXNzYWdlKTtcblxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGtlZXBLZXlib2FyZE9wZW4oKTtcbiAgICAgICAgICAgICAgICB2aWV3U2Nyb2xsLnNjcm9sbEJvdHRvbSh0cnVlKTtcbiAgICAgICAgICAgIH0sIDApO1xuXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLm1lc3NhZ2VzLnB1c2goTW9ja1NlcnZpY2UuZ2V0TW9ja01lc3NhZ2UoKSk7XG4gICAgICAgICAgICAgICAga2VlcEtleWJvYXJkT3BlbigpO1xuICAgICAgICAgICAgICAgIHZpZXdTY3JvbGwuc2Nyb2xsQm90dG9tKHRydWUpO1xuICAgICAgICAgICAgfSwgMjAwMCk7XG5cbiAgICAgICAgICAgIC8vfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gdGhpcyBrZWVwcyB0aGUga2V5Ym9hcmQgb3BlbiBvbiBhIGRldmljZSBvbmx5IGFmdGVyIHNlbmRpbmcgYSBtZXNzYWdlLCBpdCBpcyBub24gb2J0cnVzaXZlXG4gICAgICAgIGZ1bmN0aW9uIGtlZXBLZXlib2FyZE9wZW4oKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygna2VlcEtleWJvYXJkT3BlbicpO1xuICAgICAgICAgICAgdHh0SW5wdXQub25lKCdibHVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0ZXh0YXJlYSBibHVyLCBmb2N1cyBiYWNrIG9uIGl0Jyk7XG4gICAgICAgICAgICAgICAgdHh0SW5wdXRbMF0uZm9jdXMoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb25Qcm9maWxlUGljRXJyb3IoZWxlKSB7XG4gICAgICAgICAgICB0aGlzLmVsZS5zcmMgPSAnJzsgLy8gc2V0IGEgZmFsbGJhY2tcbiAgICAgICAgfVxuXG4gICAgICAgICRzY29wZS5vbk1lc3NhZ2VIb2xkID0gZnVuY3Rpb24gKGUsIGl0ZW1JbmRleCwgbWVzc2FnZSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ29uTWVzc2FnZUhvbGQnKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdtZXNzYWdlOiAnICsgSlNPTi5zdHJpbmdpZnkobWVzc2FnZSwgbnVsbCwgMikpO1xuICAgICAgICAgICAgJGlvbmljQWN0aW9uU2hlZXQuc2hvdyh7XG4gICAgICAgICAgICAgICAgYnV0dG9uczogW3tcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogJ0NvcHkgVGV4dCdcbiAgICAgICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQ6ICdEZWxldGUgTWVzc2FnZSdcbiAgICAgICAgICAgICAgICB9XSxcbiAgICAgICAgICAgICAgICBidXR0b25DbGlja2VkOiBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChpbmRleCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAwOiAvLyBDb3B5IFRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2NvcmRvdmEucGx1Z2lucy5jbGlwYm9hcmQuY29weShtZXNzYWdlLnRleHQpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDE6IC8vIERlbGV0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG5vIHNlcnZlciBzaWRlIHNlY3JldHMgaGVyZSA6filcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubWVzc2FnZXMuc3BsaWNlKGl0ZW1JbmRleCwgMSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2aWV3U2Nyb2xsLnJlc2l6ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICAvLyB0aGlzIHByb2Igc2VlbXMgd2VpcmQgaGVyZSBidXQgSSBoYXZlIHJlYXNvbnMgZm9yIHRoaXMgaW4gbXkgYXBwLCBzZWNyZXQhXG4gICAgICAgICRzY29wZS52aWV3UHJvZmlsZSA9IGZ1bmN0aW9uIChtc2cpIHtcbiAgICAgICAgICAgIGlmIChtc2cudXNlcklkID09PSAkc2NvcGUudXNlci5faWQpIHtcbiAgICAgICAgICAgICAgICAvLyBnbyB0byB5b3VyIHByb2ZpbGVcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gZ28gdG8gb3RoZXIgdXNlcnMgcHJvZmlsZVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEkgZW1pdCB0aGlzIGV2ZW50IGZyb20gdGhlIG1vbm9zcGFjZWQuZWxhc3RpYyBkaXJlY3RpdmUsIHJlYWQgbGluZSA0ODBcbiAgICAgICAgJHNjb3BlLiRvbigndGFSZXNpemUnLCBmdW5jdGlvbiAoZSwgdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0YVJlc2l6ZScpO1xuICAgICAgICAgICAgaWYgKCF0YSkgcmV0dXJuO1xuXG4gICAgICAgICAgICB2YXIgdGFIZWlnaHQgPSB0YVswXS5vZmZzZXRIZWlnaHQ7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygndGFIZWlnaHQ6ICcgKyB0YUhlaWdodCk7XG5cbiAgICAgICAgICAgIGlmICghZm9vdGVyQmFyKSByZXR1cm47XG5cbiAgICAgICAgICAgIHZhciBuZXdGb290ZXJIZWlnaHQgPSB0YUhlaWdodCArIDEwO1xuICAgICAgICAgICAgbmV3Rm9vdGVySGVpZ2h0ID0gKG5ld0Zvb3RlckhlaWdodCA+IDQ0KSA/IG5ld0Zvb3RlckhlaWdodCA6IDQ0O1xuXG4gICAgICAgICAgICBmb290ZXJCYXIuc3R5bGUuaGVpZ2h0ID0gbmV3Rm9vdGVySGVpZ2h0ICsgJ3B4JztcbiAgICAgICAgICAgIHNjcm9sbGVyLnN0eWxlLmJvdHRvbSA9IG5ld0Zvb3RlckhlaWdodCArICdweCc7XG4gICAgICAgIH0pO1xuXG4gICAgfVxufSkoKTtcblxuXG5cblxuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5tZXNzYWdlcycpXG5cbiAgICAgICAgLmZpbHRlcignbmwyYnInLCBbJyRmaWx0ZXInLCBubDJicl0pXG5cbiAgICBmdW5jdGlvbiBubDJicigkZmlsdGVyKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgaWYgKCFkYXRhKSByZXR1cm4gZGF0YTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLnJlcGxhY2UoL1xcblxccj8vZywgJzxiciAvPicpO1xuICAgICAgICB9O1xuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2FwcC5tZXNzYWdlcycpXG4gICAgICAgIC5zZXJ2aWNlKCdtZXNzYWdlc1NlcnZpY2UnLCBtZXNzYWdlc1NlcnZpY2UpO1xuXG4gICAgZnVuY3Rpb24gbWVzc2FnZXNTZXJ2aWNlKGZpcmViYXNlU2VydmljZSkge1xuICAgICAgICB2YXIgc2VydmljZSA9IHt9O1xuXG4gICAgICAgIHNlcnZpY2UuZ2V0TWVzc2FnZXNSZWYgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gZmlyZWJhc2UuZGF0YWJhc2UoKS5yZWYoJ21lc3NhZ2VzJyk7XG4gICAgICAgIH07XG5cbiAgICAgICAgc2VydmljZS5hZGRNZXNzYWdlID0gZnVuY3Rpb24gKG1lc3NhZ2UpIHtcbiAgICAgICAgICAgIHJldHVybiBmaXJlYmFzZVNlcnZpY2UuZmIuZGF0YWJhc2UoKS5wdXNoKG1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgfVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyLm1vZHVsZShcImFwcC5wcm9maWxlc1wiKVxuXG4gICAgICAgIC5jb250cm9sbGVyKFwicHJvZmlsZUNvbnRyb2xsZXJcIiwgcHJvZmlsZUNvbnRyb2xsZXIpO1xuXG5cbiAgICBmdW5jdGlvbiBwcm9maWxlQ29udHJvbGxlcigkc2NvcGUsICRpb25pY0xvYWRpbmcsICRpb25pY1BvcHVwLCBhdXRoU2VydmljZSwgcHJvZmlsZXNTZXJ2aWNlKSB7XG5cblx0XHR2YXIgdXNlciA9IGF1dGhTZXJ2aWNlLnVzZXIoKTtcblx0XHRcblx0XHQkc2NvcGUuZGF0YSA9IHtcblx0XHRcdGRpc3BsYXlOYW1lIDogdXNlciA/IHVzZXIuZGlzcGxheU5hbWUgOiBcIlwiLFxuXHRcdFx0ZW1haWwgOiB1c2VyID8gdXNlci5lbWFpbCA6IFwiXCJcblx0XHR9O1xuXG4gICAgICAgICRzY29wZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcblx0XHRcdCRpb25pY0xvYWRpbmcuc2hvdygpO1xuXG4gICAgICAgICAgICBwcm9maWxlc1NlcnZpY2UudXBkYXRlUHJvZmlsZSgkc2NvcGUuZGF0YSkudGhlbihmdW5jdGlvbiBzdWNjZXNzKG1zZykge1xuXHRcdFx0XHQkaW9uaWNMb2FkaW5nLmhpZGUoKTtcblxuXHRcdFx0XHQkaW9uaWNQb3B1cC5hbGVydCh7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnUHJvZmlsZVVwZGF0ZSEnLFxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogbXNnXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yKGVycm9yKSB7XG5cdFx0XHRcdCRpb25pY0xvYWRpbmcuaGlkZSgpO1xuXG5cdFx0XHRcdCRpb25pY1BvcHVwLmFsZXJ0KHtcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdVcGRhdGUgZmFpbGVkIScsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBlcnJvci5tZXNzYWdlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLnByb2ZpbGVzXCIpXG5cbiAgICAgICAgLnNlcnZpY2UoXCJwcm9maWxlc1NlcnZpY2VcIiwgcHJvZmlsZXNTZXJ2aWNlKTtcblxuXG4gICAgZnVuY3Rpb24gcHJvZmlsZXNTZXJ2aWNlKCRxLCAkcm9vdFNjb3BlLCBhdXRoU2VydmljZSwgdXNlcikge1xuXHRcdFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgdXBkYXRlUHJvZmlsZTogZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgICAgICBhdXRoU2VydmljZS51c2VyKCkudXBkYXRlUHJvZmlsZShkYXRhKVxuICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiBzdWNjZXNzKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShcIlByb2ZpbGUgdXBkYXRlZCFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VyID0gZmlyZWJhc2UuYXV0aCgpLmN1cnJlbnRVc2VyO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCduYW1lLWNoYW5nZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24gZXJyb3IoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlamVjdChlcnJvcik7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoXCJhcHAuc2lkZW1lbnVcIilcblxuICAgICAgICAuY29udHJvbGxlcihcInNpZGVtZW51Q29udHJvbGxlclwiLCBzaWRlbWVudUNvbnRyb2xsZXIpO1xuXG5cbiAgICBmdW5jdGlvbiBzaWRlbWVudUNvbnRyb2xsZXIoJHNjb3BlLCAkc3RhdGUpIHtcblx0XHQvLyAkc2NvcGUuJG9uKCduYW1lLWNoYW5nZWQnLCBmdW5jdGlvbigpIHtcblx0XHQvLyBcdCRzY29wZS5kaXNwbGF5TmFtZSA9IGF1dGhTZXJ2aWNlLnVzZXIoKS5kaXNwbGF5TmFtZTtcblx0XHQvLyB9KTtcblx0XHRcblx0XHQkc2NvcGUuYnVpbGRpbmcgPSB7XG5cdFx0XHRuYW1lOiBcIlNlbGVjdCBhIGJ1aWxkaW5nXCIsXG5cdFx0XHRhZGRyZXNzOiBcIlwiLFxuXHRcdH07XG5cdFx0XG5cdFx0JHNjb3BlLiRvbignYnVpbGRpbmctc2VsZWN0ZWQnLCBmdW5jdGlvbihldmVudCwgZGF0YSkge1xuXHRcdFx0JHNjb3BlLmJ1aWxkaW5nLm5hbWUgPSBkYXRhLm5hbWU7XG5cdFx0XHQkc2NvcGUuYnVpbGRpbmcuYWRkcmVzcyA9IGRhdGEuYWRkcmVzcztcblx0XHRcdFxuXHRcdH0pO1xuXHRcdFxuXHRcdCRzY29wZS5jaGFubmVsID0gZnVuY3Rpb24oY2hhbm5lbEtleSkge1xuXHRcdFx0JHN0YXRlLmdvKCdhcHAuY2hhbm5lbCcsIHsgY2hhbm5lbElkOiBjaGFubmVsS2V5fSk7XG5cdFx0fTtcbiAgICB9XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXIubW9kdWxlKFwiYXBwLnVzZXJzXCIpXG5cbiAgICAgICAgLnNlcnZpY2UoXCJ1c2Vyc1NlcnZpY2VcIiwgdXNlcnNTZXJ2aWNlKTtcblxuXG4gICAgZnVuY3Rpb24gdXNlcnNTZXJ2aWNlKCRxLCBhdXRoU2VydmljZSkge1xuXHQgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVwZGF0ZVByb2ZpbGU6IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICAgICAgYXV0aFNlcnZpY2UudXNlcigpLnVwZGF0ZVByb2ZpbGUoZGF0YSlcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gc3VjY2VzcygpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoXCJQcm9maWxlIHVwZGF0ZWQhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdXNlciA9IGZpcmViYXNlLmF1dGgoKS5jdXJyZW50VXNlcjtcbiAgICAgICAgICAgICAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdCgnbmFtZS1jaGFuZ2VkJyk7XG4gICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uIGVycm9yKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZWplY3QoZXJyb3IpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG5cbiAgICAgICAgLm1vZHVsZSgnYXBwJywgW1xuICAgICAgICAgICAgJ2lvbmljJyxcbiAgICAgICAgICAgICdtb25vc3BhY2VkLmVsYXN0aWMnLFxuXG4gICAgICAgICAgICAnYXBwLmZpcmViYXNlJyxcbiAgICAgICAgICAgICdhcHAuYXV0aCcsXG4gICAgICAgICAgICAnYXBwLnNpZGVtZW51JyxcbiAgICAgICAgICAgICdhcHAuYnVpbGRpbmdzJyxcbiAgICAgICAgICAgICdhcHAucHJvZmlsZXMnLFxuICAgICAgICAgICAgJ2FwcC5tZXNzYWdlcydcbiAgICAgICAgXSlcblx0XHRcblx0XHQudmFsdWUoXCJ1c2VyXCIsIG51bGwpXG5cdFx0LnZhbHVlKFwic2VsZWN0ZWRCdWlsZGluZ1wiLCBudWxsKVxuXG4gICAgICAgIC52YWx1ZShcInVzZXJcIiwgbnVsbClcblxuICAgICAgICAucnVuKGZ1bmN0aW9uICgkaW9uaWNQbGF0Zm9ybSwgJHRpbWVvdXQsICRyb290U2NvcGUpIHtcbiAgICAgICAgICAgICRpb25pY1BsYXRmb3JtLnJlYWR5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBpZiAod2luZG93LmNvcmRvdmEgJiYgd2luZG93LmNvcmRvdmEucGx1Z2lucy5LZXlib2FyZCkge1xuICAgICAgICAgICAgICAgICAgICBjb3Jkb3ZhLnBsdWdpbnMuS2V5Ym9hcmQuaGlkZUtleWJvYXJkQWNjZXNzb3J5QmFyKHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvcmRvdmEucGx1Z2lucy5LZXlib2FyZC5kaXNhYmxlU2Nyb2xsKHRydWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAod2luZG93LlN0YXR1c0Jhcikge1xuICAgICAgICAgICAgICAgICAgICBTdGF0dXNCYXIuc3R5bGVEZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCduYW1lLWNoYW5nZWQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbn0pKCk7XG5cblxuIiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG5cbiAgICAgICAgLm1vZHVsZSgnYXBwJylcblxuICAgICAgICAucnVuKFsnJHJvb3RTY29wZScsICckbG9jYXRpb24nLCAnYXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgJHN0YXRlLCBhdXRoU2VydmljZSkge1xuICAgICAgICAgICAgJHJvb3RTY29wZS4kb24oJyRyb3V0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50KSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoYXV0aFNlcnZpY2UudXNlcigpID09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XSlcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcblxuICAgICAgICAubW9kdWxlKCdhcHAnKVxuXG4gICAgICAgIC5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblxuICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXJcblxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnYXBwJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYXBwJyxcbiAgICAgICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBhYnN0cmFjdDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9zaWRlbWVudS5odG1sJyxcbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdhcHAuYnVpbGRpbmdzJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYnVpbGRpbmdzJyxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdtZW51Q29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2J1aWxkaW5ncy5odG1sJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIC5zdGF0ZSgnYXBwLmJ1aWxkaW5nJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvYnVpbGRpbmdzLzpidWlsZGluZ0lkJyxcbiAgICAgICAgICAgICAgICAgICAgdmlld3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICdtZW51Q29udGVudCc6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL2J1aWxkaW5nLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdhcHAuY2hhbm5lbCcsIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL2NoYW5uZWwvOmNoYW5uZWxJZCcsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbWVudUNvbnRlbnQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9tZXNzYWdlcy9jaGF0Lmh0bWwnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAgICAgLnN0YXRlKCdhcHAucHJvZmlsZScsIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAnL3Byb2ZpbGUnLFxuICAgICAgICAgICAgICAgICAgICBjYWNoZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbWVudUNvbnRlbnQnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wcm9maWxlL3Byb2ZpbGUuaHRtbCdcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2FwcC5sb2dvdXQnLCB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogXCIvbG9naW5cIixcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVQcm92aWRlcjogZnVuY3Rpb24gKGF1dGhTZXJ2aWNlLCAkc3RhdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLmxvZ291dCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdsb2dpbicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IFwiL2xvZ2luXCIsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcInZpZXdzL2F1dGgvbG9naW4uaHRtbFwiXG4gICAgICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICAgICAgLy9mYWxsYmFja1xuICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2xvZ2luJyk7XG5cbiAgICAgICAgfSk7XG59KSgpO1xuXG5cblxuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
